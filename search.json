[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Andmeanalüüsi töötuba",
    "section": "",
    "text": "Saateks\nSee e-raamat on mõeldud abistavaks materjaliks R-studio1 kasutamisel.\nOlen koondanud siia valiku vajaminevaid käske2 ning lisanud lühikese selgituse, miks ja millal neid käske vaja võib minna. Kõik näited ja soovitused olen kirja pannud oma kasutuskogemuse pinnalt ning viisil, kuidas ise oleksin soovinud R-i kasutamist õppida. Püüan kasutada pigem R-iga kaasatulevaid andmestikke, et saaksid samu asju järgi teha, kuid kasutan ka mitmeid avaandmestikke, et oleks selgemini näha, mis võivad olla esmased tõrked “päris” andmete kasutamisel.\nRaamat liigub sisu poolest lihtsamalt keerulisema suunas ning täiendan sisu jooksvalt, et sellest oleks kasu nii algajale kui ka kogenumale R-i kasutajale. Programmi saab alla laadida siit. Ma ei plaani kirjutada peatükki, mis räägib R-i seadistamisest, projektide loomisest jms. Soovitan selleks tutvuda raamatuga R for Data Science (2e).3\nViitan jooksvalt erinevatele allikatele, et saaksid R-i käskude (või analüüsimeetodite) kohta rohkem lugeda. Kuna olen oma R-i kasutamise teadmised pigem “kokku googeldanud”, siis viitan pigem pakettide autoritele, et tunnustada neid, kes on teinud R-i selliseks nagu ta täna on4. Palun arvesta, et ma kasutan mitmeid IT-termineid üpris vabalt ning püüan edasi anda pigem tegevuse sisu. Kuna ma ei ole tarvkaraarendaja ega informaatik (ega tööta ka IT valdkonnas), siis luban omale siinkohal vabamat keelekasutust ja koodikirjutuse stiili.\nSotsioloogina5 püüan siiski olla täpne analüüsimeetodite nimedes. Võta seda e-raamatut kui minu isiklikku konspetki, mis avalikult kättesaadav on.\nNii nagu igat võõrkeelt, õpib ka R- i kõige paremini kui seda (regulaarselt) harjutada. Kuigi siit raamatust saab koodi otse kopeerida, püüa kood mõttega läbi kirjutada ja tee oma sõnadega käsk-ude juurde märkmeid.",
    "crumbs": [
      "Saateks"
    ]
  },
  {
    "objectID": "index.html#paketid",
    "href": "index.html#paketid",
    "title": "Andmeanalüüsi töötuba",
    "section": "Paketid",
    "text": "Paketid\nR-i baasversioon6 on võimas tööriist, kuid paljud paketid teevad R-i kasutamise veelgi mugavamaks ja võimsamaks.\nMinu lemmik pakett on tidyverse(Wickham 2023) ning käivitan selle esimese asjana iga tööprojekti alguses. tidyverse oma olemuselt on erinevate levinud pakettide kogum, mis laiendab oluliselt R-is toimetamisel kasutatavad sõnavara. Loe tidyverse paketi kohta rohkem siit.\n\nlibrary(tidyverse)\n\nSelle e-raamatu koostasin R-studios Quartot kasutades.\n\n\n\n\n\n\nMõnikord ei saa R paketi installeerimisega hakkama, sest sõltuvad paketid (mida me tavaliselt ei näegi) ei ole enam selles verisoonis, mida parasjagu vaja. Siis tuleb kasutada käsk install() paketist renv(Ushey and Wickham 2024) ning paketi nime järel tuleb kirjutada @versiooni_number.\n\n\n\n\n\n\n\n\n\nMõned R-i koodid olen raamatust välja kommenteerinud, sest soovin käsu kasutamist näidata aga mitte seda käivitada. Alates peatükist nr 2 selliseid väljakommenteeritud näidiskoode olen kasutanud mõnel üksikul korral.\n\n\n\n\n#renv::install(\"data.table@1.15.2\")",
    "crumbs": [
      "Saateks"
    ]
  },
  {
    "objectID": "index.html#sonavara",
    "href": "index.html#sonavara",
    "title": "Andmeanalüüsi töötuba",
    "section": "R- i sõnavara",
    "text": "R- i sõnavara\nR võimaldab teha andmetega mitmesuguseid tehteid. Tavapärane liitmine ja lahutamine toimubki vastavalt kas + või - märgiga. Jagamiseks on märk / ning korrutamiseks *. Selleks, et teha keerukamat lauset, on vaja tunda ka järgmisi märke.\n\n\n\nSümbol\nTegevus või tähendus\n\n\n\n\n&lt;-\nabil anname mingile objektile teatud väärtuse\n\n\n$\n“kõnetab” konkreetset tunnust andmestik-us (vaata ka tunnustega tutvumine )\n\n\n%&gt;% või |&gt;\nja siis või seejärel (tee järgmist asja). Selle kohta öeldakse ka torud või pipes. Klahvilühend ctrl+shift+M või command+shift+M. Mina olen harjunud kasutama torusid selliselt %&gt;%.\n\n\n%in%\nkas tunnus sisaldab väärtust\n\n\n#\nkommenteerib teksti käsust välja ehk # järgselt ei tekst osa koodist. Tee nii omale märkmeid koodi kohta.\n\n\n?\nkoos käsu nimega avab käsu dokumentatsiooni\n\n\n==\nvõrdne\n\n\n&lt;\nväiksem kui\n\n\n&gt;\nsuurem kui\n\n\n&lt;=\nväiksem või võrdne\n\n\n!\npöörab käsu tagurpidi\n\n\n!=\nei ole võrdne\n\n\n|\nvõi\n\n\n&\nja\n\n\n\nPeaaegu kõik levinud funktsioonid algavad R-is väikese tähega ning neile järgnevad sulud (). funktsioon on käsk, mis ütleb programmile, mida teha tuleb. Enamasti ütleb käsu nimi juba, mida ta tegema peab (näiteks käsk filter()), kuid R-ile tuleb sulgudes sees täpsustada, milliste andmetega antud käsku täita. R-is on väga oluline, kas kasutusel on suured või väikesed tähed, teatud sümbolite kasutamine R-ile ei meeldi ning kui R, millestki aru või hakkama ei saa, siis ta seda ka ütleb.\ntidyverse pakett laiendab R-i sõnavara olulisel määral. Baasversiooniga on võimalik ka palju ära teha, kuid mina eelistan kasutada pigem tidyverse lähenemist.\nNäide, kuidas sama asja saab kirjutada kahel erineval viisil. Esimene neist on nn baasversiooni lähenemine ja teine tidyverse oma. Mõlema koodijupi käivitamine annab sama tulemuse.\n\n#baasversioon\nstarwars[is.na(starwars$mass),]\n\n# A tibble: 28 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…\n 2 Mon Mot…    150    NA auburn     fair       blue              48 fema… femin…\n 3 Arvel C…     NA    NA brown      fair       brown             NA male  mascu…\n 4 Finis V…    170    NA blond      fair       blue              91 male  mascu…\n 5 Rugor N…    206    NA none       green      orange            NA male  mascu…\n 6 Ric Olié    183    NA brown      fair       blue              NA male  mascu…\n 7 Watto       137    NA black      blue, grey yellow            NA male  mascu…\n 8 Quarsh …    183    NA black      dark       brown             62 male  mascu…\n 9 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…\n10 Bib For…    180    NA none       pale       pink              NA male  mascu…\n# ℹ 18 more rows\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\n\n#tidyverse abil\nstarwars%&gt;%\n  filter(is.na(mass))\n\n# A tibble: 28 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…\n 2 Mon Mot…    150    NA auburn     fair       blue              48 fema… femin…\n 3 Arvel C…     NA    NA brown      fair       brown             NA male  mascu…\n 4 Finis V…    170    NA blond      fair       blue              91 male  mascu…\n 5 Rugor N…    206    NA none       green      orange            NA male  mascu…\n 6 Ric Olié    183    NA brown      fair       blue              NA male  mascu…\n 7 Watto       137    NA black      blue, grey yellow            NA male  mascu…\n 8 Quarsh …    183    NA black      dark       brown             62 male  mascu…\n 9 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…\n10 Bib For…    180    NA none       pale       pink              NA male  mascu…\n# ℹ 18 more rows\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\n\n\n\n\nUshey, Kevin, and Hadley Wickham. 2024. Renv: Project Environments. https://CRAN.R-project.org/package=renv.\n\n\nWickham, Hadley. 2023. Tidyverse: Easily Install and Load the Tidyverse. https://CRAN.R-project.org/package=tidyverse.",
    "crumbs": [
      "Saateks"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "Andmeanalüüsi töötuba",
    "section": "",
    "text": "Ütlen R-studio kohta mugavuse tõttu lihtsalt R. Ühtlasi R on korraga nii programm kui ka programmeerimiskeel.↩︎\nkäsk on funktsioon, mis ütleb R-ile, mida teha tuleb.↩︎\nNullist alustades vaata Workflow peatükke nr 2, 6 ja 8.↩︎\nKäivita käsk contributors(), et lugeda programmi loojatest ja arendajatest rohkem↩︎\nLõpetasin 2019. aastal Tartu Ülikooli sotsioloogia magistrikava.↩︎\nBaasversioon-i alla mõtlen neid R-i käske, mille kasutamiseks ei ole ühtegi teist paketti kasutusele vaja võtta.↩︎",
    "crumbs": [
      "Saateks"
    ]
  },
  {
    "objectID": "01-andmestike-lugemine.html",
    "href": "01-andmestike-lugemine.html",
    "title": "1  Andmestiku laadimine ja tunnustega tutvumine",
    "section": "",
    "text": "1.1 R-iga kaasatulevad andmestikud\nSee peatükk annab ülevaate, kuidas andmestikke R-i importida ehk kuidas lugeda sisse enamlevinud andmefailide tüüpe. Siit peatükis saad vastuse, kuidas R-is kasutada oma andmeid. Online andmestike peatükis on kirjeldus, kuidas eurostati andmeid otse R-i tõmmata.\nPeatüki lõpus on juhend, kuidas andmeid R-ist nn välja salvestada.\nPaljud paketid sisaldavad näidisandmestikke (datasets), mille abil on hea uusi oskusi harjutada.\nKäsuga data() (sulud seest tühjad) on võimalik näha, millised andmekogud on R-is saadaval, mis tulevad baasversioon-i või mõne muu paketiga kaasa. Käsu data() käivitamisel tekib töökeskkonda lisa tab nimega “R data sets”.\nKui on soov näha kõiki saadalolevaid andmestikke, käivita allolev käsk (ilma trellideta #).\n#data(package = .packages(all.available = TRUE))\nKui on soov mõnda R-i andmestikku kasutusele võtta, siis tuleb kirjutada data() käsu sisse andmestiku nimi. Näiteks tidyverse paketiga tuleb kaasa andmestik “starwars” ning võtame ta kasutusele.\nlibrary(tidyverse)\ndata(starwars)\nNüüd on Enviroment keskkonnas andmestik “starwars”, millel on 87 vaatlust (87 obs) ja 14 tunnust (14 variables).\nJärgmine peatükk räägib, kuidas saada andmestikust esmane ülevaade.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Andmestiku laadimine ja tunnustega tutvumine</span>"
    ]
  },
  {
    "objectID": "01-andmestike-lugemine.html#R-andmestikud",
    "href": "01-andmestike-lugemine.html#R-andmestikud",
    "title": "1  Andmestiku laadimine ja tunnustega tutvumine",
    "section": "",
    "text": "Environment keskkond asub vaikimisi R-studio paremal pool ülevas nurgas.\n\n\n\n\n\n\n\n\n\nBaasversiooni andmestikke on hea kasutada siis, kui on soov õppida mõnda uut analüüsimeetodit või andmete visualiseerimist, kuna need andmestikud on valdavalt puhastatud ja õppimiseks loodud.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Andmestiku laadimine ja tunnustega tutvumine</span>"
    ]
  },
  {
    "objectID": "01-andmestike-lugemine.html#levinud-andmestikud",
    "href": "01-andmestike-lugemine.html#levinud-andmestikud",
    "title": "1  Andmestiku laadimine ja tunnustega tutvumine",
    "section": "1.2 Enimlevinud failidest andmestike laadimine",
    "text": "1.2 Enimlevinud failidest andmestike laadimine\nEnviroment keskkonnas on nupp “Import Dataset”, mille abil on mugav andmestikke sisse lugeda. Selle kasutamisel näeb ka andmete importimiseks vajalikku R-i koodi, mida saab oma tööfaili scripti kopeerida. Kahjuks ei toimi “Import dataset” nupp .csv-failide puhul.\n\n.csv failid\nSisse lugemise käsk sõltub sellest, kas andmeid on failis eraldatud koma (,) või semikooloniga (;).\n\nKui andmeid eraldab ,, kasuta käsku read.csv()\nKui andmeid eraldab ;, kasuta käsku read.csv2()\n\n\n# andmed&lt;-read.csv(\"soidueksam.csv\", \n1#                 na.strings=c(\"\", \".\", \"-\"),\n2#                strip.white = TRUE,\n3#                 fileEncoding = \"utf-8\")\n\n\n1\n\nstrip.white=TRUE - eemaldab üleliigsed tühikud, mis mõnikord võivad csv failiga kaasa tulla\n\n2\n\nna.strings - seda läheb vaja olukorras, kus puuduv väärtus on esitatud mingi muu tähisega, näiteks (tühik) , . või -.\n\n3\n\nfileEncoding - mõnikord võib vaja olla andmete sisse lugemisel täpsustada, et fail on utf-8 kodeeringus.\n\n\n\n\n.csv faile on võimalik sisse lugeda ka paketiga readr(Wickham, Hester, and Bryan 2023) ning käsuga read_csv(). Käsu kasutamisel võivad errorid tulla siis, kui fail ei ole utf-8 kodeeringus. Siis tuleb täpsustada locale() käsuga kodeeringut.\n\n#read_csv(\"failinimi.csv\", locale(encoding = \"iso-8859-4\"))\n\n\n\n.xlsx failid\nExcelist andmete importimiseks läheb vaja paketti readxl(Wickham and Bryan 2023) ja käsku read_excel().\n\n\n\n\n\n\nAndmeid R-i importimise ajaks ei pea sulgema Exceli faili.\n\n\n\n\nlibrary(readxl)\n\n\n# read_excel(\"failinimi.xlsx\",\n1#               sheet=\"leht1\",\n#               range=\"A3:D16\")\n\n\n1\n\nsheet - saab täpsustada, milliselt lehelt andmeid võtta\n\n\n\n\nLisada saab veel täpsustusi:\n\ntrim_ws=TRUE - eemaldab nn whitespace ehk tühikud eest ja lõpust1.\ncol_types= saab täpsustada [tunnuste tüüpe](#tunnuste-tyybid].\n\n\n\n.sav failid\nSPSS failide (.sav) importimiseks on kaks võimalust ning paketi valik sõltub sellest, mida parasjagu (rohkem) vaja on.\nPakett haven (Wickham, Miller, and Smith 2023) annab käsu read_sav(). Pakett kasutab andmete sisse lugemisel tunnuste silte (label) ja tunnuse väärtus-eid kuvab 1, 2, 3 jne.\nPakett foreign (R Core Team 2023) annab käsu read.spss() ning täpsustuseks tuleb öelda to.data.frame=T.\n\n\n\n\n\n\nArvestama peab, et see pakett loeb aga numbrilised tunnused ka faktor-iks2. Loe tunnuste tüüpide kohta siit ning faktor-ite kohta siit.\n\n\n\n\n#library(haven)\n#andmed&lt;-read_sav(\"failinimi.sav\")\n\n\n#library(foreign)\n#andmed&lt;-read.spss(\"failinimi.sav\",\n#                   to.data.frame=T)\n\nKuigi koodi on lihtsam kirjutada, kui tunnuse nimi on code ja mitte label, on siiski mõnikord vaja panna tunnuste nimeks hoopis tunnuse silt (ehk label). Selleks on abiks pakett sjlabelled (Lüdecke 2022) ja käsk label_to_colnames()\n\n#library(sjlabelled)\n#label_to_colnames(andmed)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Andmestiku laadimine ja tunnustega tutvumine</span>"
    ]
  },
  {
    "objectID": "01-andmestike-lugemine.html#online-andmestikud",
    "href": "01-andmestike-lugemine.html#online-andmestikud",
    "title": "1  Andmestiku laadimine ja tunnustega tutvumine",
    "section": "1.3 Online andmestikud",
    "text": "1.3 Online andmestikud\n\nEurostat statistika\nEurostati avaldatavat statistikat on hea tõmmata otse R-i paketi eurostat (Lahti et al. 2023) abil.\n\nlibrary(eurostat)\n\nVõimalus on läheneda kahte moodi. Käsu get_eurostat_interactive() käivitamisel avaneb justkui väike küsitlus, millele vastates jõuad sind huvitava andmetabelini.\n\n#get_eurostat_interactive()\n\nAlgatuseks on mõistlik tõmmata alla nn statistika sisukord käsuga get_eurostat_toc() ning salvestada see eraldi objekti.\n\n#sisu&lt;-get_eurostat_toc()\n\nNii saab sirvida, millised andmed olemas on, kas soovid kogu kausta (folder), andmetabelit (dataset), jne.\n\n\n\n\n\n\nAndmeid on võimalik alla laadida ka saksa või prantsuse keeles. Siis peab täpsutama päringu sees lang=“de” või “fr”\n\n\n\nOletame, et meid huvitab tasemehariduse statistika, kuid me ei tea täpselt, millisel kujul eurostat andmeid avaldab. Eurostati sisukorra allalaadimisel saab üheksa andmevälja.\n\n#names(sisu)\n\nOtsingut on võimalik täpsustada nende andmeväljade järgi. Lisaks on võimalik käsu search_eurostat() järgi otsida tabelit konkreetsemalt.\n\n#search_eurostat(\"educ\", column = \"code\")|&gt;\n#  nrow() #vaatame ridade arvu\n\nKui oled üles leidnud omale sobivad andmetabelid, saad need alla laadida käsuga get_eurostat(). Näiteks tõmbame alla eurostatist Eesti ja Soome haridusstatistika nii, et kõik andme-koodide asemel on sildid (label) ning tekstiväljad on muudetud faktoriteks. Vajadusel loe faktorite kohta rohkem siit.\n\nMäärad ära soovitavad riigid, ilma täpsustamata annab kõik.\nMäärad ära, et soovid kasutada silte\nMuudab tekstiväljad faktoriteks.\n\nLisaks saab lihtsa vaevaga kätte nimekirjad riikidest, mis on liitunud euroga (ea_countries) või on euroopa riikidest (eu_countries).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Andmestiku laadimine ja tunnustega tutvumine</span>"
    ]
  },
  {
    "objectID": "01-andmestike-lugemine.html#salvestamine",
    "href": "01-andmestike-lugemine.html#salvestamine",
    "title": "1  Andmestiku laadimine ja tunnustega tutvumine",
    "section": "1.4 Andmete R-ist (välja) salvestamine",
    "text": "1.4 Andmete R-ist (välja) salvestamine\nSalvestamise käsk sõltub sellest, millist failitüüpi salvestada soovid.\n\nwrite_csv()- salvestab andmeobjetki ja erldab need komaga\nwrite.xlsx() - salvestab exceli faili. Vajab läheb paketti openxlsx (Schauberger and Walker 2023).\n\nMõlemad käsud töötavad ühte moodi. Sulgude sees tuleb esmalt täpsustada, mis andmeobjekt tuleb salvestada ja seejärel kirjutada talle nimi.\n\nwrite_csv(starwars, \"starwars.csv\")\n\n\n#library(openxlsx)\n#write.xlsx(andmed, file=\"failinimi.xlsx\")\n\n\n\n\n\n\n\nHarjuta kirjutama failinimesid nii, et ei pane sama nime failile, mis tal oli enne R-i sisse lugemist. R kirjutab projektikaustas sama nimega faili ilma hoiatamata üle.\n\n\n\nEnamasti salvestab R faili projekti kausta.\n\n\n\n\nLahti, Leo, Janne Huovari, Markus Kainu, Przemyslaw Biecek, Diego Hernangomez, Daniel Antal, and Pyry Kantanen. 2023. “Eurostat: Tools for Eurostat Open Data.” Computer software. https://github.com/rOpenGov/eurostat.\n\n\nLüdecke, Daniel. 2022. Sjlabelled: Labelled Data Utility Functions (Version 1.2.0). https://doi.org/10.5281/zenodo.1249215.\n\n\nR Core Team. 2023. Foreign: Read Data Stored by ’Minitab’, ’s’, ’SAS’, ’SPSS’, ’Stata’, ’Systat’, ’Weka’, ’dBase’, ... https://CRAN.R-project.org/package=foreign.\n\n\nSchauberger, Philipp, and Alexander Walker. 2023. Openxlsx: Read, Write and Edit Xlsx Files. https://CRAN.R-project.org/package=openxlsx.\n\n\nWickham, Hadley, and Jennifer Bryan. 2023. Readxl: Read Excel Files. https://CRAN.R-project.org/package=readxl.\n\n\nWickham, Hadley, Jim Hester, and Jennifer Bryan. 2023. Readr: Read Rectangular Text Data. https://CRAN.R-project.org/package=readr.\n\n\nWickham, Hadley, Evan Miller, and Danny Smith. 2023. Haven: Import and Export ’SPSS’, ’Stata’ and ’SAS’ Files. https://CRAN.R-project.org/package=haven.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Andmestiku laadimine ja tunnustega tutvumine</span>"
    ]
  },
  {
    "objectID": "01-andmestike-lugemine.html#footnotes",
    "href": "01-andmestike-lugemine.html#footnotes",
    "title": "1  Andmestiku laadimine ja tunnustega tutvumine",
    "section": "",
    "text": "Kui keegi on Excelis sisestanud lahtrisse ainult tühiku, siis selle eemaldamisel ei ole see andmeväli R-is enam kui puuduv väärtus (NA) ega ka tühi lahter. Selle korrigeerimiseks olen muutnud Exceli faili ennast enne R-i lugemist.↩︎\nKasutan raamatus läbisegi factor ja faktor ning mõlemad tähistavad ühte ja sama asja, et tunnusel on väärtusteks kategooriad.↩︎",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Andmestiku laadimine ja tunnustega tutvumine</span>"
    ]
  },
  {
    "objectID": "02-andmestiku-ylevaade.html",
    "href": "02-andmestiku-ylevaade.html",
    "title": "2  Andmestikust esmase ülevaate saamine",
    "section": "",
    "text": "2.1 Andmestiku suurusest ülevaate saamine\nSee peatükk kirjeldab, kuidas saada andmestiku suurusest ja struktuurist esmane ülevaade.\nTunnuste sisu põhjal andmestikust ülevaate saamiseks loe alapeatükki tunnustega tutvumine.\nAndmestikust ülevaate saamine hõlmab ka puuduvate väärtustega tutvumist ning selleks on eraldi peatükk.\nTunnuste muutmisele on pühendatud mitu peatükki, eraldi on teemadena on teksti ja katoogriaid sisaldavate tunnuste muutmine.\nEsmase ülevaate andmestiku suurusest (st ridade ja tulpade arvust) saab ka enviroment aknast, kuid vaja võib minna ka järgmisi käske.\ndim(starwars)\n\n[1] 87 14\nnrow(starwars)\n\n[1] 87\nstarwars_tegelased&lt;-nrow(starwars)\n130/starwars_tegelased\n\n\n1\n\nleiame kui suure osakaalu moodustab number 30 starwarsi tegelastest\n\n\n\n\n[1] 0.3448276",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Andmestikust esmase ülevaate saamine</span>"
    ]
  },
  {
    "objectID": "02-andmestiku-ylevaade.html#andmestiku-suurus",
    "href": "02-andmestiku-ylevaade.html#andmestiku-suurus",
    "title": "2  Andmestikust esmase ülevaate saamine",
    "section": "",
    "text": "dim()- näitab ära andmestiku read ja tulbad.\nnrow() ja ncol() - näitavad vastavalt ainult ridade või tulpade arvu.\n\n\n\n\n\n\n\n\n\nnrow() käsu abil on hea salvestada mõni väärtus values hulka ja selle väärtuse objekti kasutada mõnes tehtes\n\n\n\n\n\n\nValues Environment keskkonnas\n\n\n\n\n\n\n\n\n\nÄra ise nii pikke nimesid (starwars_tegelased) oma objektidele pane, sest koodi kirjutades on neid väga tüütu iga kord välja kirjutada. Nimeta objekte nii, et sa ise neid pärast ära tunned. Nimedes on numbrid, alakriips _ ja punkt . lubatud, kuid nimi peab algama tähega.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Andmestikust esmase ülevaate saamine</span>"
    ]
  },
  {
    "objectID": "02-andmestiku-ylevaade.html#andmestiku-struktuur",
    "href": "02-andmestiku-ylevaade.html#andmestiku-struktuur",
    "title": "2  Andmestikust esmase ülevaate saamine",
    "section": "2.2 Andmestiku struktuurist ülevaate saamine",
    "text": "2.2 Andmestiku struktuurist ülevaate saamine\nKäsud str(), glimpse(), head()ja tail() näitavad andmestiku struktuurist nii tunnuste tüüpe kui ka ridade esimesi (v.a. tail()) väärtusi. Andmestiku struktuurist saab sarnase ülevaate ka Environment keskkonnast, kui klõpsta andmestiku nime ees olevale sinisele ikoonile.\n\n\n\nAndmestiku (ja teiste objektide) koosseisuga saab tutvuda otse Environment aknas\n\n\nKäsk glimpse() hoiab väheke rohkem ruumi kokku ning täiesti maitse asi, kas kasutada glimpse(), str() või environment keskkonda. Siiski soovitan alati andmestiku pea ja saba üle vaadata, et olla veendnuda, et tunnustel on nimed ning andmestiku lõpus ei ole mõnda üleolevat rida.\n\nglimpse(starwars)\n\nRows: 87\nColumns: 14\n$ name       &lt;chr&gt; \"Luke Skywalker\", \"C-3PO\", \"R2-D2\", \"Darth Vader\", \"Leia Or…\n$ height     &lt;int&gt; 172, 167, 96, 202, 150, 178, 165, 97, 183, 182, 188, 180, 2…\n$ mass       &lt;dbl&gt; 77.0, 75.0, 32.0, 136.0, 49.0, 120.0, 75.0, 32.0, 84.0, 77.…\n$ hair_color &lt;chr&gt; \"blond\", NA, NA, \"none\", \"brown\", \"brown, grey\", \"brown\", N…\n$ skin_color &lt;chr&gt; \"fair\", \"gold\", \"white, blue\", \"white\", \"light\", \"light\", \"…\n$ eye_color  &lt;chr&gt; \"blue\", \"yellow\", \"red\", \"yellow\", \"brown\", \"blue\", \"blue\",…\n$ birth_year &lt;dbl&gt; 19.0, 112.0, 33.0, 41.9, 19.0, 52.0, 47.0, NA, 24.0, 57.0, …\n$ sex        &lt;chr&gt; \"male\", \"none\", \"none\", \"male\", \"female\", \"male\", \"female\",…\n$ gender     &lt;chr&gt; \"masculine\", \"masculine\", \"masculine\", \"masculine\", \"femini…\n$ homeworld  &lt;chr&gt; \"Tatooine\", \"Tatooine\", \"Naboo\", \"Tatooine\", \"Alderaan\", \"T…\n$ species    &lt;chr&gt; \"Human\", \"Droid\", \"Droid\", \"Human\", \"Human\", \"Human\", \"Huma…\n$ films      &lt;list&gt; &lt;\"A New Hope\", \"The Empire Strikes Back\", \"Return of the J…\n$ vehicles   &lt;list&gt; &lt;\"Snowspeeder\", \"Imperial Speeder Bike\"&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, \"Imp…\n$ starships  &lt;list&gt; &lt;\"X-wing\", \"Imperial shuttle\"&gt;, &lt;&gt;, &lt;&gt;, \"TIE Advanced x1\",…\n\n\n\nhead() - kuvab vaikimisi esimesed kuus rida. Komaga saab täpsutada kui palju on soov näha.\ntail() - kuvab andmestiku viimast kuute rida.\n\n\nhead(starwars, 3)\n\n# A tibble: 3 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…\n2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…\n3 R2-D2         96    32 &lt;NA&gt;       white, bl… red               33 none  mascu…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nsummary() - käsk toimib nii andmestike kui tunnustega. Andmestikest kokkuvõtte saamine selle käsuga on silmale mugavav lugeda siis, kui andmestikus on vähe tunnuseid.\n\ndata(Orange)\nsummary(Orange)\n\n Tree       age         circumference  \n 3:7   Min.   : 118.0   Min.   : 30.0  \n 1:7   1st Qu.: 484.0   1st Qu.: 65.5  \n 5:7   Median :1004.0   Median :115.0  \n 2:7   Mean   : 922.1   Mean   :115.9  \n 4:7   3rd Qu.:1372.0   3rd Qu.:161.5  \n       Max.   :1582.0   Max.   :214.0  \n\n\nSoovi korral võib kasutada ka paketti DataExplorer (Cui 2024) ja käsku introduce().\n\nlibrary(DataExplorer)\nintroduce(Orange)\n\n  rows columns discrete_columns continuous_columns all_missing_columns\n1   35       3                1                  2                   0\n  total_missing_values complete_rows total_observations memory_usage\n1                    0            35                105         3040\n\n\n\n\n\n\n\n\nandmestik starwars sisaldab paari tunnust, mis sisaldab list tüüpi tunnuseid (loendid) ja seepärast ei pruugi õnnestuda introduce() käsk starwars andmestikuga.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Andmestikust esmase ülevaate saamine</span>"
    ]
  },
  {
    "objectID": "02-andmestiku-ylevaade.html#tunnustega-tutvumine",
    "href": "02-andmestiku-ylevaade.html#tunnustega-tutvumine",
    "title": "2  Andmestikust esmase ülevaate saamine",
    "section": "2.3 Tunnustega tutvumine",
    "text": "2.3 Tunnustega tutvumine\nTunnustega tutvumise etapis võib tekkida tahtmine tunnuseid muuta, et neid oleks mugavam või üldse võimalik kasutada. Oma olemuselt on see tehniline töö tunnustega, millele kulub andmeanalüüsis kõige rohkem aega. Seepärast tunnuste muutmiseks eraldi pikem ja põhjalik järgmine peatükk.\nSelleks, et kõnetada konkreetset tunnust on vaja kasutada andmestiku nime järel $ märki ja kirjutada tunnuse nimi.\n\n#andmestik$tunnuse_nimi\n\nTunnustega tutvumisel vaatame nii tunnuse nime, tüüpi kui ka sisu.\n\nTunnuste nimed\nNäeb ka enviroment aknast, kuid vaja võib minna käsku names().\n\nnames(starwars)\n\n [1] \"name\"       \"height\"     \"mass\"       \"hair_color\" \"skin_color\"\n [6] \"eye_color\"  \"birth_year\" \"sex\"        \"gender\"     \"homeworld\" \n[11] \"species\"    \"films\"      \"vehicles\"   \"starships\" \n\n\n\n\nTunnuste tüübid\n\n\n\n\n\n\nLugemissoovitus\n\n\n\nRootalu, K. (2014). Tunnused ja nende tüübid. K. Rootalu, V. Kalmus, A. Masso, ja T. Vihalemm (toim), Sotsiaalse analüüsi meetodite ja metodoloogia õpibaas. https://samm.ut.ee/tunnused-ja-nende-tyybid/\n\n\nR-is on andmetüübid jaotatud järgmiselt:\n\ncharacter, &lt;chr&gt; - teksti sisaldavad tunnused, nende kohta öeldaks ka string.\ninteger, &lt;int&gt; - täisarvud\nnumeric või double, &lt;dbl&gt; - järjestikkused arvud\nlogical, &lt;lgl&gt; - ehk TRUE/FALSE või T/F\nfactor, &lt;fct&gt; - kategooria (võib inimsilmale välja näha kui number või kui tekst)\nDate - kuupäev\n\nMuud objektid võivad olla\n\ndata.frame- nn klassikaline andmestik, kus on tulbad ja read.\n\nTunnuse tüübi teada saamiseks läheb vaja käsku class(). Vaata ka peatükki [tunnuste tüübi muutmine].\n\nclass(starwars)\n\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\nKasutame sama asja tunnuse vaatamiseks.\n\nclass(starwars$name)\n\n[1] \"character\"\n\n\n\nNumbrid ja arvud\nÜtlen kõigi kohta läbivalt numbriline, kuigi R teeb vahet, kas tegemist on diskreetsete arvudega (integer) või järjestikkustega (double, numeric).\n\nclass(starwars$height)\n\n[1] \"integer\"\n\n\n\nclass(starwars$mass)\n\n[1] \"numeric\"\n\n\n\n\nTekst ja kategooriad\nTekst võib olla lihtsalt tavaline tekst (character) kui ka mõnda kategooriat tähistav tekst. Kategooriad on R-is faktorid (factor).\nKategoriaalsed tunnused jagunevad omakorda järjestatavaks (ordinal), nominaalseteks ja binaarseteks. Need tunnused oma tüübilt on ikka factor. Binaarne tunnus võib olla teinekord ka sama, mis on logical tunnus.\n\nstarwars$binaarne&lt;-is.na(starwars$hair_color)\nclass(starwars$binaarne)\n\n[1] \"logical\"\n\n\nVaata, kuidas käib tunnuste kategooriate muutmine paketiga forcats või loe paketi kohta rohkem siit.\n\n\n\nMis on vector?\nKõige lihtsam on mõelda vector-ist kui mingist loendist.\nLoendil on teatud arv ühikuid alates ühest kuni piiramatu arv. Näideks nädalapäevade loend on seitse ühikut pikk. Selle loendi ühikutel on oma kindel järjekord, sest esmaspäevale järgneb alati teisipäev.\nLoendis võivad olla ka lihtsalt arvud. Need sõnad või arvud ongi loendi ühikud. Ühikud võivad olla kindlas järjekorras, kuid ei pea olema. Kõik ühikud võivad olla üksteisest erinevad, kuid nad ei pea seda olema. Mõni ühik võib loendis ka tühi, aga ta kuulub ikkagi selle loendi hulka.\nNäiteks klassis on 10 õpilast ja nende nimed on õpetajal kõik ühele real üksteise kõrvale kirja pandud. Kuna mõnel lapsel on kaks eesnime, on õpetaja laste nimed eraldanud komaga (,). See on nimede loend. Klassis on kaks poissi, kelle nimeks on Ants. Lisaks on üks nimelahter tühi, sest õpetaja ei tea veel, mis on uue õpilase nimi, aga ta on jätnud paberil tema nime jaoks ruumi.\nKüsime õpetajalt:\n\nMitu last on sinu klassis? Vastus: 10 last.\nMitu erinevat nime on sinu klassi lastel? Vastus: “ma ei tea”. Õpetaja tahab oma vastuses olla ülitäpne, kuid ta ei selgita miks ta ei tea. Õpetaja ei oska anda õiget vastust, sest ühe lapse nimi on tal puudu ja uue õpilase nimi võib juhtumisi ka olla Ants.\nMitu erinevat nime on sinu klassi lastel, kui loendad ainult neid, kelle nimed sul teada on? Vastus: 8.\nMis on kõige sagedasem nimi sinu klassis (kui sa vaatad ainult neid nimesid, mis sul teada on)? Vastus: Ants.\n\nUmbes nii mõtleb R kui temaga suhelda. R-is on sellise klassinimede loendi objekti tüübiks vector, mis sisaldab character tüüpi andmeid. vector-it tähistab R-is c(), mille ühikud on omavahel eraldatud komaga(,). Kui vectori ühikuteks on sõnad, on nad kirjutatud jutumärkide sisse.\nTeen õpilaste arvu vektori, mis sisaldab numbreid.\n\nopilaste_arvu_vektor&lt;-c(1:10)\n\n\nopilaste_arvu_vektor\n\n [1]  1  2  3  4  5  6  7  8  9 10\n\n\nTeen õpilaste nimede vektori, mis sisaldab sõnu.\n\nopilaste_nimede_vektor&lt;-c(\"Tiina\", \"Mai\", \"Ants\", \"Kati\", \"Ants\", NA, \"Kalle\", \"Tiina Mai\", \"Mai Tiina\", \"Paul\")\n\n\nopilaste_nimede_vektor\n\n [1] \"Tiina\"     \"Mai\"       \"Ants\"      \"Kati\"      \"Ants\"      NA         \n [7] \"Kalle\"     \"Tiina Mai\" \"Mai Tiina\" \"Paul\"",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Andmestikust esmase ülevaate saamine</span>"
    ]
  },
  {
    "objectID": "02-andmestiku-ylevaade.html#tunnuste-sisuga-tutvumine",
    "href": "02-andmestiku-ylevaade.html#tunnuste-sisuga-tutvumine",
    "title": "2  Andmestikust esmase ülevaate saamine",
    "section": "2.4 Tunnuste sisuga tutvumine",
    "text": "2.4 Tunnuste sisuga tutvumine\nEsmalt tasub vaadata puuduvaid väärtusi ning selle teema kohta on eraldi peatükk.\nSeejärel tasub vaadata, millised on tunnuste väärtused ja kuidas nad jagunevad. See etapp tööst on vägagi kirjeldava statistika loomise moodi.\nnumbriliste tunnuste puhul on baaskäsud min(), max(), range(), mean(), median().\n\nmin(Orange$age)\n\n[1] 118\n\n\nsobib ka käsk summary()\n\nsummary(Orange$age)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  118.0   484.0  1004.0   922.1  1372.0  1582.0 \n\n\nsummary() käsk toimib hästi ka faktor-itega.\n\ndata(\"gss_cat\")\n\n\nsummary(gss_cat$marital)\n\n    No answer Never married     Separated      Divorced       Widowed \n           17          5416           743          3383          1807 \n      Married \n        10117 \n\n\nKui tunnuse tüüp on character, siis kuvab ta summary() käsk ülevaadet vektorist. Loe, kuidas muuta tunnuste tüüpe siit.\n\nsummary(starwars$sex)\n\n   Length     Class      Mode \n       87 character character \n\n\nKäsk table() annab character tüüpi tunnusest parema ülevaate, kuid ei kuva puuduvaid väärtusi.\n\ntable(starwars$sex)\n\n\n        female hermaphroditic           male           none \n            16              1             60              6 \n\n\n\n\n\n\nCui, Boxuan. 2024. DataExplorer: Automate Data Exploration and Treatment. https://CRAN.R-project.org/package=DataExplorer.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Andmestikust esmase ülevaate saamine</span>"
    ]
  },
  {
    "objectID": "03-tehniline-tunnused.html",
    "href": "03-tehniline-tunnused.html",
    "title": "3  Tehniline töö tunnustega",
    "section": "",
    "text": "3.1 Tunnuste muutmine\nTehniline töö tunnustega tähendab minu jaoks andmestiku ettevalmistust sisulisemaks analüüsiks. Minu jaoks on see etapp, kus piirid ettevalmistava töö ja kirjeldava statistika vahel hakkavad hägustuma, sest tunnuste väärtuste jaotust vaadatakse mõlemas osas. Seepärast on siin peatükkis juttu kohati mõlemast, sest andmete puhastamisel (ehk analüüsi ettevalmistavas etapis) on vaja kasutada samu võtteid, mida tehake kirjeldava statstika saamiseks. Valitakse analüüsiks sobivad tunnused, vaadatakse nende väärtuste jaotust, koostatakse uued tunnused olemasolevate tunnuste põhjalt või korrastatakse tunnuste kategooriad.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Tehniline töö tunnustega</span>"
    ]
  },
  {
    "objectID": "03-tehniline-tunnused.html#valimine",
    "href": "03-tehniline-tunnused.html#valimine",
    "title": "3  Tehniline töö tunnustega",
    "section": "3.2 Tunnuste valimine",
    "text": "3.2 Tunnuste valimine\nTunnuste valimine tehakse selleks, et jätta kõrvale see osa andmestikust, mis tundub parasjagu ebaoluline. Ebaoluline on see osa, mida me kindlasti analüüsis ei kasuta.\nBaasversioonis toimub tunnuste valmine nurksulgude sees, mis sisaldab koma [,]. Enne koma öeldakse R-ile, millised read tuleb valida ja peale koma, millised tulbad (tunnused). Kui jätta tühjaks, valib R kõik read ja tunnused.\ntidyverse annab meeldejäävamad käsud select() ja filter().\nMiinusmärk - käsu sees näitab, millistest tunnustest loobuda. Näiteks baasversioonis käib kolme esimene tunnuse eemaldamine andmestikust nii.\n\nstarwars[, -c(1:3)] \n\n# A tibble: 87 × 11\n   hair_color    skin_color  eye_color birth_year sex   gender homeworld species\n   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;  \n 1 blond         fair        blue            19   male  mascu… Tatooine  Human  \n 2 &lt;NA&gt;          gold        yellow         112   none  mascu… Tatooine  Droid  \n 3 &lt;NA&gt;          white, blue red             33   none  mascu… Naboo     Droid  \n 4 none          white       yellow          41.9 male  mascu… Tatooine  Human  \n 5 brown         light       brown           19   fema… femin… Alderaan  Human  \n 6 brown, grey   light       blue            52   male  mascu… Tatooine  Human  \n 7 brown         light       blue            47   fema… femin… Tatooine  Human  \n 8 &lt;NA&gt;          white, red  red             NA   none  mascu… Tatooine  Droid  \n 9 black         light       brown           24   male  mascu… Tatooine  Human  \n10 auburn, white fair        blue-gray       57   male  mascu… Stewjon   Human  \n# ℹ 77 more rows\n# ℹ 3 more variables: films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\n\nTunnuste selekteerimine\nTunnuseid võib valida ka nii, et ütled tunnuse nimed eraldades need komaga , või kasutad järjestike tunnuste valimisel : märki.\n\n1starwars|&gt;\n2  select(name, hair_color:birth_year)|&gt;\n3  head()\n\n\n1\n\nVõta andmestik starwars ja seejärel\n\n2\n\nvali tunnused “name” ja alates tunnusest “hair_color” kuni “birth_year” ja seejärel\n\n3\n\nkuva andmestiku päist\n\n\n\n\n# A tibble: 6 × 5\n  name           hair_color  skin_color  eye_color birth_year\n  &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;\n1 Luke Skywalker blond       fair        blue            19  \n2 C-3PO          &lt;NA&gt;        gold        yellow         112  \n3 R2-D2          &lt;NA&gt;        white, blue red             33  \n4 Darth Vader    none        white       yellow          41.9\n5 Leia Organa    brown       light       brown           19  \n6 Owen Lars      brown, grey light       blue            52  \n\n\nKäsud starts_with() ja ends_with() lihtsustavad tunnuste valimist veelgi.\n\nstarwars|&gt;\n1  select(starts_with(\"s\"))|&gt;\n  head()\n\n\n1\n\nvalib tunnused, mille nimi algab “s” tähega\n\n\n\n\n# A tibble: 6 × 4\n  skin_color  sex    species starships\n  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;   &lt;list&gt;   \n1 fair        male   Human   &lt;chr [2]&gt;\n2 gold        none   Droid   &lt;chr [0]&gt;\n3 white, blue none   Droid   &lt;chr [0]&gt;\n4 white       male   Human   &lt;chr [1]&gt;\n5 light       female Human   &lt;chr [0]&gt;\n6 light       male   Human   &lt;chr [0]&gt;\n\n\n\nstarwars|&gt;\n1  select(ends_with(\"color\"))|&gt;\n  head()\n\n\n1\n\nvalib tunnused, mille nimi lõpeb sõnaga “color”\n\n\n\n\n# A tibble: 6 × 3\n  hair_color  skin_color  eye_color\n  &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;    \n1 blond       fair        blue     \n2 &lt;NA&gt;        gold        yellow   \n3 &lt;NA&gt;        white, blue red      \n4 none        white       yellow   \n5 brown       light       brown    \n6 brown, grey light       blue     \n\n\nselect() käsk valib tunnused täpselt selles järjekorras nagu need kirjutad. Kui praegu algab andmestik tunnusega “name” ja oletame, et soovime panna esimeseks hoopis “mass” ning kõik muu järjekorra jätta samaks, saame kasutada käsku everything().\n\nstarwars|&gt;\n  select(mass, everything())|&gt;\n  head()\n\n# A tibble: 6 × 14\n   mass name      height hair_color skin_color eye_color birth_year sex   gender\n  &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1    77 Luke Sky…    172 blond      fair       blue            19   male  mascu…\n2    75 C-3PO        167 &lt;NA&gt;       gold       yellow         112   none  mascu…\n3    32 R2-D2         96 &lt;NA&gt;       white, bl… red             33   none  mascu…\n4   136 Darth Va…    202 none       white      yellow          41.9 male  mascu…\n5    49 Leia Org…    150 brown      light      brown           19   fema… femin…\n6   120 Owen Lars    178 brown, gr… light      blue            52   male  mascu…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\n\n\nTunnuste sisu filtreerimine\nTunnuste valimine nende sisu järgi on R-is tunnuse filteerimine ja toimub käsuga filter(). Kui me ei täpsuta käsuga select(), siis jätakse alles kõik andmesikus olevad tunnused.\n\nstarwars|&gt;\n1  filter(mass&lt;20)|&gt;\n  head()\n\n\n1\n\nvalitakse tunnuse mass väärtuste alusel need read, kus mass on väiksem kui 20\n\n\n\n\n# A tibble: 2 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Yoda          66    17 white      green      brown            896 male  mascu…\n2 Ratts Ty…     79    15 none       grey, blue unknown           NA male  mascu…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nTeksti sildava tunnus väärtus peab olema kirjutatud jutumärkide \"\" sisse.\n\nstarwars|&gt;\n  filter(hair_color==\"white\")|&gt;\n  head()\n\n# A tibble: 4 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Yoda          66    17 white      green      brown            896 male  mascu…\n2 Ki-Adi-M…    198    82 white      pale       yellow            92 male  mascu…\n3 Dooku        193    80 white      fair       brown            102 male  mascu…\n4 Jocasta …    167    NA white      fair       blue              NA fema… femin…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nTekst-i sisaldava tunnuse puhul võib kasutada ka %in% ning see toimib hästi vektor-itega. Loe vektor-ite kohta siit.\n\nstarwars|&gt;\n  filter(hair_color%in%c(\"grey\", \"white\"))\n\n# A tibble: 5 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Yoda          66    17 white      green      brown            896 male  mascu…\n2 Palpatine    170    75 grey       pale       yellow            82 male  mascu…\n3 Ki-Adi-M…    198    82 white      pale       yellow            92 male  mascu…\n4 Dooku        193    80 white      fair       brown            102 male  mascu…\n5 Jocasta …    167    NA white      fair       blue              NA fema… femin…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nTeksti puhul võib teinekord olla parem kasutada käsku str_detect(), mis tuvastab huvitava sõna esinemise andmelahtris, sest andmelahter ei pruugi sisaldada ainult seda otsitavat teksti. (Loe tekstide sisaldavate tunnuste kohta rohkem siit)\n\n\n\n\n\n\nPane tähele, et eelmise filtreerimisega (hair_color==“white”) ei tulnud välja need tegelesed, kelle juustes on halli (grey) ja mõnda teist värvi. str_detect() lahendab selle mure.\n\n\n\n\nstarwars|&gt;\n  filter(str_detect(hair_color, \"grey\"))\n\n# A tibble: 3 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…\n2 Wilhuff …    180    NA auburn, g… fair       blue              64 male  mascu…\n3 Palpatine    170    75 grey       pale       yellow            82 male  mascu…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nKui on soov filtreerida mitme väärtuse põhjal kasutades “on võrdne” tähist (==) on sage oht segi ajada | ja &. Kui soovime leida kahte nahatooni (nt “fair” ja “pale”) peame kasutama | sümbolit ja mitte &.\n\nstarwars|&gt;\n1  filter(skin_color==\"fair\" |\n2           skin_color==\"pale\")\n\n\n1\n\nfiltreeri read, kus tunnuse väärtus on võrdne sõnaga “fair” või\n\n2\n\nvõrdne sõnaga “pale”.\n\n\n\n\n# A tibble: 22 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 Luke Sk…    172  77   blond      fair       blue            19   male  mascu…\n 2 Obi-Wan…    182  77   auburn, w… fair       blue-gray       57   male  mascu…\n 3 Anakin …    188  84   blond      fair       blue            41.9 male  mascu…\n 4 Wilhuff…    180  NA   auburn, g… fair       blue            64   male  mascu…\n 5 Han Solo    180  80   brown      fair       brown           29   male  mascu…\n 6 Wedge A…    170  77   brown      fair       hazel           21   male  mascu…\n 7 Jek Ton…    180 110   brown      fair       blue            NA   &lt;NA&gt;  &lt;NA&gt;  \n 8 Palpati…    170  75   grey       pale       yellow          82   male  mascu…\n 9 Boba Fe…    183  78.2 black      fair       brown           31.5 male  mascu…\n10 Mon Mot…    150  NA   auburn     fair       blue            48   fema… femin…\n# ℹ 12 more rows\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nHead käsud filtreerimisel on ka if_any() ja if_all().\n\nstarwars|&gt;\n  filter(is.na(name) | is.na(height) | is.na(mass) | is.na(hair_color))|&gt;\n  nrow()\n\n[1] 33\n\n\nSama asja oleks mugavam rohkemate tunnustega kirjutada käsu if_any() abil nii. Sarnaselt toimib käsk if_all(), mis asendab filtreerimisel “või” (| ) märgi asemel “ja” (&).\n\nstarwars|&gt;\n  filter(if_any(name:hair_color, is.na))|&gt;\n  nrow()\n\n[1] 33",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Tehniline töö tunnustega</span>"
    ]
  },
  {
    "objectID": "03-tehniline-tunnused.html#tyybi-muutmine",
    "href": "03-tehniline-tunnused.html#tyybi-muutmine",
    "title": "3  Tehniline töö tunnustega",
    "section": "3.3 Tunnuste tüübi muutmine",
    "text": "3.3 Tunnuste tüübi muutmine\nMõnikord avastame, et tunnused on andmestikus nn vales klassis ning need on vaja ära muuta. Sõltuvalt sellest, milliseks tüübiks on soov tunnust muuta on käsud as.numeric(), as.character(), as.factor. Samad käsud toimivad ka alakriipsuga (näiteks as_numeric())\n\n\n\n\n\n\nKuupäevadeks muutmine peatükk on siin.\n\n\n\nTeen näite läbi käsuga as.factor(). Tunnuse sex tüüp on algselt character.\n\nclass(starwars$sex)\n\n[1] \"character\"\n\n\nSoovime, et on tunnus sex oleks kategoriaalne ehk faktor.\n\n\n\n\n\n\nKui sa ei ole endas kindel, kas kasutad käske õigesti, tee esmalt oma andmestikust koopia ja harjuta tunnuste muutmist seal.\n\n\n\n\n1test&lt;-starwars\n2test$sex&lt;-as_factor(test$sex)\ntest$mass&lt;-as.factor(test$mass)\n3class(test$sex)\nclass(test$mass)\n\n\n1\n\nkopeerin andmestiku starwars ja panen talle nimeks test\n\n2\n\nmuudan tunnused faktor tüübiks\n\n3\n\nkontrollin kas muutmine õnnestus\n\n\n\n\n[1] \"factor\"\n[1] \"factor\"\n\n\nfactor tunnuste muutmine numeric tunnusteks tegemisel tuleb tunnus teha esmalt character tüüpi tunnuseks. Seda saab teha kasutades koos käske as.character() ja as.numeric() koos.\n\ntest$mass&lt;-as.numeric(as.character(test$mass))\nclass(test$mass)\n\n[1] \"numeric\"\n\n\nVaata, kuidas käib mitme tunnuse üheaegne muutmine.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Tehniline töö tunnustega</span>"
    ]
  },
  {
    "objectID": "03-tehniline-tunnused.html#nime-muutmine",
    "href": "03-tehniline-tunnused.html#nime-muutmine",
    "title": "3  Tehniline töö tunnustega",
    "section": "3.4 Tunnuste nimede muutmine",
    "text": "3.4 Tunnuste nimede muutmine\nVaatame andmestiku Orange nimesid käsuga names()\n\nnames(Orange)\n\n[1] \"Tree\"          \"age\"           \"circumference\"\n\n\nSoovin nad muuta korraga ära tehes esmalt vektori “uued_nimed” uutest nimedest. (Loe vektorite kohta siit.)\n\nuued_nimed&lt;-c(\"puu\", \"vanus\", \"ymbermoot\")\n\nnames() käsuga saan muuta ära ka andmestiku nimed öeldes, millisest vectorist uued nimed võtta.\n\nnames(Orange)&lt;-uued_nimed\n\nVaatan, kas tunnuste nimed läksid õigesti taaskasutades käsku head()\n\nhead(Orange)\n\n  puu vanus ymbermoot\n1   1   118        30\n2   1   484        58\n3   1   664        87\n4   1  1004       115\n5   1  1231       120\n6   1  1372       142\n\n\nEemaldan vektor-i “uued_nimed” Environment keskkonnast.\n\nrm(uued_nimed)\n\nNimesid saab muuta ka valikuliselt käsuga rename().\n\nOrange|&gt;\n  rename(uus_nimi=puu,\n         ym=ymbermoot)|&gt;\n  head(2)\n\n  uus_nimi vanus ym\n1        1   118 30\n2        1   484 58",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Tehniline töö tunnustega</span>"
    ]
  },
  {
    "objectID": "03-tehniline-tunnused.html#sisu-muutmine",
    "href": "03-tehniline-tunnused.html#sisu-muutmine",
    "title": "3  Tehniline töö tunnustega",
    "section": "3.5 Tunnuste sisu muutmine",
    "text": "3.5 Tunnuste sisu muutmine\nTunnuste sisu1 muutmisel teeme kas täitsa uued tunnused olemasoleva põhjalt või kirjutame olemasoleva tunnuse üle.\nKui on soov muuta numbrilist tunnust mingi teise numbri või numbrilise tunnusega, saab seda teha väga lihtsalt ja kasutada R-i kui tavalist kalkulaatorit. Näiteks teisendame tunnuse height sentimeetritest meetriteks jagades tunnust 100-ga.\n\nstarwars$pikkus_m&lt;-starwars$height/100\n\n\nstarwars|&gt;\n  select(height, pikkus_m)|&gt;\n  head()\n\n# A tibble: 6 × 2\n  height pikkus_m\n   &lt;int&gt;    &lt;dbl&gt;\n1    172     1.72\n2    167     1.67\n3     96     0.96\n4    202     2.02\n5    150     1.5 \n6    178     1.78\n\n\nArvutada saab ka kahe olemasoleva tunnuse järgi tehes samamoodi tehe. Arvutame tegelaste kehamassindeksi(kmi). Teeme selleks arvutustehte, kus jagame kehakaalu pikkuse ruuduga ^2.\n\nstarwars$kmi&lt;-starwars$mass/(starwars$pikkus_m)^2\n\n\nstarwars|&gt;\n  select(name, kmi)|&gt;\n  head(3)\n\n# A tibble: 3 × 2\n  name             kmi\n  &lt;chr&gt;          &lt;dbl&gt;\n1 Luke Skywalker  26.0\n2 C-3PO           26.9\n3 R2-D2           34.7\n\n\n\n\n\n\n\n\nR teeb selliseid arvutusi nagu talle ütled. R ei ole kriitiline ega ütle sulle, et kehamassi-indeksi arvutusvalem on mõeldud inimeste kehakaalu ja pikkuse suhte arvutamiseks ning järeldusi droidide või teiste liikide esindajate kohta teha ei saa. Nii nagu iga analüüsimeetodi kasutamisel peab ise mõtlema, kas see on parasjagu sobilik meetod ja tunnuste kasutamine meetodi sees loogiline.\n\n\n\nTunnuste sisu muutmiseks on käsk mutate() koos mõne järgmise käsuga:\n\nif_else() - juhul kui käsk sobib hästi üksiku tunnuse muutmiseks kui ka mitme tunnuse üheaegseks muutmiseks. vaata näidet\nrecode() - juhul kui soovime muuta tunnuse väärtusi vaata näidet\ncase_when() - sobib keerulistema lausete tegemiseks uute või olemasolevate tunnuste väärtuste muutmisel. Vaata näidet\n\nKuid vajalik on tunda käske separate() ja unite(). Vaata nende käskude kasutamist siit\nTunnuste kategooria-te ühendamiseks vaata ka siia. Teksti sisaldavate tunnustega töötamisel vaata siia.\n\nÜksiku väärtuse muutmine\nTunnuse väärtus on tunnuse sisu. Näiteks tunnuse “name” väärtusteks on tegelaste nimed. “Luke Skywalker” on tunnuse “name” üks väärtus.\nNäiteks soovime muuta tegelast “Gregor Typho” ja öelda, et ta on liigilt (tunnus “species”) inimene.\n\n1test&lt;-starwars|&gt;\n2  mutate(species=if_else(\n3    name==\"Gregar Typho\",\n4    \"Inimene\",\n5    species))\n\n\n1\n\nLoo koopia nimega “test” andmestikust “starwars”;\n\n2\n\nmuuda tunnust “species” juhul kui\n\n3\n\npärast kontrolli, et tunnuse “name” väärtus on võrdne tekstiga “Gregar Typho”;\n\n4\n\nselgub, et see2 on tõesti on nii, siis pane väärtuseks “Inimene”;\n\n5\n\nkui see ei ole nii, siis kasuta seda väärtust, mis oli.\n\n\n\n\nNüüd vaatan, kas muutmine õnnestus.\n\ntest|&gt;\n  select(name, species)|&gt;\n  filter(name==\"Gregar Typho\")\n\n# A tibble: 1 × 2\n  name         species\n  &lt;chr&gt;        &lt;chr&gt;  \n1 Gregar Typho Inimene\n\n\n\n\n\n\n\n\nAlati kontrolli oma tehtud töö üle, kas muutsid ikka seda tunnust ja sellisel viisil, mida muuta soovisid. Kui kontrollid oma tööd nii, et vaatad ainult seda tunnust, mida muuta tahtsid, ei leia sa üles võimalikke vigu, mida tunnuste muutmisel teha võisid.\n\n\n\nSama asja tegemine baasversioonis käib käsu which()abil ning asendan kategooria “Inimene” kategooriaga “Human”.\n\ntest$species[which(test$name==\"Gregar Typho\")] &lt;- \"Human\"\n\n\n\n\n\n\n\nKäsku if_else() saab kasutada edukat ka terve vektori muutmiseks ja mitte ainult üksiku väärtuse muutmiseks.\n\n\n\n\n\nTunnuse väärtuse muutmine\nTunnuse väärtuste muutmiseks saab kasutada ka käsu recode().\n\ntable(starwars$gender)\n\n\n feminine masculine \n       17        66 \n\n\n\n1recode(starwars$gender,\n2       feminine= \"naiselik\",\n       masculine= \"mehelik\")%&gt;%\n3  table()\n\n\n1\n\nKodeeri starwars andmestikust tunnus gender ringi\n\n2\n\nAnnan uute kategooriate nimed ja seejärel\n\n3\n\nVaatan, kas muutmine õnnestus\n\n\n\n\n.\n mehelik naiselik \n      66       17 \n\n\n\n\nMitme tunnuse põhjal uute väärtuse loomine\nOletame, et soovin saada ülevaadet lühikestest inimesest nii, et on kaks kategooriat “pikk inimene” ja “lühike inimene”. Tahan teha selleks uut tunnust nimega “pikkuse_liik”. Kategooria “pikk inimene” alla soovin lisada kõik inimesed, kes on vähemalt 160 cm pikad. Teise kategooriasse “lühike inimene” ja soovin lisada kõik inimesed, kes on lühemad kui 160cm. Soovin vaadata üle, kas paljude tegelaste liik või mass on teadmata, et emba-kumba vajadusel täpsustama minna (st küsima liiki või mõõtma pikkust).\n\n1test&lt;-starwars|&gt;\n2  mutate(pikkuse_liik=case_when(\n3    species==\"Human\" & height &gt; 159 ~ \"pikk inimene\",\n4    species==\"Human\" & height &lt; 160 ~ \"lühike inimene\",\n5    is.na(species) ~ \"ei tea, kas on inimene\",\n6    is.na(height) ~ \"ei tea, kui pikk on\"\n  ))\n\n\n1\n\nLoo koopia nimega “test” andmestikust “starwars”;\n\n2\n\nmuuda andmestikku (ja loo sinna) tunnus “pikkus_liik” juhul kui tunnus-te;\n\n3\n\nspecies sisu on “Human” ja samal ajal “height” on suurem kui 159 (ehk vähemalt 160), määra kategooria väärtuseks “pikk inimene”;\n\n4\n\nspecies sisu on “Human” ja samal ajal “height” on kuni 160 (ehk kõrgeim väärtus on 159), määra kategooria väärtuseks “lühike inimene”;\n\n5\n\nkui species on NA, määra kategooria väärtuseks “ei tea, kas on inimene”;\n\n6\n\nkui species on NA, määra kategooria väärtuseks “ei tea, kui pikk on”.\n\n\n\n\nVaatan, kas tekkis tunnuse alla neli kategooriat ja nende alla ka inimesi.\n\ntable(test$pikkuse_liik)\n\n\nei tea, kas on inimene    ei tea, kui pikk on         lühike inimene \n                     4                      6                      2 \n          pikk inimene \n                    28 \n\n\nNüüd aga otsustan, et kirjutan olemasoleva tunnuse üle nii, et need kelle pikkus või liik on teadmata (NA), lähevad kategooria alla “ei saa kategoriseerdia” ning kõigi ülejäänutel jääb kategooria samaks.\n\n1test&lt;-test|&gt;\n2  mutate(pikkuse_liik=case_when(\n3    is.na(species) | is.na (height) ~ \"ei saa kategoriseerida\",\n4    TRUE ~ pikkuse_liik\n  ))\n\n\n1\n\nKirjuta andmestik “test” üle;\n\n2\n\nmuuda olemasolevat tunnus-t “pikkus_liik” juhul kui tunnus-te;\n\n3\n\nspecies sisu on teadmata (NA) või heigth sisu on teadmata (NA), määra neile kategooria “ei saa kategoriseerida”;\n\n4\n\nülejäänute vaatlus-tel jäta kategooria nii nagu on pikkuse_liik.\n\n\n\n\n\ntable(test$pikkuse_liik)\n\n\nei saa kategoriseerida         lühike inimene           pikk inimene \n                    10                      2                     28 \n\n\n\n\n\n\n\n\nJäta meelde, et kõik ülejäänud read, mis ei sobitu ühegi kategooria alla jäävad tühjaks ehk NA.\n\n\n\n\n\nTunnuste sisu eraldamine\nSoovin eraldada tunnuse “name” sisu nii, et ühes tulbas on eesnimed ja teised ainult perekonnanimed. Selleks on käsk separate().\n\n1starwars|&gt;\n2  separate(col=name,\n3           into = c(\"eesnimi\", \"perenimi\"),\n4           sep = \" \")|&gt;\n5  head()\n\n\n1\n\nÜtleme, millise andmestiku,\n\n2\n\nmillist tunnust eraldame;\n\n3\n\nmis saavad olema nende uute tunnuste nimed ja\n\n4\n\nmille kaudu eraldada (tühik \" \") ja siis\n\n5\n\nvaatame siin näites kohe ka päist, kas muutmine õnnestus.\n\n\n\n\n# A tibble: 6 × 17\n  eesnimi perenimi height  mass hair_color skin_color eye_color birth_year sex  \n  &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;\n1 Luke    Skywalk…    172    77 blond      fair       blue            19   male \n2 C-3PO   &lt;NA&gt;        167    75 &lt;NA&gt;       gold       yellow         112   none \n3 R2-D2   &lt;NA&gt;         96    32 &lt;NA&gt;       white, bl… red             33   none \n4 Darth   Vader       202   136 none       white      yellow          41.9 male \n5 Leia    Organa      150    49 brown      light      brown           19   fema…\n6 Owen    Lars        178   120 brown, gr… light      blue            52   male \n# ℹ 8 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,\n#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;, pikkus_m &lt;dbl&gt;, kmi &lt;dbl&gt;\n\n\n\n\n\n\n\n\nPane tähele, et eraldatav tunnus kaob andmestikust ära. Kui soovid alles jätta originaaltunnuse, siis tee sellest esmalt andmestikku koopia.\n\n\n\nEraldajaks (sep=) võib olla ka number. Näiteks tahame eraldada andmestiku gss_cat tunnust “year” nii, et esimeses tulbas on “sajand” ja teises “kümnend”. Esmalt võtame andmestiku kasutusele ja vaatame esimest kolme rida.\n\ndata(\"gss_cat\")\nhead(gss_cat,3)\n\n# A tibble: 3 × 9\n   year marital         age race  rincome        partyid     relig denom tvhours\n  &lt;int&gt; &lt;fct&gt;         &lt;int&gt; &lt;fct&gt; &lt;fct&gt;          &lt;fct&gt;       &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;\n1  2000 Never married    26 White $8000 to 9999  Ind,near r… Prot… Sout…      12\n2  2000 Divorced         48 White $8000 to 9999  Not str re… Prot… Bapt…      NA\n3  2000 Widowed          67 White Not applicable Independent Prot… No d…       2\n\n\nNüüd eraldame tunnuse nii, et kirjutame alates mitmendast tähemärgist eraldamine teha tuleb (antud näite puhul pärast teist tähemärki).\n\ngss_cat|&gt;\n  separate(col=year,\n           into = c(\"sajand\", \"kymnend\"),\n1           sep = 2)|&gt;\n  head(3)\n\n\n1\n\nEralda alates pärast teist tähemärki\n\n\n\n\n# A tibble: 3 × 10\n  sajand kymnend marital         age race  rincome   partyid relig denom tvhours\n  &lt;chr&gt;  &lt;chr&gt;   &lt;fct&gt;         &lt;int&gt; &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;\n1 20     00      Never married    26 White $8000 to… Ind,ne… Prot… Sout…      12\n2 20     00      Divorced         48 White $8000 to… Not st… Prot… Bapt…      NA\n3 20     00      Widowed          67 White Not appl… Indepe… Prot… No d…       2\n\n\nVaata ka alapeatükki stringi eraldamine.\n\n\nTunnuste sisu ühendamine\nSoovin ühendada kahe tunnuse väärtuseid nii, et neist tekib üks uus tunnus. Näiteks tahan panna kokku starwars tegelased nende liigi (species) ja kodumaailma (homeworld) järgi. Seda saab teha käsuga unite(). See on sarnale käsule separate(), kuid nagu pööratult.\n\nEsmalt ütled ühendamiseks uue tunnuse nime,\nseejäre, milliste tunnuste sisu sinna ühendada,\nja kas või mis peaks olema ühendatava tunnuste väärtuste vahel.\n\n\nstarwars|&gt;\n  unite(col=paritolu,\n        homeworld, species,\n1        sep=\", \") |&gt;\n  select(name, paritolu)|&gt;\n  head()\n\n\n1\n\npane tähele, et siin on koma järele lisatud tühik\n\n\n\n\n# A tibble: 6 × 2\n  name           paritolu       \n  &lt;chr&gt;          &lt;chr&gt;          \n1 Luke Skywalker Tatooine, Human\n2 C-3PO          Tatooine, Droid\n3 R2-D2          Naboo, Droid   \n4 Darth Vader    Tatooine, Human\n5 Leia Organa    Alderaan, Human\n6 Owen Lars      Tatooine, Human\n\n\n\n\n\n\n\n\nSarnaselt separate() käsule kaotab unite() käsk liidetavad tunnused andmestikust ära. Kui sa seda ei soovi, tee esmalt tunnustest andmestikku koopia.\n\n\n\nJuhul kui ei soovi, et kahe liidetava tunnuse väärtuse vahel oleks mõni eraldav tähemärk, pane eraldajaks jutumärgid ilma tühikuta \"\" .",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Tehniline töö tunnustega</span>"
    ]
  },
  {
    "objectID": "03-tehniline-tunnused.html#töö-mitme-tunnusega-korraga",
    "href": "03-tehniline-tunnused.html#töö-mitme-tunnusega-korraga",
    "title": "3  Tehniline töö tunnustega",
    "section": "3.6 Töö mitme tunnusega korraga",
    "text": "3.6 Töö mitme tunnusega korraga\nacross() käsu abil saab korraga muuta või arvutada mitme tunnusega sama asja. Selleks peame käsku kasutame mutate() või summarise() käsu sees.\nOletame, et tahame korraga teada saada kindlate tunnuste keskmisi väärtusi.\n\n\n\n\n\n\nR-i on vahepeal muudetud. Varem toimis mitme tunnuse puhul korraga arvutamine nii.\n\nstarwars%&gt;%\n  group_by(gender)%&gt;%\n  summarise(across(height:mass, mean, na.rm=T))\n\n# A tibble: 3 × 3\n  gender    height  mass\n  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;\n1 feminine    167.  54.7\n2 masculine   177. 107. \n3 &lt;NA&gt;        175   81  \n\n\nR arvutab välja küll, kuid annab hoiatuse ning soovitab saata käsud läbi nimetu funktsiooni (vt all näidet).\n\n\n\n\nstarwars|&gt;\n  group_by(gender)|&gt;\n  summarise(across(height:mass, \\(x) median(x, na.rm = TRUE)),\n            arv=n())\n\n# A tibble: 3 × 4\n  gender    height  mass   arv\n  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;\n1 feminine     167    55    17\n2 masculine    183    80    66\n3 &lt;NA&gt;         179    85     4\n\n\nOletame, et numbrilisi tunnuseid on rohkem ja nende väljakirjutamine oleks tüütu ajakulu. across() ja where() kombineerides töötab see justkui select() käsu asemel.\n\nstarwars|&gt;\n  group_by(gender)|&gt;\n  summarise(across(where(is.numeric), mean, na.rm=T))\n\n# A tibble: 3 × 6\n  gender    height  mass birth_year pikkus_m   kmi\n  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;\n1 feminine    167.  54.7       47.2     1.67  18.9\n2 masculine   177. 107.        96.8     1.77  35.0\n3 &lt;NA&gt;        175   81        NaN       1.75  24.6\n\n\n\nwhere(is.numeric) valib kõik numeric tulbad.\nwhere(is.character) valib kõik teksti tulbad.\nwhere(is.Date) valib date tunnused ehk kuupäevad.\nwhere(is.POSIXct) valib kõik kuupäeva-kellaja tunnused.\nwhere(is.logical) valib kõik logical tunnused.\n\nMuudame näiteks kõik character tüüpi tunnused factoriteks.\n\nstarwars|&gt;\n  mutate(across(where(is.character), as.factor))|&gt;\n  head(2)\n\n# A tibble: 2 × 16\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;      &lt;fct&gt;      &lt;fct&gt;          &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; \n1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…\n2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…\n# ℹ 7 more variables: homeworld &lt;fct&gt;, species &lt;fct&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;, pikkus_m &lt;dbl&gt;, kmi &lt;dbl&gt;\n\n\n\n\n\n\n\n\nSeda valikut saab laiendada is.na() ja ! ning & operaatoritega ning käsuga starts_with().",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Tehniline töö tunnustega</span>"
    ]
  },
  {
    "objectID": "03-tehniline-tunnused.html#footnotes",
    "href": "03-tehniline-tunnused.html#footnotes",
    "title": "3  Tehniline töö tunnustega",
    "section": "",
    "text": "Kasutan mugavama lugemise huvides sünonüümidena tunnuse sisu ja tunnuse väärtus.↩︎\nEhk tunnuse “name” lahter võrdne tekstiga “Gregar Typho”↩︎",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Tehniline töö tunnustega</span>"
    ]
  },
  {
    "objectID": "04-faktor-string.html",
    "href": "04-faktor-string.html",
    "title": "4  Töö teksti sisaldavate tunnustega",
    "section": "",
    "text": "4.1 Töö factor-ite ehk kategooriatega\nKategoriaalsete tunnuste muutmiseks ei pea (kuigi võib) kasutada käskude mutate() ja case_when või if_else() kombinatsioone. Pakett forcats(Wickham 2023) teeb kategoriaalsete tunnuste muutmise lihtsaks ning kui on kasutusel pakett tidyverse, siis see on juba kasutusele võetud.\nLoe paketi kohta rohkem siit.\nTunnused peavad olema factor-id. Loe vajadusel tunnuste tüübi muutmist siit.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Töö teksti sisaldavate tunnustega</span>"
    ]
  },
  {
    "objectID": "04-faktor-string.html#forcats",
    "href": "04-faktor-string.html#forcats",
    "title": "4  Töö teksti sisaldavate tunnustega",
    "section": "",
    "text": "Kategooriate järjestuse muutmine\nVaikimisi on kõik kategooriad reastatud tähestiku järjekorras ning neid kuvatakse nii ka kokkuvõtete või jooniste tegemisel. Näiteks summary() käsk näitab (faktoriks muudetud) tunnust nii. Vaata, kuidas muuta tunnuste tüüpi siit.\n\nsummary(starwars$sex)\n\n          male           none         female hermaphroditic           NA's \n            60              6             16              1              4 \n\n\nTasemeid saab vaadata käsuga levels().\n\nlevels(starwars$sex)\n\n[1] \"male\"           \"none\"           \"female\"         \"hermaphroditic\"\n\n\nMuudame kategooriate esitamise ringi vastavalt sagedusele, ehk kõige suurem kategooria kuvatakse kõige esimesena. Kasutame käsku fct_infreq().\n\nstarwars$sex&lt;-fct_infreq(starwars$sex, ordered = NA)\n\n\nlevels(starwars$sex)\n\n[1] \"male\"           \"female\"         \"none\"           \"hermaphroditic\"\n\n\nOletame, et soovime näidata vastupidi. Kõige vähem esinevat kategooriat kõige eespool. Muudame kategooriate järjestuse tagurpidi fct_rev().\nKui eelnevalt pole järjestust muudetud, siis paneb see käsk kategooriad tähestiku tagant poolt ette poole jooksma.\n\nstarwars$sex&lt;-fct_rev(starwars$sex)\n\n\nlevels(starwars$sex)\n\n[1] \"hermaphroditic\" \"none\"           \"female\"         \"male\"          \n\n\nKui on vajadus esitada kategooriaid selles järjekorras nagu nad andmestikus esinevad, siis on käsk fct_inorder().\n\nstarwars$sex&lt;-fct_inorder(starwars$sex)\n\n\nlevels(starwars$sex)\n\n[1] \"male\"           \"none\"           \"female\"         \"hermaphroditic\"\n\n\nLisaks on võimalik käsu factor() sees kirjutada käsitsi täpselt see järjekord nagu parasjagu soov on. Sama asja saab teha ka paketiga forcats käsuga fct_relevel() (vaata näidet veidike all pool).\n\nstarwars$sex&lt;-factor(starwars$sex,\n                      levels=c(\n1                      \"male\",\"female\",\"none\", \"hermaphroditic\"),\n2                     ordered=T)\n\n\n1\n\nKirjutab väärtuste kategooriate nimed\n\n2\n\nÜtleb, et kategooriate tasemed peavad olema esitatud järjekorras\n\n\n\n\nfct_count() annab ka ülevaate, kuidas jagunevad tunnuse väärtused reastatud kategooriate järgi ning kui suured need kategooriad on. See käsk on parem kui table(), sest näitab kohe ka puuduvaid väärtusi.\n\nfct_count(starwars$sex)\n\n# A tibble: 5 × 2\n  f                  n\n  &lt;ord&gt;          &lt;int&gt;\n1 male              60\n2 female            16\n3 none               6\n4 hermaphroditic     1\n5 &lt;NA&gt;               4\n\n\nKordame sama, et kirjutame ise kategooriate järjekorra käsuga fct_relevel(). Selle käsu puhul peab veidi vähem koodi kirjutama.\n\nstarwars$sex&lt;-fct_relevel(starwars$sex,\n                          c(\"none\", \"female\", \"hermaphroditic\", \"male\"))\n\n\nfct_count(starwars$sex)\n\n# A tibble: 5 × 2\n  f                  n\n  &lt;ord&gt;          &lt;int&gt;\n1 none               6\n2 female            16\n3 hermaphroditic     1\n4 male              60\n5 &lt;NA&gt;               4\n\n\n\n\nKategooriate ühendamine\nKui on soov panna kaks kategooriat kokku, siis on sobiv käsk fct_collapse(). Sama asja saab teha käskudega mutate ja case_when(), kuid ka siin on eeliseks lühem kood.\n\n\n\n\n\n\nSoovitan andmestikus mitte muuta oringaaltunnust ja teha selleks täiesti uus tunnus.\n\n\n\n\nstarwars$sugu&lt;-fct_collapse(starwars$sex,\n                            male=\"male\",\n                            female=\"female\",\n1                            other=c(\"none\", \"hermaphroditic\"))\n\n\n1\n\nÜtleb, milliste kategooriate nimed, tuleb panna kategooria “other” alla.\n\n\n\n\nfct_count() on uute kategooriate jagunemise vaatamiseks parem kui table(), kuna näitab ära ka puuduvad väärtused.\n\ntable(starwars$sugu)\n\n\n other female   male \n     7     16     60 \n\n\n\nfct_count(starwars$sugu)\n\n# A tibble: 4 × 2\n  f          n\n  &lt;ord&gt;  &lt;int&gt;\n1 other      7\n2 female    16\n3 male      60\n4 &lt;NA&gt;       4\n\n\nÜpris sagedasti on andmete esitamisel vaja kokku liita kategooria “muu” alla need read, mida on andmestikus vähem kui viis. Selleks tegevuseks on hea kasutada käsku fct_lump_min().\n\nstarwars$kodumaa&lt;-fct_lump_min(starwars$homeworld,\n1                               5,\n2                               other_level = \"muu\")\n\n\n1\n\nÜtleb kui suur võib olla grupp, mida ei panda other_level hulka\n\n2\n\nÜtlem, mis panna other_level grupi (ehk kokkuliidetud grupi) nimeks.\n\n\n\n\n\nfct_count(starwars$kodumaa)\n\n# A tibble: 4 × 2\n  f            n\n  &lt;fct&gt;    &lt;int&gt;\n1 Naboo       11\n2 Tatooine    10\n3 muu         56\n4 &lt;NA&gt;        10\n\n\nNüüd on näha, et neid tegelasi, kelle homeword on “muu”, on andmestikus kokku kõvasti rohkem kui tegelasi kõige enamlevinud maailmast.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Töö teksti sisaldavate tunnustega</span>"
    ]
  },
  {
    "objectID": "04-faktor-string.html#stringid",
    "href": "04-faktor-string.html#stringid",
    "title": "4  Töö teksti sisaldavate tunnustega",
    "section": "4.2 Töötamine teksti ehk string-idega",
    "text": "4.2 Töötamine teksti ehk string-idega\nSee peatükk räägib, kuidas muuta tunnuseid, mis on character tüüpi.\nSee peatükk ei räägi tekstikaevest ega tekstianalüüsist.\ncharacter tüüpi tunnus on R-is string. Vaata ka tunnuste tüübid ja vajadusel loe tehnilise töö kohta juurde siit.\nPaketiga tidyverse tuleb kaasa pakett stringr(Wickham 2022), kus kõik käsud algavad lühendiga str_.\nKasutame näidisena nimede vektorit starwars tegelastest, kes on pärit maailmast “Tatooine” (vaata ka mis on vektor.) Esmalt peame selle vektori aga tegema.\n\n1nimed&lt;-starwars|&gt;\n  filter(homeworld==\"Tatooine\")|&gt;\n2  select(name)|&gt;\n3  as_vector()\n\n\n1\n\nSalvestab objekti nimed\n\n2\n\njätab alles ainult ühe tulba tunnuseid\n\n3\n\nsalvestab need väärtused vektoriks\n\n\n\n\n\nnimed\n\n               name1                name2                name3 \n    \"Luke Skywalker\"              \"C-3PO\"        \"Darth Vader\" \n               name4                name5                name6 \n         \"Owen Lars\" \"Beru Whitesun Lars\"              \"R5-D4\" \n               name7                name8                name9 \n \"Biggs Darklighter\"   \"Anakin Skywalker\"     \"Shmi Skywalker\" \n              name10 \n       \"Cliegg Lars\" \n\n\nstr_detect() kontrollib, kas vector tunnuse väärtused sisaldavad mingit kindlat väärtust. Vastuse antakse TRUE/FALSE põhimõttel ehk kas on või ei ole otsitav väärtus andmevälja sees.\nVaatame, kas mõnel Tatooine tegelasel on nimi “Lars”.\n\nstr_detect(nimed, \"Lars\")\n\n [1] FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE\n\n\nKui selline kasutus võib tunduda ebamugav, siis kasulikuks muutub see käsk siis, kui kasutame seda mõne muu käsuga koos (nt filter() nagu tegime seda hallide juustega starwars tegelaste puhul). Kordame seda näidet nüüd, aga filtreerime välja starwars andmestikust need tegelased, kelle nimes tuvastame teksti “Lars”.\n\nstarwars|&gt;\n  filter(str_detect(name, \"Lars\"))\n\n# A tibble: 3 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…\n2 Beru Whi…    165    75 brown      light      blue              47 fema… femin…\n3 Cliegg L…    183    NA brown      fair       blue              82 male  mascu…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nSarnaselt töötab ka käsk str_subset(). Ütleme, et me tahame teada kelle nimed andmestikus sisaldavad nime “Lars”?\n\nstr_subset(starwars$name, \"Lars\")\n\n[1] \"Owen Lars\"          \"Beru Whitesun Lars\" \"Cliegg Lars\"       \n\n\nKoos filtriga peaks selle vektori eelnevalt salvestama ja kasutama vektorit filter() käsu sees.\n\nlars_vektor&lt;-str_subset(starwars$name, \"Lars\")\n\nstarwars|&gt;\n  filter(name%in%lars_vektor)\n\n# A tibble: 3 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…\n2 Beru Whi…    165    75 brown      light      blue              47 fema… femin…\n3 Cliegg L…    183    NA brown      fair       blue              82 male  mascu…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nOletame, et perekond Lars muutis oma nime ning nüüd on nad edaspidi kõik perekonnanimega Sarl. Üks võimalus on teha seda muidugi käskudega mutate()ja if_else() (vaata kuidas siit), kuid mugavam on muuta sisu teha käskudega str_replace() või str_replace_all().\n\nTunnuse sisu asendamine\n\n\n\n\n\n\nKui on vaja muuta kogu tunnust võib abi olla käsust recode().\n\n\n\nEsmalt tuleb str_replace() puhul öelda käsu sees, millist tunnust muuta ja seejärel millist stringi asendada millise sõnaga.\n\n#str_replcae(tunnus, \"vana string\", \"uus string\")\n\n\nstr_replace(nimed, \"Lars\", \"Sarl\")\n\n [1] \"Luke Skywalker\"     \"C-3PO\"              \"Darth Vader\"       \n [4] \"Owen Sarl\"          \"Beru Whitesun Sarl\" \"R5-D4\"             \n [7] \"Biggs Darklighter\"  \"Anakin Skywalker\"   \"Shmi Skywalker\"    \n[10] \"Cliegg Sarl\"       \n\n\nOletame, et “r” täht on ära keelatud ja see on vaja nüüd igal pool (stringi alguses, keskel jne) ära muuta täheks “x”. (Utoopia muidugi, aga käsu töö näitamiseks ei tulnud paremat ideed.)\n\nstr_replace_all(nimed, \"r\", \"x\")\n\n [1] \"Luke Skywalkex\"     \"C-3PO\"              \"Daxth Vadex\"       \n [4] \"Owen Laxs\"          \"Bexu Whitesun Laxs\" \"R5-D4\"             \n [7] \"Biggs Daxklightex\"  \"Anakin Skywalkex\"   \"Shmi Skywalkex\"    \n[10] \"Cliegg Laxs\"       \n\n\nOletame, et soovime stringi muuta nii, et me ei taha sealt midagi asendada, vaid soovime olemasolevale lisada juurde. Näiteks paneme iga nime ette tiitli “härra” (sõltumata sellest, kas ta on härra või ei).\nKasutame käsku str_sub().\n\nstr_sub(nimed, 1, 0) &lt;- \"härra \"\n\n\nnimed\n\n [1] \"härra Luke Skywalker\"     \"härra C-3PO\"             \n [3] \"härra Darth Vader\"        \"härra Owen Lars\"         \n [5] \"härra Beru Whitesun Lars\" \"härra R5-D4\"             \n [7] \"härra Biggs Darklighter\"  \"härra Anakin Skywalker\"  \n [9] \"härra Shmi Skywalker\"     \"härra Cliegg Lars\"       \n\n\nVõtame nüüd uuesti nimest “härra” välja nii, et asendame härra mitte millegagi.\n\n\n\n\n\n\nTeksti eemaldamisel mõtle kohe ka whitespace eemaldamise peale. Järgmise käsu näites jääb tühik sisse, et ülejärgmise käsu näites ta eemaldada.\n\n\n\n\nnimed&lt;-str_replace(nimed, \"härra\", \"\")\nnimed\n\n [1] \" Luke Skywalker\"     \" C-3PO\"              \" Darth Vader\"       \n [4] \" Owen Lars\"          \" Beru Whitesun Lars\" \" R5-D4\"             \n [7] \" Biggs Darklighter\"  \" Anakin Skywalker\"   \" Shmi Skywalker\"    \n[10] \" Cliegg Lars\"       \n\n\nKõigi nime ette jäi nüüd tühik \" \" ja me tahame temast lahti saada. whitspace1 eemaldamiseks on käsk str_trim() ning selle käsu sees saab täpsutada, kas üleliigne on vaja eemaldada “left”, “right” või “both”.\n\nnimed&lt;-str_trim(nimed, side=\"left\")\nnimed\n\n [1] \"Luke Skywalker\"     \"C-3PO\"              \"Darth Vader\"       \n [4] \"Owen Lars\"          \"Beru Whitesun Lars\" \"R5-D4\"             \n [7] \"Biggs Darklighter\"  \"Anakin Skywalker\"   \"Shmi Skywalker\"    \n[10] \"Cliegg Lars\"       \n\n\n\nnimed\n\n [1] \"Luke Skywalker\"     \"C-3PO\"              \"Darth Vader\"       \n [4] \"Owen Lars\"          \"Beru Whitesun Lars\" \"R5-D4\"             \n [7] \"Biggs Darklighter\"  \"Anakin Skywalker\"   \"Shmi Skywalker\"    \n[10] \"Cliegg Lars\"       \n\n\n\n\nSuur ja väike täht tekstis\nSuure ja väikese tähe muutmiseks on abiks mitmed käsud. Nende kasutamine on mugavalt lihtne ega vaja pikemad kirjeldamist.\n\nstr_to_lower()\nstr_to_upper()\nstr_to_title()\nstr_to_sentence()\n\n\nstr_to_lower(nimed)\n\n [1] \"luke skywalker\"     \"c-3po\"              \"darth vader\"       \n [4] \"owen lars\"          \"beru whitesun lars\" \"r5-d4\"             \n [7] \"biggs darklighter\"  \"anakin skywalker\"   \"shmi skywalker\"    \n[10] \"cliegg lars\"       \n\n\n\nstr_to_upper(nimed)\n\n [1] \"LUKE SKYWALKER\"     \"C-3PO\"              \"DARTH VADER\"       \n [4] \"OWEN LARS\"          \"BERU WHITESUN LARS\" \"R5-D4\"             \n [7] \"BIGGS DARKLIGHTER\"  \"ANAKIN SKYWALKER\"   \"SHMI SKYWALKER\"    \n[10] \"CLIEGG LARS\"       \n\n\n\nstr_to_title(nimed)\n\n [1] \"Luke Skywalker\"     \"C-3po\"              \"Darth Vader\"       \n [4] \"Owen Lars\"          \"Beru Whitesun Lars\" \"R5-D4\"             \n [7] \"Biggs Darklighter\"  \"Anakin Skywalker\"   \"Shmi Skywalker\"    \n[10] \"Cliegg Lars\"       \n\n\n\nstr_to_sentence(nimed)\n\n [1] \"Luke skywalker\"     \"C-3po\"              \"Darth vader\"       \n [4] \"Owen lars\"          \"Beru whitesun lars\" \"R5-d4\"             \n [7] \"Biggs darklighter\"  \"Anakin skywalker\"   \"Shmi skywalker\"    \n[10] \"Cliegg lars\"       \n\n\n\n\nStringi pikkus ja sagedus\nKui pikad (st mitu tähte ja ühikut) on lahtri väärtused saab vaadata käsuga str_length().\n\n\n\n\n\n\nstr_length() käsu abil on mõnikord hea tuvastada whitespace olemasolu.\n\n\n\n\nstr_length(nimed)\n\n [1] 14  5 11  9 18  5 17 16 14 11\n\n\nstr_count() näitab ära esinemissageduse. Näiteks soovime vaadata, mitu korda esineb “Lars” nimedes?\n\nstr_count(nimed, \"Lars\")\n\n [1] 0 0 0 1 1 0 0 0 0 1\n\n\nR kuvab vastuse kõigi vektori väärtuste kohta (vajalik tekstianalüüsis).\nKui soovime vaadata aga, mitu korda esineb stringis ükskõik milline täht (nt täishäälik), tuleb otsitav osa kirjutada omakorda nurksulgude [] sisse.\n\nstr_count(nimed, \"[aeiouõäö]\")\n\n [1] 4 0 3 2 6 0 4 4 3 3\n\n\nKui kasutada str_count() tühjalt ehk ilma ühegi täpsustuseta sulgude sees, annab R vastuseks väärtuse tähemärkide arvu. See on sama, mis kasutada käsku str_lenght().\n\nstr_count(nimed)\n\n [1] 14  5 11  9 18  5 17 16 14 11\n\n\n\n\nStringi eraldamine\nstr_sub() käsuga eraldame string-i eest või tagant kindla pikkuse string-i. Näiteks võtame kõigi tegelaste nimelt esimesed viis tähemärki.\n\n\n\n\n\n\nAllpool on näited ka, kuidas kasutada baasversiooni käske substring() ja strsplit().\n\n\n\n\nstr_sub(nimed, 1, 5 )\n\n [1] \"Luke \" \"C-3PO\" \"Darth\" \"Owen \" \"Beru \" \"R5-D4\" \"Biggs\" \"Anaki\" \"Shmi \"\n[10] \"Clieg\"\n\n\nVõi täspsutame, et eraldamine algab (start=) alates string-i kolmandast tähemärgist ja eraldamine tuleb lõpetada (end=) kaheksanda märgi juures.\n\nstr_sub(nimed, start = 3, end=8)\n\n [1] \"ke Sky\" \"3PO\"    \"rth Va\" \"en Lar\" \"ru Whi\" \"-D4\"    \"ggs Da\" \"akin S\"\n [9] \"mi Sky\" \"iegg L\"\n\n\n\n\n\n\n\n\nString on string ka siis kui ta sisaldab numbrit ning str_ käsud toimivad ka siis kui tekst sisaldab ainult arve.\n\n\n\nVaatame, kas mõne tegelase nimi sisaldab ükskõik millist numbrit ja eraldame need numbrid nimest käsuga str_extract(). Sel korral tuleb “kuni” ütlemiseks öelda : asemel nagu tavaliselt kirjatekstis kasutame sidekriipsu (-).\n\nstr_extract(starwars$name, \"[0-9]\")\n\n [1] NA  \"3\" \"2\" NA  NA  NA  NA  \"5\" NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA \n[20] NA  NA  \"8\" NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA \n[39] NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA \n[58] NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  \"4\" NA  NA \n[77] NA  NA  NA  NA  NA  NA  NA  NA  NA  \"8\" NA \n\n\n\n\n\n\n\n\nstr_extract() käsu kasutamisel peab teadma, eraldatakse ainult esimene ja mitte kõik numbrid.\n\n\n\nMeil on näiteks selline tegelane andmestikus nagu “IG-88”.\nKui soov on aga teada, mitu korda esineb nimes number (või ükskõik milline otsitav tekst), tuleb kasutada ülalkirjeldatud käsku str_count()\n\nstr_count(starwars$name, \"[0-9]\")\n\n [1] 0 1 2 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n[39] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0\n[77] 0 0 0 0 0 0 0 0 0 1 0\n\n\nTavaliselt soovime neid sõnu ka näha. Selleks on käsk str_view_all().\n\nstr_view_all(nimed, \"[0-9]\")\n\n [1] │ Luke Skywalker\n [2] │ C-&lt;3&gt;PO\n [3] │ Darth Vader\n [4] │ Owen Lars\n [5] │ Beru Whitesun Lars\n [6] │ R&lt;5&gt;-D&lt;4&gt;\n [7] │ Biggs Darklighter\n [8] │ Anakin Skywalker\n [9] │ Shmi Skywalker\n[10] │ Cliegg Lars\n\n\nR-i baasversioonis on käsud substring() ja strsplit().\nNäiteks eemaldame tunnuse nimest esimesed viis täheühikut käsuga substring().\n\nsubstring(starwars$name, 5)\n\n [1] \" Skywalker\"        \"O\"                 \"2\"                \n [4] \"h Vader\"           \" Organa\"           \" Lars\"            \n [7] \" Whitesun Lars\"    \"4\"                 \"s Darklighter\"    \n[10] \"Wan Kenobi\"        \"in Skywalker\"      \"uff Tarkin\"       \n[13] \"bacca\"             \"Solo\"              \"do\"               \n[16] \"a Desilijic Tiure\" \"e Antilles\"        \"Tono Porkins\"     \n[19] \"\"                  \"atine\"             \" Fett\"            \n[22] \"8\"                 \"k\"                 \"o Calrissian\"     \n[25] \"t\"                 \"ar\"                \"Mothma\"           \n[28] \"l Crynyd\"          \"et Systri Warrick\" \" Nunb\"            \n[31] \"Gon Jinn\"          \" Gunray\"           \"s Valorum\"        \n[34] \"é Amidala\"         \"Jar Binks\"         \" Tarpals\"         \n[37] \"r Nass\"            \"Olié\"              \"o\"                \n[40] \"lba\"               \"sh Panaka\"         \" Skywalker\"       \n[43] \"h Maul\"            \"Fortuna\"           \" Secura\"          \n[46] \"s Tyerel\"          \"Bolt\"              \"ano\"              \n[49] \"Quadinaros\"        \" Windu\"            \"di-Mundi\"         \n[52] \"Fisto\"             \" Koth\"             \"Gallia\"           \n[55] \"ee Tiin\"           \"el Poof\"           \"Koon\"             \n[58] \"Amedda\"            \"ar Typho\"          \"é\"                \n[61] \"gg Lars\"           \"le the Lesser\"     \"nara Unduli\"      \n[64] \"iss Offee\"         \"é\"                 \"u\"                \n[67] \" Prestor Organa\"   \"o Fett\"            \"Wesell\"           \n[70] \"er Jettster\"       \" Su\"               \" We\"              \n[73] \"sta Nu\"            \"17\"                \"Tambor\"           \n[76] \"Hill\"              \"k Ti\"              \"vous\"             \n[79] \"ful\"               \"us Antilles\"       \"Moore\"            \n[82] \" Medon\"            \"\"                  \"\"                 \n[85] \"Dameron\"           \"\"                  \"ain Phasma\"       \n\n\nstrsplit() saab panna teksti eemaldama ka pärast konkreetset sõnaosa esinemist. Näiteks poolitab teksti pärast “a” tähe esinemist.\n\n#strsplit(starwars$name, \"a\")\n\n\n\n4.2.1 Stringi ühendamine\nBaasversiooni käsk paste().\n\n\n\n\nWickham, Hadley. 2022. Stringr: Simple, Consistent Wrappers for Common String Operations. https://CRAN.R-project.org/package=stringr.\n\n\n———. 2023. Forcats: Tools for Working with Categorical Variables (Factors). https://CRAN.R-project.org/package=forcats.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Töö teksti sisaldavate tunnustega</span>"
    ]
  },
  {
    "objectID": "04-faktor-string.html#footnotes",
    "href": "04-faktor-string.html#footnotes",
    "title": "4  Töö teksti sisaldavate tunnustega",
    "section": "",
    "text": "whitespace on see, mida me “tavavaates” ei nähe ehk tühikud, tab jms.↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Töö teksti sisaldavate tunnustega</span>"
    ]
  },
  {
    "objectID": "05-puuduvad-vaartused.html",
    "href": "05-puuduvad-vaartused.html",
    "title": "5  Puuduvad väärtused",
    "section": "",
    "text": "5.1 Miks vaadata puuduvad väärtusi?\nPuuduvaid väärtusi on vaja vaadata eraldi, et teha selgeks, miks puuduv väärtus on puuduv. Võib-olla tahad puuduvat väärtus asendada mõne muu kategooriaga. Nt “teadmata”, “keeldub vastamast”, “ei ole võimalik vastata”, sest puudub osalus jne. Või siis on soov vastupidi keerata mingid kategooriad NA-ks, sest arvutamisel pole vahet, kas “keeldus vastamast” või “ei osanud vastata”.\nPuuduvaid väärtuseid tahame teada, et olla kindel kas puuduvad väärtused on puuduvad juhuslikult või mingi kindla mustri järgi. Mustrit ei näe sellest tunnusest, kus on puuduvad väärtused vaid mõne muu tunnuse pealt. Andmeid saab analüüsida küll, aga neid raporteerides peab ära märkima, miks on puuduvad väärtused ja mis mustriga.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Puuduvad väärtused</span>"
    ]
  },
  {
    "objectID": "05-puuduvad-vaartused.html#mida-puuduvad",
    "href": "05-puuduvad-vaartused.html#mida-puuduvad",
    "title": "5  Puuduvad väärtused",
    "section": "5.2 Mida teha puuduvate väärtustega?",
    "text": "5.2 Mida teha puuduvate väärtustega?\nPuuduvate väärtustega toimetulek võib tähendada viite lähenemist.\n\nKustutada kõik read, kus on puuduvad väärtused (äärmuslik).\nKustutada need read, kus on puuduv väärtus kindlas tunnuses.\nMuuta puuduva väärtus mingiks kindlaks väärtuseks (nt “teadmata”).\nVastupidi, muuta kindel väärtus hoopis NA ks (näiteks 0, \"-\" või \" \").\nMuuta puuduv väärtus mingiks “best-guess” väärtuseks (nt keskmine). Vaata tunnuste sisu muutmist siit.\n\n\nlibrary(tidyverse)\n\n\ndata(starwars)\n\n\nPuuduvate väärtuste leidmine\nKasutan näiteks uuesti starwars andmestikku, aga jätan sealt välja need tunnused, mis sisaldavad liste.\n\nstarwars&lt;-starwars|&gt;\n1  select(name:species)\n\n2nrow(starwars)\n\n\n1\n\nvalin tunnused, et eemaldada testandmestikust “list” tüüpi tunnused\n\n2\n\nTuletan meelde, kui palju on andmestikus ridu.\n\n\n\n\n[1] 87\n\n\nSeejärel vaatan andmestiku päist.\n\nstarwars|&gt;\n  head()\n\n# A tibble: 6 × 11\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…\n2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…\n3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…\n4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…\n5 Leia Org…    150    49 brown      light      brown           19   fema… femin…\n6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…\n# ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;\n\n\nNäeme, et meie andmestik sisaldab puuduvaid väärtusi. Üks võimalus puuduvatest väärtustest vabanemiseks on kasutada käsku na.omit()\n\nstarwars|&gt;\n  na.omit()\n\n# A tibble: 29 × 11\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 3 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 4 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 5 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 6 Biggs D…    183    84 black      light      brown           24   male  mascu…\n 7 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n 8 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…\n 9 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…\n10 Han Solo    180    80 brown      fair       brown           29   male  mascu…\n# ℹ 19 more rows\n# ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;\n\n\n\n\n\n\n\n\nKäsu na.omit() kasutamine on õigustatud ainult siis, kui tead täpselt, kus on puuduvad väärtused, miks nad on puuduvad ja kui palju neid on.\n\n\n\nMeid aga huvitab, kus kohas need puuduvad väärtused ja tahame nad välja filtreerida. Abiks on käsk complete.cases(.). Puuduvate väärtuste tuvastamiseks on mõistlikum pöörata käsk tagurpidi ja küsida välja read, mis sisaldavad puuduvaid väärtusi ehk !complete.cases(.)\n\nstarwars|&gt;\n  filter(!complete.cases(starwars))\n\n# A tibble: 58 × 11\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 C-3PO       167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…\n 2 R2-D2        96    32 &lt;NA&gt;       white, bl… red               33 none  mascu…\n 3 R5-D4        97    32 &lt;NA&gt;       white, red red               NA none  mascu…\n 4 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…\n 5 Greedo      173    74 &lt;NA&gt;       green      black             44 male  mascu…\n 6 Jabba D…    175  1358 &lt;NA&gt;       green-tan… orange           600 herm… mascu…\n 7 Jek Ton…    180   110 brown      fair       blue              NA &lt;NA&gt;  &lt;NA&gt;  \n 8 Yoda         66    17 white      green      brown            896 male  mascu…\n 9 IG-88       200   140 none       metal      red               15 none  mascu…\n10 Mon Mot…    150    NA auburn     fair       blue              48 fema… femin…\n# ℹ 48 more rows\n# ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;\n\n\nNäiteks näeme, et puuduvad väärtused on ridamisi hair_color tunnuse all.\n\n\nPuuduvate väärtuste vaatamine\nSoovime puuduvad väärtused välja filtreerida, et vaadata neid tegelasi lähemalt, kellel on juuksevärvi info puudu. Käsk is.na() annab TRUE/FALSE vastuse ning on sedasorti filteerimiseks ideaalne.\n\nstarwars|&gt;\n1  filter(is.na(hair_color))|&gt;\n  select(name, species, hair_color)\n\n\n1\n\nNäita neid ridu, kus tunnuse väärtus on puudu\n\n\n\n\n# A tibble: 5 × 3\n  name                  species hair_color\n  &lt;chr&gt;                 &lt;chr&gt;   &lt;chr&gt;     \n1 C-3PO                 Droid   &lt;NA&gt;      \n2 R2-D2                 Droid   &lt;NA&gt;      \n3 R5-D4                 Droid   &lt;NA&gt;      \n4 Greedo                Rodian  &lt;NA&gt;      \n5 Jabba Desilijic Tiure Hutt    &lt;NA&gt;      \n\n\n\n\nPuuduvate väärtuste ringikodeerimine\nNüüd selgub, et kõik need, kellel on juuksevärv puudu on tegelased, kellel polegi juukseid. Saame need tegelased alles jätta ja ringi kodeerida.\n\nstarwars$hair_color&lt;-replace_na(starwars$hair_color, \"none\")\n\n\nstarwars|&gt;\n  select(hair_color)|&gt;\n  table()\n\nhair_color\n       auburn  auburn, grey auburn, white         black         blond \n            1             1             1            13             3 \n       blonde         brown   brown, grey          grey          none \n            1            18             1             1            43 \n        white \n            4 \n\n\n\n\nVäärtuste märkimine puuduvaks\nNüüd soovin, et hair_color tunnuse grupp “none” oleks andmesitkus NA.\n\n\n\n\n\n\nMõtle hoolega läbi, kas tahad muuta tunnust või mitte. “Pole juukseid” ehk “none” on igal juhul selge info selle kohta, miks juuksevärvi pole andmetes kirjas. NA peaks tähendama ikka seda, et info juuste olemasolu ja värvi kohta täielikult info puudub.\n\n\n\nKasutada saab käsku na_if().\n\nstarwars$hair_color&lt;-na_if(starwars$hair_color, \"none\")\n\n\n\nPuuduvate väärtuste kõrvale jätmine\nNäiteks tahame teha graafikut, kuidas jaguneb tunnus “hair_color”.\n\n\n\n\n\n\nAndmete visuaalse esitamise kohta tuleb eraldi peatükk, mis tutvustab põhjalikumalt paketti ggplot2 (Wickham 2016) kasutamist (mis on ka osa tidyverse pakettidest). Need joonised ei ole “head” joonised. Praegu õpime käsu drop_na() kasutamist.\n\n\n\nVaikimisi paneb R ka puuduvad väärtused pildile.\n\nstarwars|&gt;\n  ggplot(aes(x=gender, fill=hair_color))+\n  geom_bar()\n\n\n\n\n\n\n\n\nKäsuga drop_na()- saab öelda, mis tunnuse NA väärtused järgmistest sammudest kõrvale jätta ilma, et peaks andmestikust ridu eemaldama hakkama.\n\nstarwars|&gt;\n1  drop_na(hair_color, gender)|&gt;\n  ggplot(aes(gender, fill=hair_color))+\n  geom_bar()\n\n\n1\n\nEemaldab tühjad väärtused tunnusest, et neid pildil mitte kuvada.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWickham, Hadley. 2016. Ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Puuduvad väärtused</span>"
    ]
  },
  {
    "objectID": "06-andmestike-liitmine.html",
    "href": "06-andmestike-liitmine.html",
    "title": "6  Andmestike ühendamine ja struktuuri muutmine",
    "section": "",
    "text": "6.1 Eeltööd\nVaata ka peatükke, kuidas saada andmestikust esmane ülevaade ning kuidas valida tunnuseid.\nKasutame käske dplyr (Wickham et al. 2023) paketist, mis on juba tidyverse sees.\nNäidiseks teeme starwars andmesitku tükkideks, et see siis teisiti kokku liita.\nAndmestike liitmise harjutamiseks teeme kolm erinevat andmestikku:\nKõigi andmestike sees on tunnus nimi (name).\ninimesed&lt;-starwars|&gt;\n  filter(species==\"Human\")|&gt;\n  select(name, homeworld)\ndroidid&lt;-starwars|&gt;\n  filter(species==\"Droid\")|&gt;\n  select(name, homeworld, gender)\ntegelaste_mass&lt;-starwars|&gt;\n  select(name, mass)\ndim(inimesed)\n\n[1] 35  2\n\ndim(droidid)\n\n[1] 6 3\n\ndim(tegelaste_mass)\n\n[1] 87  2\nNäeme, et kõik on erienva suurusega.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Andmestike ühendamine ja struktuuri muutmine</span>"
    ]
  },
  {
    "objectID": "06-andmestike-liitmine.html#eeltööd",
    "href": "06-andmestike-liitmine.html#eeltööd",
    "title": "6  Andmestike ühendamine ja struktuuri muutmine",
    "section": "",
    "text": "Päriselus me kunagi sellist jaburat tükeldamist ei teeks, et uuesti kokku liita see, mis kõik kenasti koos.\n\n\n\n\n\ninimesed - sisaldab nime ja kodumaailma\ndroidid - sisaldab nime, kodumaailma ja sugu\ntegelaste_mass - sisaldab nime ja mass\n\n\n\n\n\n\n\n\n\n\n\nHea praktika oleks enne andmestike liitmist üle vaadata nende suurus.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Andmestike ühendamine ja struktuuri muutmine</span>"
    ]
  },
  {
    "objectID": "06-andmestike-liitmine.html#full-join",
    "href": "06-andmestike-liitmine.html#full-join",
    "title": "6  Andmestike ühendamine ja struktuuri muutmine",
    "section": "6.2 Andmestike täielik liitmine",
    "text": "6.2 Andmestike täielik liitmine\nPaneme kokku andmestikud “inimesed” ja “drodid”. Teeme neist ühe andmestiku ja meid ei sega, et droidide kohta on meil üks tulp rohkem (gender) kui inimeste kohta.\nKasutame käsku full_join() ning õige liitmise korral peaks olema alles kõik andmed:\n\nkokku \\(35+6=41\\) rida ja\n3 tulpa (name, homeworld, gender).\n\n\ninimesed_droidid&lt;-full_join(inimesed, droidid)\n\nJoining with `by = join_by(name, homeworld)`\n\nnrow(inimesed_droidid)\n\n[1] 41\n\n\nVaatame kontrolliks päist.\n\nhead(inimesed_droidid)\n\n# A tibble: 6 × 3\n  name               homeworld gender\n  &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt; \n1 Luke Skywalker     Tatooine  &lt;NA&gt;  \n2 Darth Vader        Tatooine  &lt;NA&gt;  \n3 Leia Organa        Alderaan  &lt;NA&gt;  \n4 Owen Lars          Tatooine  &lt;NA&gt;  \n5 Beru Whitesun Lars Tatooine  &lt;NA&gt;  \n6 Biggs Darklighter  Tatooine  &lt;NA&gt;  \n\n\nNäeme, et R liitis mõlemad andmestikud kokku ja algselt “inimesed” andmestikus puudunud “gender” väli on nüüd olemas, kuid väärtused on tühjad (NA). (Teame, et meil on olemas inimeste gender tunnuse info andmestikus starwars ja liidame need hiljem juurde).\n\nRidada või tulpade lisamine andmestikku\nKui ühe andmestiku read on vaja lisada olemaoleva andmestiku lõppu, siis saab kasutada käsku bind_rows().\n\n\n\n\n\n\nSelline olukord võib tekkida siis, kui olemas näiteks teatud perioodi andmestik. Kuu või aasta lõppedes on vaja lisada äsjalõppenud periood eelmise andmestiku otsa.\n\n\n\nKui sa tead, et kattuvad kõikide ridada andmeväljade nimed, tunnuste tüübid siis kasuta käsku nii.\n\n#bind_rows(vana_andmestik, liidetav_andmestik)\n\nLiidetava andmestiku read lähevad “vana andmestiku” lõppu.\n\n\n\n\n\n\nSarnaselt toimib ka käsk bind_cols(), kuid jäta meelde, et liidevata andmestiku read tõstetakse üle täpselt nende esinemisjärjekorras. Kasulikum võib olla full_join() käsu kasutamine.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Andmestike ühendamine ja struktuuri muutmine</span>"
    ]
  },
  {
    "objectID": "06-andmestike-liitmine.html#left-join",
    "href": "06-andmestike-liitmine.html#left-join",
    "title": "6  Andmestike ühendamine ja struktuuri muutmine",
    "section": "6.3 Andmestike osaline liitmine",
    "text": "6.3 Andmestike osaline liitmine\nLiidame “inimesed_droidid” andmestikule juurde nende kaalu (“mass”) andmestikust “tegelaste mass”. Me teame, et “tegelaste mass” sisaldab rohkem tegelasi (st ridu), kui “inimesed_droidid” ning me ei taha, et kõik 87 tegelast “inimesed_droidid” andmestikku üle (st juurde) tuleks. Selleks kasutame käsku left_join() ja esimesena nimetame selle andmestiku, millele tunnuseid juurde liidame. Saame valida, kas teeme uue andmestiku või kirjutame olemasoleva üle.\n\n\n\n\n\n\nKui sa ei ole enda oskustes kindel, ära kohe olemasolevat andmestiku liitmisega üle kirjuta.\n\n\n\n\ninimesed_droidid&lt;-left_join(inimesed_droidid, tegelaste_mass)\n\nJoining with `by = join_by(name)`\n\n\nVaikimisi otsib R ise üles, mis võiks olla see tunnus, mis esineb mõlemas andmestikus. Vajaduse korral võib seda teha ka left_join() käsu sees täpsustusega by=.\nKontrollime üle, et ühtegi liigset rida ega tulpa andmestikku tekkinud.\n\ndim(inimesed_droidid)\n\n[1] 41  4\n\n\nVaatame ka päise üle.\n\nhead(inimesed_droidid)\n\n# A tibble: 6 × 4\n  name               homeworld gender  mass\n  &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;\n1 Luke Skywalker     Tatooine  &lt;NA&gt;      77\n2 Darth Vader        Tatooine  &lt;NA&gt;     136\n3 Leia Organa        Alderaan  &lt;NA&gt;      49\n4 Owen Lars          Tatooine  &lt;NA&gt;     120\n5 Beru Whitesun Lars Tatooine  &lt;NA&gt;      75\n6 Biggs Darklighter  Tatooine  &lt;NA&gt;      84\n\n\nMeid häirib, et meil on olemas info inimeste “gender” tunnuse kohta andmestikus “starwars” aga mitte meie “inimesed_droidid” andmestikus. Võtame starwars andmest välja liitmiseks vajamineva osa.\n\ninimesed_gender&lt;-starwars|&gt;\n  filter(species==\"Human\")|&gt;\n  select(name, gender)\n\nKordan left_join() käsku ja seekord kasutan näites täpsustust by= (kuigi praegu saaks R vaikimisi ka ise aru, mille järgi liita).\n\ninimesed_droidid&lt;-left_join(inimesed_droidid, inimesed_gender,\n1                            by=\"name\")\nhead(inimesed_droidid)\n\n\n1\n\nTäpsutab, millise tunnuse kaudu liita. liidetavaid tunnuseid võib anda mitu ka vektorina. Näiteks by=c(“linn”, “tänav”)\n\n\n\n\n# A tibble: 6 × 5\n  name               homeworld gender.x  mass gender.y \n  &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;    \n1 Luke Skywalker     Tatooine  &lt;NA&gt;        77 masculine\n2 Darth Vader        Tatooine  &lt;NA&gt;       136 masculine\n3 Leia Organa        Alderaan  &lt;NA&gt;        49 feminine \n4 Owen Lars          Tatooine  &lt;NA&gt;       120 masculine\n5 Beru Whitesun Lars Tatooine  &lt;NA&gt;        75 feminine \n6 Biggs Darklighter  Tatooine  &lt;NA&gt;        84 masculine\n\n\nNüüd juhtus nii, et tekkis kaks “gender” tunnust, sest mõlemad andmesitud sisaldasid tunnust “gender”.\n\n\n\n\n\n\nTunnuse nimes “x” näitab, mis oli algses andmestikus tunnus ja “y” liidetavas.\n\n\n\nTunnuse väärituste sisuline ühendamine käib käskuda mutate() ja coalesce() abil. Kasutame seda nii, et kaotame ära üleliigseks muutunud tunnused “gender.x”, “gender.y”.\n\ninimesed_droidid&lt;-inimesed_droidid|&gt;\n1  mutate(gender=coalesce(gender.x, gender.y))|&gt;\n2  select(-gender.x, -gender.y)\n\n\n1\n\nMuunda tunnust gender ja koonda tema alla tunnused gender.x ja gender.y väärtused\n\n2\n\nKustuta (üleliigseks muutunud) tunnused\n\n\n\n\n\nhead(inimesed_droidid)\n\n# A tibble: 6 × 4\n  name               homeworld  mass gender   \n  &lt;chr&gt;              &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;    \n1 Luke Skywalker     Tatooine     77 masculine\n2 Darth Vader        Tatooine    136 masculine\n3 Leia Organa        Alderaan     49 feminine \n4 Owen Lars          Tatooine    120 masculine\n5 Beru Whitesun Lars Tatooine     75 feminine \n6 Biggs Darklighter  Tatooine     84 masculine\n\n\n\n\n\n\n\n\nAlati kontrolli üle ka andmestiku mõõtmed.\n\n\n\n\ndim(inimesed_droidid)\n\n[1] 41  4\n\n\nEemaldame üleliigsed andmestikud käsuga rm().\n\nrm(droidid, inimesed, inimesed_gender, tegelaste_mass, inimesed_droidid)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Andmestike ühendamine ja struktuuri muutmine</span>"
    ]
  },
  {
    "objectID": "06-andmestike-liitmine.html#andmestiku-struktuuri-muutmine",
    "href": "06-andmestike-liitmine.html#andmestiku-struktuuri-muutmine",
    "title": "6  Andmestike ühendamine ja struktuuri muutmine",
    "section": "6.4 Andmestiku struktuuri muutmine",
    "text": "6.4 Andmestiku struktuuri muutmine\nStruktuuri muutmisega puutub kokku siis, kui esitame kokkuvõtteid mingi sagedustabeli või risttabeli kujul.\nSeepärast räägin praegu group_by() ja summarise() käskude kasutamisest lühidalt. Käsu nimedest on aru saada, et andmestik grupeeritakse ringi ja summarise käsuga arvutatakse kokku kui palju ridu esineb sellises grupeeringus (n()).\n\nstarwars|&gt;\n  group_by(gender, species)|&gt;\n  summarise(n=n())\n\n`summarise()` has grouped output by 'gender'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 42 × 3\n# Groups:   gender [3]\n   gender    species        n\n   &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt;\n 1 feminine  Clawdite       1\n 2 feminine  Droid          1\n 3 feminine  Human          9\n 4 feminine  Kaminoan       1\n 5 feminine  Mirialan       2\n 6 feminine  Tholothian     1\n 7 feminine  Togruta        1\n 8 feminine  Twi'lek        1\n 9 masculine Aleena         1\n10 masculine Besalisk       1\n# ℹ 32 more rows\n\n\nVaikimisi esitatakse tähestiku (või faktori leveli) järjekorras (loe faktorite kohta siit).\nMuudame andmestiku laia formaati nii, et uue andmestiku tulpade nimed tulevad tunnusest “gender”. Ridadeks jäävad liigid. Tunnuste väärtuseks jääb arv, mis ütles mitu tegelast seda “gender” ja “species” esindas.\nSelleks lisan olesmolevale koodile juurde pivot_wider() ning täpsustused names_from= ja values_from=.\n\nstarwars|&gt;\n  group_by(gender, species)|&gt;\n  summarise(n=n())|&gt;\n1  pivot_wider(names_from = gender,\n2              values_from = n)\n\n\n1\n\nPööra andmestik nii, et uued nimed tulevad tunnusest “gender” ning\n\n2\n\nuued väärtused tulevad tunnusest n (mis loodi eelmises sammus)\n\n\n\n\n`summarise()` has grouped output by 'gender'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 38 × 4\n   species    feminine masculine  `NA`\n   &lt;chr&gt;         &lt;int&gt;     &lt;int&gt; &lt;int&gt;\n 1 Clawdite          1        NA    NA\n 2 Droid             1         5    NA\n 3 Human             9        26    NA\n 4 Kaminoan          1         1    NA\n 5 Mirialan          2        NA    NA\n 6 Tholothian        1        NA    NA\n 7 Togruta           1        NA    NA\n 8 Twi'lek           1         1    NA\n 9 Aleena           NA         1    NA\n10 Besalisk         NA         1    NA\n# ℹ 28 more rows",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Andmestike ühendamine ja struktuuri muutmine</span>"
    ]
  },
  {
    "objectID": "06-andmestike-liitmine.html#andmestikust-väljavõttete-tegemine",
    "href": "06-andmestike-liitmine.html#andmestikust-väljavõttete-tegemine",
    "title": "6  Andmestike ühendamine ja struktuuri muutmine",
    "section": "6.5 Andmestikust väljavõttete tegemine",
    "text": "6.5 Andmestikust väljavõttete tegemine\nLisaks filter() ja select() käskudele võib tekkida olukord, kus soov on vaja võtta mingi tükk andmestikust, kas juhuslikult või mingist kindlast kohast (aga pole ühtegi tunnust, mille alusel see täpselt välja filtreerida).\nKäsuga slice() saab öelda, millised ridu andmestikust eraldada on vaja. Näiteks võtame read 30 kuni 40.\n\nslice(starwars, 30:40)\n\n# A tibble: 11 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 Nien Nu…    160    68 none       grey       black             NA male  mascu…\n 2 Qui-Gon…    193    89 brown      fair       blue              92 male  mascu…\n 3 Nute Gu…    191    90 none       mottled g… red               NA male  mascu…\n 4 Finis V…    170    NA blond      fair       blue              91 male  mascu…\n 5 Padmé A…    185    45 brown      light      brown             46 fema… femin…\n 6 Jar Jar…    196    66 none       orange     orange            52 male  mascu…\n 7 Roos Ta…    224    82 none       grey       orange            NA male  mascu…\n 8 Rugor N…    206    NA none       green      orange            NA male  mascu…\n 9 Ric Olié    183    NA brown      fair       blue              NA male  mascu…\n10 Watto       137    NA black      blue, grey yellow            NA male  mascu…\n11 Sebulba     112    40 none       grey, red  orange            NA male  mascu…\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n\nKäsuga sample_n() saab suvalised read.\n\n\n\n\n\n\nSelline olukord võib tulla ette masinõppes, kus on vaja tekitada test ja treeningandmestik. Masinõppe kohta tuleb eraldi peatükk.\n\n\n\n\nsample_n(starwars, 5)\n\n# A tibble: 5 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n1 Ackbar       180    83 none       brown mot… orange          41   male  mascu…\n2 Shmi Sky…    163    NA black      fair       brown           72   fema… femin…\n3 Barriss …    166    50 black      yellow     blue            40   fema… femin…\n4 Anakin S…    188    84 blond      fair       blue            41.9 male  mascu…\n5 Sly Moore    178    48 none       pale       white           NA   &lt;NA&gt;  &lt;NA&gt;  \n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Andmestike ühendamine ja struktuuri muutmine</span>"
    ]
  },
  {
    "objectID": "06-andmestike-liitmine.html#andmestiku-ridade-ümberreastamine",
    "href": "06-andmestike-liitmine.html#andmestiku-ridade-ümberreastamine",
    "title": "6  Andmestike ühendamine ja struktuuri muutmine",
    "section": "6.6 Andmestiku ridade ümberreastamine",
    "text": "6.6 Andmestiku ridade ümberreastamine\nKäsuga arrange() on võimalik read ümber sorteerida nagu vaja on. Vaikimisi töötab käsk nii, et reastab tähestiku järjekorras või väiksemast suuremani.\nVõib kasutada käsku desc() või lihtsalt miinusmärki tunnuse ees ja nii reastatakse tunnuse väärtused suuremast väiksemani.\n\n\n\n\n\n\nMiinusmärk tunnuse nime ees ei tähenda iga kord seda, et tunnus reastatakse teistpidi. Näiteks select() käsu puhul jäetakse miinus märgi kasutamisel see tunnus valimata.\n\n\n\n\nstarwars|&gt;\n  group_by(gender)|&gt;\n  summarise(n=n())|&gt;\n1  arrange(-n)\n\n\n1\n\nReasta tunnused n tulba väärtuste järgi suuremast väiksemani\n\n\n\n\n# A tibble: 3 × 2\n  gender        n\n  &lt;chr&gt;     &lt;int&gt;\n1 masculine    66\n2 feminine     17\n3 &lt;NA&gt;          4\n\n\n\n\n\n\nWickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. Dplyr: A Grammar of Data Manipulation. https://CRAN.R-project.org/package=dplyr.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Andmestike ühendamine ja struktuuri muutmine</span>"
    ]
  },
  {
    "objectID": "07-joonised.html",
    "href": "07-joonised.html",
    "title": "7  Joonised - lühiülevaade",
    "section": "",
    "text": "7.1 Baaskäskude abil jooniste tegemine\nSee peatükk annab lühikese ülevaate, kuidas teha R-is jooniseid paketiga ggplot2(Wickham et al. 2023). ggplot2 on osa tidyverse maailmast ning seda paketti eraldi alla laadima ja käivitama ei pea.\nSoovitan Winston Changi raamat “R Graphics Cookbook” salvestada oma veebilehitseja järjehoidjasse. Raamat on täis praktilisi näpunäited, kuidas oma joonist paremaks timmida. Wilke raamat “Fundamentals of Data Visualization” selgitab juurde ka teooriat, kuidas andmetega lugu ilusamini ja selgemalt jutustada. Soovitan lisaks laadida alla paketi ggplot2 cheat-sheet ja hoida seda käepärast. Õige joonise tegemine algab kasutusel olevatest tunnustest ning cheat-sheet aitab graafika-grammatikas kiiresti õiges suunas liikuda.\nMinu jaoks jagunevad joonised oma olemuselt kaheks. Ühed on need, mida ise vaatad ja teised on need, mida esitled teistele andmete ilmestamiseks. Esimestega ei pea disaini mõttes üldse vaeva nägema, teisi võib tundideks või isegi päevadeks kaunistama jäädagi.\nBaasversiooniga saab joonised kiiremini kätte (st kulub vähem aega koodi kirjutamisele). Samas andmed alluvad töötlemisele paremini paketti ggplot2 kasutades ja seepärast on kasulik õppida kohe jooniste tegemist käsuga ggplot().\nKasutan taas starwars andmestikku, mis tuleb paketiga tidyverse kaasa.\nToimivad käsud:\nNeid baaskäske saab omakorda täiendada. Loe täpsemalt nende käskude kohta dokumentatsioonist.\n#näiteks loe barplot kohta\n?barplot()",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Joonised - lühiülevaade</span>"
    ]
  },
  {
    "objectID": "07-joonised.html#baaskäskude-abil-jooniste-tegemine",
    "href": "07-joonised.html#baaskäskude-abil-jooniste-tegemine",
    "title": "7  Joonised - lühiülevaade",
    "section": "",
    "text": "plot()\nJoondiagrammi saamiseks lisa plot() sisse täpsustus type=\"l\"\nKarpdiagrammi jaoks on käsk boxplot()\nTulpdiagrammi saab teha käsuga barplot()\nHistogrammi tegemiseks on käsk hist()",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Joonised - lühiülevaade</span>"
    ]
  },
  {
    "objectID": "07-joonised.html#ggplot-loogika",
    "href": "07-joonised.html#ggplot-loogika",
    "title": "7  Joonised - lühiülevaade",
    "section": "7.2 ggplot() töö loogika",
    "text": "7.2 ggplot() töö loogika\n\n\n\n\n\n\nEsmalt kirjeldan töö loogikat ja seejärel kordan tööloogika kirjeldust luues näidispilti samm-sammult.\n\n\n\nKäsk ggplot() joonistab graafika kihtidena ning esimesed kaks kihti peavad olema kindlas järjekorras. Iga uue kihi lisamine käib + märgiga.\n\nTööala kaardistus ehk esimene samm peab olema andmestiku ja tunnuste määratlemine. See on etapp, mille käigus valid graafikule teljed.\nSeejärel tuleb täpsustada geomeetria ehk öelda, mis tüüpi joonist (nt histogramm või joondiagramm) luua soovid. Geomeetria kui kujund, mida pildile panna. Geomeetrilise kihi lisamine algab sõnaga geom_ ning järgneb joonise tüübi nimi. Näiteks geom_barblot().\nOluline mõiste jooniste loomisel on esteetika (värv, suurus jms) mida suunab käsk aes(). Selle käsuga täpsustad, mil viisil soovid kasutatava tunnust joonisel esitleda. aes() käsk tuleb kasutusele juba esimesel real, kuid vajadusel saab lisada täpsustusi sama käsuga ka järgmistel jooniste kihtidel.\nSeejärel tasub joonisele lisada juba viidad, et teised ka aru saaks, mida joonisel kujutatud on. Viitade all pean ma silmas pealkirju, legende, paremaid telgede nimesid jms.\nSiit edasi on kõik juba tuled ja viled. Muuta saab teksti fonti, värvi, suurust, legendi asukohta, kategooriate nimesid, tausta värve jne. Neid ei ole mõtet siin kõike ära kirjeldada, sest R Graphics Cookbook (Chang 2024) annab iga etapi kohta konkreetseid näited.\n\nJäta meelde, et käsuga ggplot() alustad joonise loomist ning iga järgmise kihi lisamine käib + märgiga. Miinimum joonis ggplot-iga on vähemalt kahe kihiline, sest ilma geom_ täpsustuseta andmeid välja ei kuvada ei saa. Tunnuste määratlemine käib alati aes() käsu sees.\n\n\n\n\n\n\nKäsk ggplot() tahab alati esimese täpsustusena teada, mis andmestikuga on tegemist. Seda võib kirjutada täpsustusena data= aga võib ka kirjutada lihtsalt andmestiku nime.\n\n\n\n\nggplot() töö-loogika samm-sammult\nKordan sama, mis alapeatüki esimestes punktides räägitud, aga nüüd koos piltidega.\nEsmalt toimub käsuga ggplot() tööala kaardistus. Öelda tuleb andmestiku nimi ja tunnus käsu aes() sees.\n\n1ggplot(starwars, aes(height))\n\n\n1\n\nLoon joonise põhi kasutades starwars andmestikku ja x teljele pane tunnuse “height”.\n\n\n\n\n\n\n\n\n\n\n\nTekib justkui tühi pilt, kuna R-ile pole veel öeldud, millise kujundiga andmeid esitleda. Praegu on joonisel x-telg, mille skaala on loodud starwars andmestiku tunnuse height järgi.\n\n\n\n\n\n\nVaikimisi paneb ggplot() käsu sees aes() käsk esimesena kirjutatud tunnuse nime x-teljele. x ja y telge saab täpsustada x= või y= ja siis ei ole oluline, mis järjekorras need anda.\n\n\n\nLisame geomeetrika ja kasutame näiteks karpdiagrammi ehk boxplot geomeetrikat.\n\n1ggplot(starwars, aes(height))+\n2  geom_boxplot()\n\n\n1\n\nVõta andmestik starwars ja kasuta joonisel x teljel tunnust height\n\n2\n\nLisa karpdiagrammi kujund\n\n\n\n\n\n\n\n\n\n\n\nR teeb joonise valmis ja annab ka teada, et eemaldas joonist tehes kuus rida.\n\n\n\n\n\n\nPane tähele, et puuduvad väärtused ei kao jooniseid tehes vaikselt ära. Vaata siit, kuidas puuduvate väärtustega toime tulla.\nHarjuta lugema end teateid, mida R kuvab.\n\n\n\nKordame sama tunnusega joonise tegemist, aga vahetame ära geom_-i.\n\nggplot(starwars, aes(height))+\n  geom_histogram()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\nWarning: Removed 6 rows containing non-finite outside the scale range\n(`stat_bin()`).\n\n\n\n\n\n\n\n\n\nJoonisel ei pea olema ainult üks tunnus, mis on seotud käsuga aes().\nNäiteks saab lisada aes() käsu geomeetrika sisse.\n\nggplot(starwars, aes(height))+\n1  geom_boxplot(aes(colour = gender))\n\n\n1\n\nJoonista kujundid nii, et tunnuse “gender” kategooriad on kõik erineva värviga.\n\n\n\n\n\n\n\n\n\n\n\nPane tähele, et lisaks “height” puuduvatele väärtustele (neid on 6) on ka tunnusel “gender” puuduvaid väärtusi. Karpdiagramm oma olemuselt ei anna teada grupi suurusest aimu (ehk kui palju on neid, kelle gender väli on tühi). Puuduvad väärtused hakkavadki joonistel teinekord paremini silma. Seepärast sobib selline üpris inetu välimusega joonis ideaalselt “enesele vaatamiseks” tunnustega tutvumise faasis.\nIsegi kui seda joonist teistele esitlema ei lähe, tasuks teha mõni märge (st viide) pildil nähtu kohta. Kasvõi iseendale, et oleks meeles mida nägid. Käsu labs() sees saab lisada pealkirju ja kirjutada üle olemasolevaid välju.\n\nggplot(starwars, aes(height))+\n  geom_boxplot(aes(colour = gender))+\n1  labs(title =\"Naised on keskmiselt lühemad\",\n2       subtitle = \"Aga olemas on ka lühikesi mehi\",\n3       x=\"Pikkus sentimeetrites\",\n4       color=\"Sugu\")\n\n\n1\n\nLisa joonisele pealkiri\n\n2\n\nLisa joonisele alapealkiri\n\n3\n\nKirjuta x-telje viide üle tekstiga “pikkus sentimeetrites”\n\n4\n\nKirjuta legendi pealkiri üle tekstiga “Sugu”\n\n\n\n\n\n\n\n\n\n\n\nSelline võiks välja näha üks tööjoonis paketiga ggplot2. Baasversiooniga saab teha karpdiagrammi käsuga boxplot(). Väljund on mõnes mõttes küll kiire ja puhas, aga puuduvad väärtusi baasversiooni joonis sulle otse näkku ei kuva.\n\nboxplot(starwars$height ~ starwars$gender)\n\n\n\n\n\n\n\n\n\n\nJooniste R-ist välja salvestamine\nKäsk ggsave() võtab aluseks viimase ggplot() käsuga tehtud joonise ning salvestab selle vaikimisi sinu töökausta. Vajadusel saab ette öelda laiuse (width=), pikkuse (height=) ning nende mõõtühiku (units=) ning resolutsiooni (dpi=). Faililaiend võib olla .pdf, .png, .jpeg, .svg, .tiff jms.\n\nggsave(\"minu_boxplot.png\",\n       width = 5,\n       height = 4,\n       units = \"cm\",\n       dpi=200)\n\nWarning: Removed 6 rows containing non-finite outside the scale range\n(`stat_boxplot()`).",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Joonised - lühiülevaade</span>"
    ]
  },
  {
    "objectID": "07-joonised.html#andmete-puhastamine-joonise-jaoks",
    "href": "07-joonised.html#andmete-puhastamine-joonise-jaoks",
    "title": "7  Joonised - lühiülevaade",
    "section": "7.3 Andmete puhastamine joonise jaoks",
    "text": "7.3 Andmete puhastamine joonise jaoks\nKui puuduvate väärtuste esitlemine joonisel pole parasjagu oluline, saab need enne ggplot() käsu kasutamist eemaldada.\n\n\n\n\n\n\nÄra unusta pärast torude |&gt; kasutamist ggplot() käsu järel kihtide lisamisel + märki kasutamast!\n\n\n\n\nstarwars|&gt;\n  drop_na(height, gender)|&gt;\n1  ggplot(aes(height))+\n  geom_boxplot(aes(colour = gender))\n\n\n1\n\nggplot() käsk ei vaja nüüd andmestiku nime, sest see saadeti läbi torude |&gt; sulgude sisse esimesele kohale.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Joonised - lühiülevaade</span>"
    ]
  },
  {
    "objectID": "07-joonised.html#hea-joonise-disainimine",
    "href": "07-joonised.html#hea-joonise-disainimine",
    "title": "7  Joonised - lühiülevaade",
    "section": "7.4 “Hea joonise” disainimine",
    "text": "7.4 “Hea joonise” disainimine\nÜtlen kohe, et universaalselt head joonist, mis kõigile meeldiks ning oleks ühteviisi arusaadav, ei ole olemas. Üldiselt on hea joonis on see joonis, millest vaataja saab aru. Inimesed saavad paremini aru sellestt, millega nad on juba harjunud. Kasuta võimalusel valmis värvipalette.\nLoe selge sõnumi edastamise kohta rohkem raamatust Fundamentals of Data Visualization (Wilke 2019).\n\nStiili lisamine\nKasuta läbivalt ühes dokumendis jooniste puhul sama stiili. ggplot2 paketiga tuleb kaasa mitmeid stiile. Neid saab lisada joonisele eraldi kihina kasutades käsuga theme_*(). Näiteks kasutame theme_classic(), mis näeb veidi rahulikum välja kui ggplot2 baasjoonise stiil.\n\nggplot(starwars, aes(height))+\n  geom_boxplot(aes(colour = gender))+\n  labs(title =\"Naised on keskmiselt lühemad\",\n       subtitle = \"Aga olemas on ka lühikesi mehi\",\n       x=\"Pikkus sentimeetrites\",\n       color=\"Sugu\")+\n  theme_classic()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLisa kogu (markdown) dokumendile üks jooniste teema. Kasuta selleks käsku theme_set()\nNäiteks lisa dokumendi algusesse järgmine koodilõik.\n\n#theme_set(theme_classic())\n\n\n\n\nErinevad stiilid on: theme_gray(), theme_bw(), theme_linedraw(), theme_light(), theme_dark(), theme_minimal(), theme_classic(), theme_void(), theme_test() .\nKõiki stiile saab vajadusel ka kohendada ning vajadusel saab luua täiesti oma teema-stiili.\n\n\nJoonise tüüp vastavalt sõnumile\nVaata siit, kuidas esitada korrelatsiooni paketi corrplot või baaskäskude abil. Loe ka, kuidas saab tunnuse keskmiste võrdlust esitleda piltide abi.\n\n\n\n\n\n\nPeatükk on täiendamisel.\n\n\n\n\n\nViitade kohendamine\nNäiteks ei ole loogiline esitleda y-telje skaala numbreid, sest y-telg on meil nn kunstlik.\n\nggplot(starwars, aes(height))+\n  geom_boxplot(aes(colour = gender))+\n  labs(title =\"Naised on keskmiselt lühemad\",\n       subtitle = \"Aga olemas on ka lühikesi mehi\",\n       x=\"Pikkus sentimeetrites\",\n       color=\"Sugu\")+\n1  scale_y_continuous(breaks = NULL) +\n  theme_classic()\n\n\n1\n\nÄra kasuta y-teljel vahemike märke\n\n\n\n\n\n\n\n\n\n\n\nLisaks on imelik, et pool joonise viitasid on eesti keeles ja pool inglise keeles ning täitsa võõras inimene ei tea, kes või mis on NA. Tunnuseid ei pea ringi kodeerima, kategooriate silte saab vajadusel muuta ka otse joonisel.\n\nggplot(starwars, aes(height))+\n  geom_boxplot(aes(colour = gender))+\n  labs(title =\"Naised on keskmiselt lühemad\",\n       subtitle = \"aga olemas on ka lühikesi mehi\",\n       x=\"Pikkus sentimeetrites\",\n       color=\"Sugu\")+\n  scale_y_continuous(breaks = NULL)+\n  scale_color_discrete(labels=c(\"naiselik\", \"mehine\", \"teadmata\"))+\n  theme_light()+\n  theme(legend.position = \"bottom\")\n\nWarning: Removed 6 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\n\nVärvid joonistel - värvipaletid\nKõik inimesed ei näe värve ühte moodi, mistõttu alustan kohe sellest, kuidas muuta joonised värvipimedasõbralikuks. See peaks olema esimene vajadus, miks üldse hakata värve muutma. “Ilusad värvid” tulgu pärast seda.\nggplot2 paketiga tuleb kaasa viridis(Garnier et al. 2024) pakett. Värvide kasutamisel tuleb valida õige käsk sõltuvalt sellest, mis tüüpi on joonisel kasutatav tunnus. Käsk scale_fill_d() on kasutamiseks diskreetsete (st kategoorialsete) tunnuste puhul ning scale_fill_viridis_c() on järjestikuste tunnuste jaoks.\n\n\n\n\n\n\nviridis paketi värvid jätavad joonise loetavaks ka must-valgelt välja prindituna.\n\n\n\n\nstarwars|&gt;\n  drop_na(gender, sex)|&gt;\n  ggplot( aes(gender))+\n  geom_bar(position=\"fill\",aes(fill=sex))+\n  scale_fill_viridis_d()\n\n\n\n\n\n\n\n\nPakett RColorBrewer(Neuwirth 2022) annab valiku värvipallette, mis on sobilikud ka värvipimedatele.\nLoogiline on kasutada värvipalleti sõltuvalt tunnuse või joonise tüübist. Värvipalletid on jagatud, kus värvitoonid on kas järjestikused (sequential), lahknevad (divergent) või “kvalitatiivsed” (qualitative).\n\nlibrary(RColorBrewer)\n\nVaata värvipallettide valikut käsuga display.brewer.all() ning täpsusta käsu sees, mis tüüpi palleti soovid. Lisa juurde colorblindFriendly=T.\n\ndisplay.brewer.all(type=\"seq\",colorblindFriendly = T)\n\n\n\n\n\n\n\n\n\ndisplay.brewer.all(type=\"div\",colorblindFriendly = T)\n\n\n\n\n\n\n\n\n\ndisplay.brewer.all(type=\"qual\",colorblindFriendly = T)\n\n\n\n\n\n\n\n\nKonkreetse värvipaleti nägemiseks kasutame käksu display.brewer.pal(), kus esmalt tuleb öelda, mitut värvi on soov paletist näha ning seejärel kirjutada paleti nimi.\n\ndisplay.brewer.pal(n=12, name=\"Blues\")\n\nWarning in display.brewer.pal(n = 12, name = \"Blues\"): n too large, allowed maximum for palette Blues is 9\nDisplaying the palette you asked for with that many colors\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nKas märkasid hoiatusteadet? Antud paleti maksimumvõimekus on tegelikult üheksa erineva värviga ning seepärast kuvab ta mulle minu poolt küsitud 12 värvi asemel üheksa.\n\n\n\nIgal värvil on ka oma konkreetne nimi, mis on RGB-koodi või kuueteistkümnendsüsteemi HEXs.\nVärvinimede kuvamiseks tuleb kasutada brewer.pal() käsu sees täpsustust names ja värvipaletti nime.\n\nbrewer.pal(n=9, name=\"Blues\")\n\n[1] \"#F7FBFF\" \"#DEEBF7\" \"#C6DBEF\" \"#9ECAE1\" \"#6BAED6\" \"#4292C6\" \"#2171B5\"\n[8] \"#08519C\" \"#08306B\"\n\n\nKasutame nüüd mõnda meelepärast värvipaletti joonisel.\n\nggplot(starwars, aes(height, mass))+\n  geom_point(aes(color=sex))+\n  scale_color_brewer(palette=\"Set2\")+\n  theme_bw()\n\nWarning: Removed 31 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\n\n\nVärvid joonistel - käsitsi lisamine\nMõnikord on ikkagi vaja käsitsi lisada konkreetne värv. Näiteks on asutusel kasutuses kindlad värvid ja pead joonise tegema etteantud värvidega. Selleks on sobiv käsk scale_color_manual() või scale_fill_manual() sõltuvalt sellest, kas kasutad joonisel fill= või color=.\n\nggplot(starwars, aes(height))+\n  geom_boxplot(aes(fill=gender))+\n  scale_fill_manual(values=c(\"#DEEBF7\",\"#6BAED6\", \"#08519C\"))\n\nWarning: Removed 6 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nPane tähele, et NA väärtusi ei saa nii konkreetse värviga siduda. Selleks pead eraldi täpsustama na.value= , kuid siis on ta jätab legendis kollase värvi välja. Pane tähele, et R saab hakkama ka värvi nimedega.\n\nggplot(starwars, aes(height))+\n  geom_boxplot(aes(fill=gender))+\n  scale_fill_manual(na.value=\"yellow\", values=c(masculine=\"#DEEBF7\",feminine=\"#6BAED6\"))\n\nWarning: Removed 6 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\n\n\n\nChang, Winston. 2024. R Graphics Cookbook. 2nd ed. https://r-graphics.org/.\n\n\nGarnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2024. viridis(Lite) - Colorblind-Friendly Color Maps for r. https://doi.org/10.5281/zenodo.4679423.\n\n\nNeuwirth, Erich. 2022. RColorBrewer: ColorBrewer Palettes. https://CRAN.R-project.org/package=RColorBrewer.\n\n\nWickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2023. Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics. https://CRAN.R-project.org/package=ggplot2.\n\n\nWilke, Claus O. 2019. Fundamentals of Data Visualization. O’Reilly Media, Inc. https://clauswilke.com/dataviz.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Joonised - lühiülevaade</span>"
    ]
  },
  {
    "objectID": "08-kuupaevad.html",
    "href": "08-kuupaevad.html",
    "title": "8  Kuupäevad",
    "section": "",
    "text": "8.1 Kuupäeva formaat\nKuupäevadega toimetamist hõlpsustab pakett lubridate (Grolemund and Wickham 2011), mis on ka osa tidyverse pakketide kogumist. Piisab tidyverse paketi kasutuselevõtmisest.\nKuupäeva on võimalik kirjutada mitmel viisil ning vaatame kuupäeva väljatrükke käskudega date(), today() ja now(). Need käsud ütlevad veidike erineval moel mis aeg praegu on.\ndate()\n\n[1] \"Sun Jul  6 19:44:39 2025\"\ntoday()\n\n[1] \"2025-07-06\"\nnow()\n\n[1] \"2025-07-06 19:44:39 EEST\"\nEestis kirjutatakse kuupäevi päev-kuu-aasta formaadis. Mõned riigid (ja registrite süsteemid) kirjutavad kuupäevi aasta-kuu-päev või kuu-päev-aasta formaadis.\nRegistrites võidakse kuupäeva kirjutada erinevate eraldajatega ning R-i jaoks on need andmeväljad kõik stringid (ehk tekstiväljad).\nKui inimsilm saab veel aru, et tegemist on kuupäevaga, siis R sellest niisama lihtsalt aru ei saa.\nÜks võimalus on kohe andmete sisselugemisel öelda, et selle tulba puhul tegemist on kuupäevaga, kuid oletame, et andmed on juba R-i sisse loetud ning alles nüüd märkad, et andmestik sisaldab ka kuupäevi.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Kuupäevad</span>"
    ]
  },
  {
    "objectID": "08-kuupaevad.html#kuupäeva-formaat",
    "href": "08-kuupaevad.html#kuupäeva-formaat",
    "title": "8  Kuupäevad",
    "section": "",
    "text": "04.05.2024\n04-05-2024\n04/05/2024\n\n\n\n\nKuupäeva teisendamine\nTeen läbi koos levinumate komistuskividega kuupäevade teisendamise, et oleks arusaadav tööpõhimõte.\n\nkuupaev&lt;-04052024\nclass(kuupaev)\n\n[1] \"numeric\"\n\n\nTunnuse tüüpi saab muuta käsuga as_date().\n\nkuupaev&lt;-as_date(kuupaev)\nclass(kuupaev)\n\n[1] \"Date\"\n\nkuupaev\n\n[1] \"13064-01-25\"\n\n\nR luges pika numbrijoru küll kuupäevaks, kuid tegemist on nüüd väga kauge tulevikuga. See on seepärast, et date puhul algab ajaarvamine 1. jaanuarist 1970 ning loetakse päevi alates sellest kuupäevast. Seda käsku võib vaja minna kui oled juba saanud kellegi käest andmestiku, mis on ka sisaldab ka kuupäeva asemel hoopis päevade arvu.\nSelleks, et R saaks aru, mis kujul kuupäev kirjutatud on, peaksime kasutama käske dmy(), mdy() ja ymd(), et ette öelda, mis osa tekstist on päev, kuu ja aasta.\n\nkuupaev&lt;-04052024\nkuupaev&lt;-dmy(kuupaev)\nkuupaev\n\n[1] \"2024-05-04\"\n\nclass(kuupaev)\n\n[1] \"Date\"\n\n\nNeed käsud töötavad väga hästi ka tekstiväljadega.\n\ndmy(\"03/10/2024\")\n\n[1] \"2024-10-03\"\n\n\n\nmdy(\"10.03.2024\")\n\n[1] \"2024-10-03\"\n\n\n\n\nKuupäevast kuu, aasta ja nädalapäeva eraldamine\nKasutada saab käske year(), month(), mday(), wday(), hour(), minute() ja second(). Proovime järele juba salvestatud kuupäeva objektiga.\n\nyear(kuupaev)\n\n[1] 2024\n\n\n\nmonth(kuupaev)\n\n[1] 5\n\n\nKuupäeva eraldamiseks on mday() ja nädalapäeva eraldamisks wday().\n\nmday(kuupaev)\n\n[1] 4\n\n\n\nwday(kuupaev)\n\n[1] 7\n\n\n\n\n\n\n\n\nwday() käsk annab nädalapäeva numbri. Ole sellega ettevaatlik!\nKui kuude järjekord aastas ei muutu (st jaanuar=1, veebruar=2 jne), siis nädalapäevadega on taaskord keerulisem.\nR-is algab nädal meile mitteharjumuspäraselt hoopis pühapäevaga ning seitsmes päev on hoopiski laupäev. Kui tahame, et nädal algaks esmaspäevaga, peame käsu sees täpsustama week_day=1.\n\nwday(kuupaev, week_start = 1)\n\n[1] 6\n\n\n\n\n\nKuupäevaga (st date formaadis) salvestub koos väärtusega ka silt (label).\n\nmonth(kuupaev)\n\n[1] 5\n\nmonth(kuupaev, label = T)\n\n[1] May\n12 Levels: Jan &lt; Feb &lt; Mar &lt; Apr &lt; May &lt; Jun &lt; Jul &lt; Aug &lt; Sep &lt; ... &lt; Dec\n\n\n\nwday(kuupaev)\n\n[1] 7\n\nwday(kuupaev, label=T)\n\n[1] Sat\nLevels: Sun &lt; Mon &lt; Tue &lt; Wed &lt; Thu &lt; Fri &lt; Sat\n\n\nLisaks saab R-is tuvastada, millises kvartalis või semestris kuupäev paikneb vastavalt käskudega quarter() ja semester().\n\nquarter(kuupaev)\n\n[1] 2\n\n\n\nsemester(kuupaev)\n\n[1] 1\n\n\n\n\nKellaaegade eraldamine\nKuna kellaaega ei ole kuupäevaga koos sisestatud, on kellaaegade väärtuseks 0.\n\nhour(kuupaev) \n\n[1] 0\n\nminute(kuupaev) \n\n[1] 0\n\nsecond(kuupaev) \n\n[1] 0\n\n\n\nhour(now())\n\n[1] 19\n\nminute(now())\n\n[1] 44\n\nsecond(now())\n\n[1] 39.78578\n\n\n\n\nKuupäeva koostamine\nMõnikord on andmestikus kuupäeva andmed eraldi tulpades (päev, kuu, aasta). Sellisel juhul on vaja kasutada käsku make_date() või make_date_time() kui olemas on ka kellaajad.\nMul ei ole näiteks kasutada sellist andmestikku, aga kuupäeva moodustamiseks tuleks käsu sees liikuda suuremast ühikust väiksema poole ehk aasta, kuu, kuupäev. Kasutan tulpade nimede asemel siin näites numbreid.\n\nmake_date(2024, 2, 14)\n\n[1] \"2024-02-14\"",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Kuupäevad</span>"
    ]
  },
  {
    "objectID": "08-kuupaevad.html#kuupäevade-ümardamine",
    "href": "08-kuupaevad.html#kuupäevade-ümardamine",
    "title": "8  Kuupäevad",
    "section": "8.2 Kuupäevade ümardamine",
    "text": "8.2 Kuupäevade ümardamine\nKuupäevade ümardamiseks on olemas küll käsk round_date(), kuid selle kasutamist ma väga ei soovita. Üldiselt on kuupäevasid vaja ümardada mingis kindlas suunas st kas üles või alla poole.\nSeepäras on parem kasutada käske floor_date() ja ceiling_date(), sest nii saab määrata kuhu suunas kuupäeva ümardama hakatakse. Lisaks suunale tuleb mõlema käsu puhul täpsustada, kuhu maani on vaja ümardada. Võib-olla on vaja hoopis käsku roll_back()?\n\n\n\n\n\n\nNädala alguseni ümardades tuleb kindlasti lisada week_start=1 kui tahame, et nädal algaks esmaspäevaga.\n\n\n\n\nfloor_date(dmy(03102024), \"week\", week_start = 1)\n\n[1] \"2024-09-30\"\n\n\nKuude puhul on võimalus ümardada käesoleva kuu või eelmise kuu alguseni vastavalt “month” või “bimonth” täpsustusega.\n\nfloor_date(dmy(03102024), \"month\")\n\n[1] \"2024-10-01\"\n\n\n\nfloor_date(dmy(03102024), \"bimonth\")\n\n[1] \"2024-09-01\"\n\n\nVõimalus on ümardada ka kvartali või aastaaja ning poolaasta ja aasta alguseni.\n\nfloor_date(dmy(03102024), \"quarter\")\n\n[1] \"2024-10-01\"\n\n\n\nfloor_date(dmy(03102024), \"season\")\n\n[1] \"2024-09-01\"\n\n\n\nfloor_date(dmy(03102024), \"halfyear\")\n\n[1] \"2024-07-01\"\n\n\n\nfloor_date(dmy(03102024), \"year\")\n\n[1] \"2024-01-01\"\n\n\nKõik on olemuselt sama ka kuupäeva ülespoole ümardamisega ehk käsu ceiling_date() kasutamisega. Meeles peab pidama, et üles poole ümardades ümardab R kuupäeva järgmise ühiku esimese päevani. Näiteks 3. oktoober ümardatakse 1. novembriks mitte 31. oktoobriks.\n\nceiling_date(dmy(03102024), \"month\")\n\n[1] \"2024-11-01\"\n\n\nKui soovime ümardada sama kuu viimase päevani, peame lisama käsu lõppu -1.\n\nceiling_date(dmy(03102024), \"month\")-1\n\n[1] \"2024-10-31\"\n\n\nNädala päevaga on nagunii vaja meeles pidada, et peame R-ile selgitama, millise päevaga nädal meie jaoks algab.\n\nceiling_date(dmy(03102024), \"week\", week_start = 1)\n\n[1] \"2024-10-07\"\n\n\nSelliselt ümardab R 3. oktoobri kuupäeva üles järgmise nädala esmaspäevaseks päevaks, mis 2024. aastal on 7. oktoober. Kui tahame aga nädala lõppu saada, siis justkui piisaks, et ära jätta täpsustus week_start=1 ning saamegi kätte nädala lõpu kuupäeva.\n\nceiling_date(dmy(03102024), \"week\")\n\n[1] \"2024-10-06\"\n\n\n\n\n\n\n\n\nSiiski kindluse mõttes, soovitan kasutada võib-olla kohmakana tunduvat kirjutamist, et esmalt lisad week_start=1 ja seejärel lisad -1. Selliselt käitudes hoiad oma koodikirjutamise rütmi ühesugusena ja kiirustades ei unusta, et nädalapäevade puhul peab täpsustama, mis päevast nädala algust lugema hakata tuleb.\n\n\n\n\nceiling_date(dmy(03102024), \"week\", week_start = 1)-1\n\n[1] \"2024-10-06\"\n\n\n\n\n\n\n\n\nKui kuupäeva lahter sisaldab ka kellaegu, saab samade käskudega floor_date() või ceiling_date() ümardada kellaega “second”, “minute” ja “hour” ühikutega.\n\n\n\nJuhul kui vaja on ümardada alla eelmise kuu viimaseks kuupäevaks, on mugav kasutada käsku rollback().\n\nrollback(dmy(03102024))\n\n[1] \"2024-09-30\"",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Kuupäevad</span>"
    ]
  },
  {
    "objectID": "08-kuupaevad.html#tehted-kuupäevadega",
    "href": "08-kuupaevad.html#tehted-kuupäevadega",
    "title": "8  Kuupäevad",
    "section": "8.3 Tehted kuupäevadega",
    "text": "8.3 Tehted kuupäevadega\nAeg on keeruline mõõtühik, kuna aja suurusjärgud pole ühtlaselt püsivad. Näiteks nädalas on alati seitse päeva, kuid ühes kuus või aastas ei ole alati sama palju päevi. Näiteks kui lisada 31. jaanuarile juurde üks kuu, siis võiks vastuseks saada näiteks 28. veebruar (eeldusel, et tegemist ei ole liigaastaga) või 2. märtsiga (kui lisada juurde 31 päeva). Väga suur vahe kui soov on kokkuleppida mingit kindlat tähtaega. Kui kaua aega tegevuse läbiviimiseks tegelikult kulub?\nSeepärast peab läbi mõtlema, millist aega tehtes kasutada soovitakse - aeg kestvusena (duration) või püsiva (kalendri) ühikuna (period).\nSelgitan ajaliitmise segadust näitega. 2024 on liigaasta ning kontrollime selle igaks juhuks käsuga leap_year() üle.\n\nleap_year(2024)\n\n[1] TRUE\n\n\nKasutades tavalisi matemaatilisi tehete märke (+ ja -), saame lisada 1. jaanuarile 2024 juurde ühe aasta käsuga years(). Sulgudes tuleb täpsustada, mitut aastat liita soovitakse.\n\ndmy(01012024)+years(1)\n\n[1] \"2025-01-01\"\n\n\nSaame vastuseks 1. jaanuar 2025. Kas see on see, mida tegelikult tahtsime? Võib-olla on. Kui soovime kuupäevale aega kestvusena juurde liita, tuleb kasutada käske, mis algavad väikese d-ga, dyears().\n\ndmy(01012024)+dyears(1)\n\n[1] \"2024-12-31 06:00:00 UTC\"\n\n\nNüüd saame vastuseks 31.detsember 2024, sest käsk dyears() liidab kuupäevale juurde 365,25 päeva mitte ei nihuta kuupäeva ühe kalendriaasta võrra edasi.\nVaatame korra üle kui mitu päeva on ühes aastas ja ühes kuus.\n\ndyears(1)/ddays(1)\n\n[1] 365.25\n\ndmonths(1)/ddays(1)\n\n[1] 30.4375\n\n\nKuna aja arvestamine sekundites siis ajakulgemise puhul loetakse kui palju sekundeid on ühes keskmises aastas. Sekundid ei jaotu täpselt ning seepärast ongi kord ühes kuus 30 ja 31 päeva ning liigaasta, et aega järgi kohendada.\nSeega kui liidame ühe kuu kestvusena (dmonths()) 31. jaanuarile 2024, saame vastuseks 1. märts (sest kuupäevale liideti 30,4375 päeva ning 2024. aastal on veebruar ühe päeva võrra pikem kui tavaliselt.\n\ndmy(31012024)+dmonths(1)\n\n[1] \"2024-03-01 10:30:00 UTC\"\n\n\nKui liidame 31. jaanuarile niisama perioodiühikuna ühe kuu (months()), saame vastuseks NA. Perioodiühikuna peaks õige vastus tulema 30. veebruar, kuid sellist kuupäeva ei ole olemas.\n\ndmy(31012024)+months(1)\n\n[1] NA\n\n\nAjaühikud saab liita, jagada ja korrutada tavaliste matemaatiliste tehetena.\n\nMillal tegevus lõpeb?\nÜtleme, et projekti üks tegevus võtab aega 3 kuud ja 2 nädalat ning seda tegevust on vaja korrata 5 korda. Soovime teada kui pikaks ajaliselt projekt kujuneb?\n\n3*(months(5)+weeks(2))\n\n[1] \"15m 42d 0H 0M 0S\"\n\n\nNüüd soovime teada saada projekti lõpukuupäeva teades, et projektiga alustame järgmisel kuu esimesest kuupäevast.\nKui arvutame aega perioodina, siis lõpeb projekt sel kuupäeval.\n\nceiling_date(today())+3*(months(5)+weeks(2))\n\n[1] \"2026-11-17 00:00:01 UTC\"\n\n\nKui arvutame aega kestvusena, siis lõpeb projekt sellel kuupäeval.\n\nceiling_date(today())+3*(dmonths(5)+dweeks(2))\n\n[1] \"2026-11-16 13:30:01 UTC\"\n\n\n\n\nKui kaua tegevus kestis?\nPäris tihti tahame arvutada kui pikk aeg on kulunud kahe teadaoleva sündmuse vahel.\nNäiteks on meil teada Marie Curie sünniaeg (7. november 1867) ning temale antud nobeli preemia tunnistel olev kuupäev (10. detsember 1903).\n\nMCsund&lt;-dmy(07111867)\nNBpreemia&lt;-dmy(10121903)\n\nArvutame välja kahe kuupäeva vahelise aja nii, et käesolevale hetkele lähemal olev kuupäev on esimene.\n\nNBpreemia-MCsund\n\nTime difference of 13181 days\n\n\nNii suuri ajaühikud nagu 13181 päeva hoomame paremini aastates. Kasutada tuleb käsku as.duration(), mis annab esmalt küll ajaühiku sekundites, kuid ümardab selle inimesele hoomatavateks ajaühikuteks.\n\nas.duration(NBpreemia-MCsund)\n\n[1] \"1138838400s (~36.09 years)\"\n\n\nKui kahe sündmuse vaheline aeg on väiksem, ümardatakse sekundid muu ajamõõtühikuni (nt months, days, weeks).\n\nas.duration(dmy(04052024)-dmy(01052024))\n\n[1] \"259200s (~3 days)\"",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Kuupäevad</span>"
    ]
  },
  {
    "objectID": "08-kuupaevad.html#intervallid",
    "href": "08-kuupaevad.html#intervallid",
    "title": "8  Kuupäevad",
    "section": "8.4 Intervallid",
    "text": "8.4 Intervallid\nIntervall on mingi aja kestvus kindla aja algusega. Selle järgi saab teada kui kaua midagi kestab.\nTeeme proovi ja salvestame tänasele ühe kuu (perioodina) otsa.\n\njargmine_kuu&lt;-today()+months(1)\njargmine_kuu\n\n[1] \"2025-08-06\"\n\n\nNüüd arvutame välja kui kaua kulub tänasest aega päevades meie soovitud sündmuseni ehk järgmise kuuni.\n\n(today() %--% jargmine_kuu) / ddays(1)\n\n[1] 31\n\n\nVaatame tehet uuesti Marie Curie ja nobelipreemiaga. Arvutame intervalli ja jagame selle kestvusega aastades (dyears()).\n\n(MCsund %--% NBpreemia) / dyears(1)\n\n[1] 36.08761",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Kuupäevad</span>"
    ]
  },
  {
    "objectID": "08-kuupaevad.html#ajatsoonid",
    "href": "08-kuupaevad.html#ajatsoonid",
    "title": "8  Kuupäevad",
    "section": "8.5 Ajatsoonid",
    "text": "8.5 Ajatsoonid\nR tunneb umbes 600 erinevat ajatsooni ning iga tsooni kohta oskab arvestada kellakeeramist ning ajaloolist kalendriaega. Selleks, et näha mis ajatsoonid on, tuleb käivitada käsk OlsonNames().\n\n#OlsonNames()\n\nVaatame korra, mis aeg on praegu Tallinnas ja Tokyos.\n\nnow(tzone=\"Europe/Tallinn\")\n\n[1] \"2025-07-06 19:44:39 EEST\"\n\n\n\nnow(tzone=\"Asia/Tokyo\")\n\n[1] \"2025-07-07 01:44:39 JST\"\n\n\nSalvestame praeguse hetke eraldi objekti.\n\naeg&lt;-now()\naeg\n\n[1] \"2025-07-06 19:44:39 EEST\"\n\n\nKäsk with_tz() annab väljundiks aja, mis on etteantud aeg konkreetses ajatsoonis.\n\nwith_tz(aeg, tzone = \"Asia/Tokyo\")\n\n[1] \"2025-07-07 01:44:39 JST\"\n\nwith_tz(aeg, tzone = \"Europe/Tallinn\")\n\n[1] \"2025-07-06 19:44:39 EEST\"\n\nwith_tz(aeg, tzone = \"America/New_York\")\n\n[1] \"2025-07-06 12:44:39 EDT\"\n\n\nKäks force_tz() ütleb aga paneb meie antud aja muutumatuna kujul etteantud ajatsooni.\n\nforce_tz(aeg, tzone = \"Asia/Tokyo\")\n\n[1] \"2025-07-06 19:44:39 JST\"\n\nforce_tz(aeg, tzone = \"Europe/Tallinn\")\n\n[1] \"2025-07-06 19:44:39 EEST\"\n\nforce_tz(aeg, tzone = \"America/New_York\")\n\n[1] \"2025-07-06 19:44:39 EDT\"",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Kuupäevad</span>"
    ]
  },
  {
    "objectID": "08-kuupaevad.html#aja-esitlemine-joonistel",
    "href": "08-kuupaevad.html#aja-esitlemine-joonistel",
    "title": "8  Kuupäevad",
    "section": "8.6 Aja esitlemine joonistel",
    "text": "8.6 Aja esitlemine joonistel\nÜldiselt esitatakse aega joonisel joonena. Sõltub muidugi sellest, mida joonisel soov edasi anda on ning saab kasutada neid joonise tüüpe, mida numbriliste tunnuste esitamisel soov on.\nKui kasutada aega numeric väärtusega joonistel (nt histogram), siis sellisel juhul on 1 väärtus 1 sekund. Ühes päevas on 86400 sekundit.\nKui kasutused on date tüüpi andmed, siis 1 väärtus on 1 päev.\n\n\n\n\nGrolemund, Garrett, and Hadley Wickham. 2011. “Dates and Times Made Easy with lubridate.” Journal of Statistical Software 40 (3): 1–25. https://www.jstatsoft.org/v40/i03/.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Kuupäevad</span>"
    ]
  },
  {
    "objectID": "09-kirjeldav-statistika.html",
    "href": "09-kirjeldav-statistika.html",
    "title": "9  Kirjeldav statistika",
    "section": "",
    "text": "9.1 Kirjeldava statistika leidmine\nStatistiline andmeanalüüs algab minu jaoks kirjeldava statistikaga. Peatükk annab vastuse küsimusele “kuidas seda R-is teha?”.\ndata(starwars)\nkäsk summary() annab numbrilise tunnuse puhul sarnase ülevaate, mida sagedasti kirjeldava statistika puhul teada saada soovime. Vaata ka alapeatükki tunnuste sisuga tutvumine, kus on numbriliste tunnuste baaskäsud kirjeldava statistika leidmiseks.\nLisaks on veel rida erinevaid käske, mis teevad töötamise mugavaks ning põhjalikuma ülevaate saamiseks on parem kasutada juba spetsiaalselt kirjeldava statistika saamiseks loodud pakette.\nKvantiilide leidmiseks on käsk quantile(), mille sees tuleb täpsustada mitmendat kvantiili soovime teada.\nquantile(starwars$height, 0.25, na.rm=T)\n\n25% \n167\nStandardhälve leidmiseks on käsk sd() ja dispersiooni jaoks var().\nsd(starwars$height, na.rm=T)\n\n[1] 34.77416\nvar(starwars$height, na.rm=T)\n\n[1] 1209.242",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Kirjeldav statistika</span>"
    ]
  },
  {
    "objectID": "09-kirjeldav-statistika.html#kirjeldav-stat",
    "href": "09-kirjeldav-statistika.html#kirjeldav-stat",
    "title": "9  Kirjeldav statistika",
    "section": "",
    "text": "Mood leidmine R-is\nR ei anna numbriliste jaoks baaskäsuna mood-i ning selle leidmiseks peab minema ringiga.\n\n\n\n\n\n\nKõige pealt on vaja salvestada väärtuste sageduse jaotus tabelisse käsuga table() ja seejärel tuleb leida väärtuste esinemissagedus käsu sort() abil järjestades nad suuremast väiksemani.\n\n\n\n\n\n\n\n\n\nPane tähele, et käsu sort() sees ei ole kasutatud käsku desc(), vaid täpsustatud decreasing = T.\n\n\n\n\nsort(table(Orange$age), decreasing = T)\n\n\n 118  484  664 1004 1231 1372 1582 \n   5    5    5    5    5    5    5 \n\n\n\n\n\n\n\n\nTulemuste tõlendamisel arvesta võimalusega, et mõnikord andmetes moodi ei olegi.\n\n\n\n\n\nSagedustabelid\nÜhe või kahemõõtmelise sagedustabeli saamiseks piisab käsust table().\n\ntable(starwars$gender)\n\n\n feminine masculine \n       17        66 \n\n\nEnamsti on vaja lisaks andmete jaotusele aru saada ka jagunemise proportsioonidest (osakaaludest). Selleks on mitu erinevat võimalust.\nKäsk prop.table() vajab uuritavaks tunnuseks tabelit ning tabeli võib eelnevalt salvesta eraldi objekti või kasuta kahe käsu kombinatsiooni.\n\n\n\n\n\n\nKäsu table() põhjal toimub ka hii-ruut statistiku arvutamine, et mõnikord “tasub” väiksemate tabelite objektideks salvestamine end ära.\n\n\n\n\nprop.table(table(starwars$gender))\n\n\n feminine masculine \n0.2048193 0.7951807 \n\n\nKahemõõtmeline sagedustabel vajab sulgude sees täpsustust. Esimene tunnus pannakse ridadeks ja teine tunnus veergudeks.\n\ntable(starwars$sex, starwars$gender)\n\n                \n                 feminine masculine\n  female               16         0\n  hermaphroditic        0         1\n  male                  0        60\n  none                  1         5\n\n\nKui on kahemõõtlemine sagedustabel, tuleb täpsustada kas soovitakse rea protsente (lisada sulgudesse nr 1) või tulpade oma (2). Kui ei täpsusta milliseid osakaale soovid, näitab käsk kogu tabeli proportsionaalset jaotust.\n\ntabel&lt;-table(starwars$sex, starwars$gender)\nprop.table(tabel,2)\n\n                \n                   feminine  masculine\n  female         0.94117647 0.00000000\n  hermaphroditic 0.00000000 0.01515152\n  male           0.00000000 0.90909091\n  none           0.05882353 0.07575758\n\n\nKolmemõõtlemine sagedustabeli tegemine käib sama loogika alusel, kuid võib-olla on siin juba mugavam saada tidyverse paketi käskude (group_by() ja summarise()) abil olukorrast parem pilt.\n\nstarwars|&gt;\n  group_by(gender, sex)|&gt;\n  summarise(n=n())\n\n`summarise()` has grouped output by 'gender'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 6 × 3\n# Groups:   gender [3]\n  gender    sex                n\n  &lt;chr&gt;     &lt;chr&gt;          &lt;int&gt;\n1 feminine  female            16\n2 feminine  none               1\n3 masculine hermaphroditic     1\n4 masculine male              60\n5 masculine none               5\n6 &lt;NA&gt;      &lt;NA&gt;               4",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Kirjeldav statistika</span>"
    ]
  },
  {
    "objectID": "09-kirjeldav-statistika.html#kirjeldav-paketid",
    "href": "09-kirjeldav-statistika.html#kirjeldav-paketid",
    "title": "9  Kirjeldav statistika",
    "section": "9.2 Erinevad paketid kirjeldava statistika jaoks",
    "text": "9.2 Erinevad paketid kirjeldava statistika jaoks\n\nPakett sjmics\nKirjeldava statistika puhul huvitab meid rohkem kui lihtsalt gruppide sees sageduse loendamine, sest näha tahame ka suhtelist ja kumulatiivset sagedust. Selleks on parem kasutada paketist sjmisc (Lüdecke 2018) käske käsk frq() ja descr()\n\nlibrary(sjmisc)\n\n\nfrq(starwars$gender)\n\nx &lt;character&gt; \n# total N=87 valid N=83 mean=1.80 sd=0.41\n\nValue     |  N | Raw % | Valid % | Cum. %\n-----------------------------------------\nfeminine  | 17 | 19.54 |   20.48 |  20.48\nmasculine | 66 | 75.86 |   79.52 | 100.00\n&lt;NA&gt;      |  4 |  4.60 |    &lt;NA&gt; |   &lt;NA&gt;\n\n\n\ndescr(starwars$height)\n\n\n## Basic descriptive statistics\n\n var    type label  n NA.prc  mean    sd   se  md trimmed        range iqr\n  dd integer    dd 81    6.9 174.6 34.77 3.86 180  178.48 198 (66-264)  24\n  skew\n -1.09\n\n\nSoovi korral võib kirjutada aga käsu sisse andmestiku nime ja ülejäänud numbrilised tunnused, mille kohta ülevaadet soovime.\n\ndescr(starwars, height, mass)\n\n\n## Basic descriptive statistics\n\n    var    type  label  n NA.prc   mean     sd    se  md trimmed          range\n height integer height 81   6.90 174.60  34.77  3.86 180  178.48   198 (66-264)\n   mass numeric   mass 59  32.18  97.31 169.46 22.06  79   75.44 1343 (15-1358)\n  iqr  skew\n 24.0 -1.09\n 28.9  7.34\n\n\n\nfrq(starwars, sex, gender)\n\nsex &lt;character&gt; \n# total N=87 valid N=83 mean=2.67 sd=0.87\n\nValue          |  N | Raw % | Valid % | Cum. %\n----------------------------------------------\nfemale         | 16 | 18.39 |   19.28 |  19.28\nhermaphroditic |  1 |  1.15 |    1.20 |  20.48\nmale           | 60 | 68.97 |   72.29 |  92.77\nnone           |  6 |  6.90 |    7.23 | 100.00\n&lt;NA&gt;           |  4 |  4.60 |    &lt;NA&gt; |   &lt;NA&gt;\n\ngender &lt;character&gt; \n# total N=87 valid N=83 mean=1.80 sd=0.41\n\nValue     |  N | Raw % | Valid % | Cum. %\n-----------------------------------------\nfeminine  | 17 | 19.54 |   20.48 |  20.48\nmasculine | 66 | 75.86 |   79.52 | 100.00\n&lt;NA&gt;      |  4 |  4.60 |    &lt;NA&gt; |   &lt;NA&gt;\n\n\n\n\nPakett pastecs\nKirjeldava statistika saamiseks on olemas käsk stat.desc() paketist pastecs (Grosjean and Ibanez 2024), mis annab vajadusel kogu andmestiku nubrilistele tunnuste kohta kompaktse ülevaate. Tunnusele “Tree” annab vastusteks NA, sest kuigi tunnus paistab välja nagu sisaldaks numbreid, on need tegelikult faktorid. Vaata tunnuste tüüpide muutmist siit.\n\nclass(Orange$Tree)\n\n[1] \"ordered\" \"factor\" \n\n\n\nlibrary(pastecs)\n\n\ndata(Orange)\n\n\nstat.desc(Orange)\n\n         Tree          age circumference\nnbr.val    NA 3.500000e+01    35.0000000\nnbr.null   NA 0.000000e+00     0.0000000\nnbr.na     NA 0.000000e+00     0.0000000\nmin        NA 1.180000e+02    30.0000000\nmax        NA 1.582000e+03   214.0000000\nrange      NA 1.464000e+03   184.0000000\nsum        NA 3.227500e+04  4055.0000000\nmedian     NA 1.004000e+03   115.0000000\nmean       NA 9.221429e+02   115.8571429\nSE.mean    NA 8.314028e+01     9.7172759\nCI.mean    NA 1.689614e+02    19.7478805\nvar        NA 2.419307e+05  3304.8907563\nstd.dev    NA 4.918645e+02    57.4881793\ncoef.var   NA 5.333930e-01     0.4961988\n\n\nVõimalus on tellida statistika väljatrükk ka ainult konkreetse tunnuse kohta.\n\n\n\n\n\n\nKasuta käsku round(), et muuta väljatrükk inimsilmale sõbralikumaks. Number sulgude sees näitab, mitu komakohta kuvada.\n\n\n\n\nround(stat.desc(starwars$height), 3)\n\n     nbr.val     nbr.null       nbr.na          min          max        range \n      81.000        0.000        6.000       66.000      264.000      198.000 \n         sum       median         mean      SE.mean CI.mean.0.95          var \n   14143.000      180.000      174.605        3.864        7.689     1209.242 \n     std.dev     coef.var \n      34.774        0.199 \n\n\n\n\n\n\nGrosjean, Philippe, and Frederic Ibanez. 2024. Pastecs: Package for Analysis of Space-Time Ecological Series. https://CRAN.R-project.org/package=pastecs.\n\n\nLüdecke, Daniel. 2018. “Sjmisc: Data and Variable Transformation Functions.” Journal of Open Source Software 3 (26): 754. https://doi.org/10.21105/joss.00754.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Kirjeldav statistika</span>"
    ]
  },
  {
    "objectID": "10-seosed-tunnustes.html",
    "href": "10-seosed-tunnustes.html",
    "title": "10  Seosed tunnuste vahel",
    "section": "",
    "text": "10.1 Hii-ruut\nSee peatükk annab ülevaate, kuidas leida R-is seosekordajate väärtused tunnuste vahel. Analüüsimeetod tuleb valida vastavalt analüüsitavatele tunnustele.\nHii-ruut leidmisel on mitmeid võimalusi ning taaskord on see maitse asi, millises järjekorras käsud koodis kokku kirjutada. Arvutamine toimub (rist)tabeli pealt.\nVaatame käske table(), summary() ja chisq.test() erinevaid viise.\nHii-ruut väärtuse saab kätte käsuga summary(), kui kirjutada sulgude sisse, millise risttabeli (st table()) põhjal arvutusi on vaja teha. Tabeli võib salvestada eelnevalt eraldi objekti, kuid ei pea seda tegema.\nsummary(table(starwars$gender, starwars$sex))\n\nNumber of cases in table: 83 \nNumber of factors: 2 \nTest for independence of all factors:\n    Chisq = 77.88, df = 3, p-value = 8.729e-17\n    Chi-squared approximation may be incorrect\nTeine võimalus on tellida eraldi chisq.test() käsu abil hii-ruut.\ntable(starwars$sex, starwars$gender)|&gt;\n  chisq.test()\n\nWarning in chisq.test(table(starwars$sex, starwars$gender)): Chi-squared\napproximation may be incorrect\n\n\n\n    Pearson's Chi-squared test\n\ndata:  table(starwars$sex, starwars$gender)\nX-squared = 77.883, df = 3, p-value &lt; 2.2e-16",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Seosed tunnuste vahel</span>"
    ]
  },
  {
    "objectID": "10-seosed-tunnustes.html#hii-ruut",
    "href": "10-seosed-tunnustes.html#hii-ruut",
    "title": "10  Seosed tunnuste vahel",
    "section": "",
    "text": "Ava käsuga ?chisq.test() test dokumentatsioon, et saada paremini aimu käsu tööst.\n\n\n\n\n\n\n\n\n\n\n\n\n\nLisaks arvutuste väljatrükile harjuta lugema end ka teateid, mida R kuvab. Praegu ütleb ta, et tulemus võib olla vale. Põhjus ei ole siis selles, et programm arvutada ei oska, vaid hii-ruut statistik on tundlik kui tabelis on väiksed või puuduvad rühmad.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Seosed tunnuste vahel</span>"
    ]
  },
  {
    "objectID": "10-seosed-tunnustes.html#crameri-v",
    "href": "10-seosed-tunnustes.html#crameri-v",
    "title": "10  Seosed tunnuste vahel",
    "section": "10.2 Crameri V",
    "text": "10.2 Crameri V\nCrameri V leidmiseks on käsk CramerV(), mille saab paketist DescTools(Signorell 2024).\nCrameri V väärtus jääb vahemikku 0 kuni 1. Mida lähemale number ühele, seda suurem on seos.\nKui hii-ruut statistiku väärtused ei ole erinevate tabelite suuruse osas omavahel võrreldavad, siis Crameri V on.\n\nlibrary(DescTools)\n\nKäsu kasutamisel tasub kohe sulgudes ära täpsustada, et soov on näha ka usalduspiire (conf.level=).\n\ntable(starwars$sex, starwars$gender)|&gt;\n  CramerV(, conf.level=0.95)\n\n Cramer V    lwr.ci    upr.ci \n0.9686868 0.7393305 1.0000000 \n\n\nCrameri V väärtus on peaaegu 1, mis näitab et tunnuste sex ja gender on tugevas seoses. Species ja gender omavaheline seos on nõrgem kui sex ja gender.\n\ntable(starwars$gender, starwars$species)|&gt;\n  CramerV(, conf.level=0.95)\n\n Cramer V    lwr.ci    upr.ci \n0.6081144 0.0000000 0.4207425",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Seosed tunnuste vahel</span>"
    ]
  },
  {
    "objectID": "10-seosed-tunnustes.html#korrelatsioon",
    "href": "10-seosed-tunnustes.html#korrelatsioon",
    "title": "10  Seosed tunnuste vahel",
    "section": "10.3 Korrelatsioon",
    "text": "10.3 Korrelatsioon\nKahe arvutunnuse vahelist seost vaadatakse Pearsoni korralatsioonikordajaga ning käsk cor() tuleb baasversioonist. Spearmani korrelatsioonikordajat kasutatakse kas kahe arvulise või järjestustunnuse vahel. Käsk cor() on mõlemal juhul sama, kuid täpsustada tuleks arvutusmeetod (vaikimisi on “pearson”, valida saab ka “kendall”).\n\ncor(starwars$height, starwars$mass, \n1    use=\"complete.obs\")\n\n\n1\n\nEemaldab tühjad väärtused. Valida saab ka use=\"everything\".\n\n\n\n\n[1] 0.130859\n\n\nSeos on positiivne ehk mida pikem on tegelane, seda suurem on ka tema mass. Seose tugevus on pehmelt öeldes pigem tagasihoidlik.\nKäsku cor() saab kasutada ka tervele maatriksile (kui see sisaldab numbrilisi väärtusi).\nVõtame kasutusele R-i andmesitku “mtcars”, kus on kokku 11 arvtunnust. Andmestik sisaldab 32 auto kohta infot (kütusekulu, silindrite arv, kaal jne). Loe andmesitku koha rohkem käivitades käsk ?mtcars.\n\ndata(mtcars)\n\n\n\n\n\n\n\nKirjeldusest (ehk ?mtcars vaadates) selgub, et tunnused “vs” ja “am” sisaldavad küll numbreid, kuid tegelikut tähistavad kategooriaid. Eemaldan need, alles jääb 9 tunnust.\n\n\n\n\nmtcars&lt;-mtcars|&gt;\n  select(-vs, -am)\nhead(mtcars)\n\n                   mpg cyl disp  hp drat    wt  qsec gear carb\nMazda RX4         21.0   6  160 110 3.90 2.620 16.46    4    4\nMazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02    4    4\nDatsun 710        22.8   4  108  93 3.85 2.320 18.61    4    1\nHornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44    3    1\nHornet Sportabout 18.7   8  360 175 3.15 3.440 17.02    3    2\nValiant           18.1   6  225 105 2.76 3.460 20.22    3    1\n\n\nTeeme käsuga cor() korrellatsioonimaatriksi.\n\ncor(mtcars)\n\n            mpg        cyl       disp         hp        drat         wt\nmpg   1.0000000 -0.8521620 -0.8475514 -0.7761684  0.68117191 -0.8676594\ncyl  -0.8521620  1.0000000  0.9020329  0.8324475 -0.69993811  0.7824958\ndisp -0.8475514  0.9020329  1.0000000  0.7909486 -0.71021393  0.8879799\nhp   -0.7761684  0.8324475  0.7909486  1.0000000 -0.44875912  0.6587479\ndrat  0.6811719 -0.6999381 -0.7102139 -0.4487591  1.00000000 -0.7124406\nwt   -0.8676594  0.7824958  0.8879799  0.6587479 -0.71244065  1.0000000\nqsec  0.4186840 -0.5912421 -0.4336979 -0.7082234  0.09120476 -0.1747159\ngear  0.4802848 -0.4926866 -0.5555692 -0.1257043  0.69961013 -0.5832870\ncarb -0.5509251  0.5269883  0.3949769  0.7498125 -0.09078980  0.4276059\n            qsec       gear       carb\nmpg   0.41868403  0.4802848 -0.5509251\ncyl  -0.59124207 -0.4926866  0.5269883\ndisp -0.43369788 -0.5555692  0.3949769\nhp   -0.70822339 -0.1257043  0.7498125\ndrat  0.09120476  0.6996101 -0.0907898\nwt   -0.17471588 -0.5832870  0.4276059\nqsec  1.00000000 -0.2126822 -0.6562492\ngear -0.21268223  1.0000000  0.2740728\ncarb -0.65624923  0.2740728  1.0000000\n\n\n\nKorrelatsioon paketiga corrplot\nKui on soov korrellatsioonimaatriksit kuvada välja, võib abi olla paketistcorrplot(Wei and Simko 2021).\n\nlibrary(corrplot)\n\ncorrplot 0.95 loaded\n\n\n\ncorrplot(cor(mtcars), \n         method=\"number\")\n\n\n\n\n\n\n\n\nNäeme, et väga tugevas seoses on cyl (silindrite arv) ja hp (hobujõud) 0.83. Mida rohkem silindreid, seda võimsam on auto. Tugev negatiivne korrellatsioon on cyl ja mpg (läbisõit miles/gallon ehk kui mitu miili ühe galloniga sõita saab) vahel. Mida rohkem silindreid, seda lühem on auto läbisõit.\n\ncorrplot(cor(mtcars), \n         method=\"circle\",\n1         type=\"lower\")\n\n\n1\n\nVaikimisi on “full”. Saab valida, kas kuvada joonisel alumine või ülemine “kolmnurk” matriksist.\n\n\n\n\n\n\n\n\n\n\n\n\ncorrplot(cor(mtcars), \n         method=\"shade\",\n         type=\"upper\",\n1         col=c(\"black\", \"white\", \"grey\"),\n2         addshade=\"all\",\n3         tl.col=\"black\")\n\n\n1\n\nSaab lisada vektori kujul värvid, mida joonisel kasutada. Kui on soov pöörata must-valgeks (printer-friendly).\n\n2\n\nMuudab ära taustavärvi triibuliseks, saab valida kas “all”, “positive” või “negative” arvud.\n\n3\n\nMuudab teksti värvi\n\n\n\n\n\n\n\n\n\n\n\n\ncorrplot(cor(mtcars), \n         method=\"color\",\n1         order=\"AOE\")\n\n\n1\n\nMuudab maatriksis tunnuste järjekorda\n\n\n\n\n\n\n\n\n\n\n\n\n\nKorrelatsioon paketiga Hmisc\nPaketiga Hmisc(Harrell Jr 2024) tuleb käsk rcorr(), mis vajab töötamiseks maatriksit. Mulle meeldib see pakett, sest lihtsasti saab kätte ka olulisuse tõenäosused.\n\nlibrary(Hmisc)\n\nVäljatrükk kuvab esmalt korrelatsioonikordajad, seejärel vastajate arvud (n=32) ja seejärel olulise tõenäosused. Puuduvad väärtused oskab käsk rcorr() ise eemaldada.\n\nrcorr(as.matrix(mtcars))\n\n       mpg   cyl  disp    hp  drat    wt  qsec  gear  carb\nmpg   1.00 -0.85 -0.85 -0.78  0.68 -0.87  0.42  0.48 -0.55\ncyl  -0.85  1.00  0.90  0.83 -0.70  0.78 -0.59 -0.49  0.53\ndisp -0.85  0.90  1.00  0.79 -0.71  0.89 -0.43 -0.56  0.39\nhp   -0.78  0.83  0.79  1.00 -0.45  0.66 -0.71 -0.13  0.75\ndrat  0.68 -0.70 -0.71 -0.45  1.00 -0.71  0.09  0.70 -0.09\nwt   -0.87  0.78  0.89  0.66 -0.71  1.00 -0.17 -0.58  0.43\nqsec  0.42 -0.59 -0.43 -0.71  0.09 -0.17  1.00 -0.21 -0.66\ngear  0.48 -0.49 -0.56 -0.13  0.70 -0.58 -0.21  1.00  0.27\ncarb -0.55  0.53  0.39  0.75 -0.09  0.43 -0.66  0.27  1.00\n\nn= 32 \n\n\nP\n     mpg    cyl    disp   hp     drat   wt     qsec   gear   carb  \nmpg         0.0000 0.0000 0.0000 0.0000 0.0000 0.0171 0.0054 0.0011\ncyl  0.0000        0.0000 0.0000 0.0000 0.0000 0.0004 0.0042 0.0019\ndisp 0.0000 0.0000        0.0000 0.0000 0.0000 0.0131 0.0010 0.0253\nhp   0.0000 0.0000 0.0000        0.0100 0.0000 0.0000 0.4930 0.0000\ndrat 0.0000 0.0000 0.0000 0.0100        0.0000 0.6196 0.0000 0.6212\nwt   0.0000 0.0000 0.0000 0.0000 0.0000        0.3389 0.0005 0.0146\nqsec 0.0171 0.0004 0.0131 0.0000 0.6196 0.3389        0.2425 0.0000\ngear 0.0054 0.0042 0.0010 0.4930 0.0000 0.0005 0.2425        0.1290\ncarb 0.0011 0.0019 0.0253 0.0000 0.6212 0.0146 0.0000 0.1290       \n\n\nSeda, kas maatrikseid salvestada eraldi objekti või mitte, sõltub muidugi sellest, mida saadud andmetega soov teha on. Kui corrplot paketti alla tõmmata ei taha, siis võib proovida jooniseid teha käsuga heatmap().\n\n1kor_mtcars&lt;-rcorr(as.matrix(mtcars))\n2heatmap(kor_mtcars$r)\n\n\n1\n\nSalvestab korrelatsioonimaatriksi eraldi objekti. Vaata väärtuseid `Environment` keskkonnas. Objekt sisaldab kolme listi (r, n ja P)1\n\n2\n\nJoonistab eraldi käsuga heatmapi kasutades objetki korrelatsioonikordajaid\n\n\n\n\n\n\n\n\n\n\n\nKorrastame joonist ja paneme tunnused sümmeetriliselt jooksma.\n\nheatmap(kor_mtcars$r,\n1        symm=TRUE)\n\n\n1\n\nPani tunnused sümmeetriliselt “jooksma”.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Seosed tunnuste vahel</span>"
    ]
  },
  {
    "objectID": "10-seosed-tunnustes.html#korr-pildis",
    "href": "10-seosed-tunnustes.html#korr-pildis",
    "title": "10  Seosed tunnuste vahel",
    "section": "10.4 Korrelatsiooni esitlemine pildis",
    "text": "10.4 Korrelatsiooni esitlemine pildis\n\n\n\n\n\n\nVaata ka jooniste tegemise peatükki.\n\n\n\nParim viis näidata korrelatsiooni on scatterplot joonise tüübiga. Käsk plot() saab enam-vähem ise aru, mida neist tunnustest pildina luua saab. Kui tunnuse tüübid on midagi muud kui numbrid, saab käsuga plot() teist-tüüpi joonise.\n\nplot(mtcars$mpg, mtcars$hp)\n\n\n\n\n\n\n\nFigure 10.1\n\n\n\n\n\nKäsuga pairs() saab teha korraga mitme tunnuse kohta ühine joonise.\n\nmtcars|&gt;\n  select(mpg, hp, wt, drat)|&gt;\n  pairs()\n\n\n\n\n\n\n\n\n\n\n\n\nHarrell Jr, Frank E. 2024. Hmisc: Harrell Miscellaneous. https://CRAN.R-project.org/package=Hmisc.\n\n\nSignorell, Andri. 2024. DescTools: Tools for Descriptive Statistics. https://CRAN.R-project.org/package=DescTools.\n\n\nWei, Taiyun, and Viliam Simko. 2021. R Package ’Corrplot’: Visualization of a Correlation Matrix. https://github.com/taiyun/corrplot.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Seosed tunnuste vahel</span>"
    ]
  },
  {
    "objectID": "10-seosed-tunnustes.html#footnotes",
    "href": "10-seosed-tunnustes.html#footnotes",
    "title": "10  Seosed tunnuste vahel",
    "section": "",
    "text": "r= korrelatsioonikordajad, n= vastajate arv, p=olulisuse tõenäosus↩︎",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Seosed tunnuste vahel</span>"
    ]
  },
  {
    "objectID": "11-keskmiste-vordlus.html",
    "href": "11-keskmiste-vordlus.html",
    "title": "11  Keskmiste võrdlus",
    "section": "",
    "text": "11.1 Eeltööd\nSee peatükk annab ülevaate, kuidas võrrelda R-is arvulise tunnuse väärtusi erinevate tunnuste või gruppide vahel ehk kuidas teha t-test-i, Kruskal-Wallise testi ja kuidas R-is teha diseprsioonianalüüsi.\nKasutan siin analüüsimeetodite tutvustamiseks Euroopa Sotsiaaluuringu (edaspidi ESS) andmeid, mis on kogutud Eesti inimeste kohta uuringu 10. voorus. Andmed on võimalik alla laadida ESS andmete portaalist. Siin peatükis olen teinud 10. voorust väljavõtte paari tunnuse kohta1.\nIga analüüs algab tunnustega tutvumisega. Vajadusel vaata peatükke:",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Keskmiste võrdlus</span>"
    ]
  },
  {
    "objectID": "11-keskmiste-vordlus.html#eeltööd",
    "href": "11-keskmiste-vordlus.html#eeltööd",
    "title": "11  Keskmiste võrdlus",
    "section": "",
    "text": "Andmestikust esmase ülevaate saamine\nTehniline töö tunnustega",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Keskmiste võrdlus</span>"
    ]
  },
  {
    "objectID": "11-keskmiste-vordlus.html#t-test",
    "href": "11-keskmiste-vordlus.html#t-test",
    "title": "11  Keskmiste võrdlus",
    "section": "11.2 T-test",
    "text": "11.2 T-test\n\n\n\n\n\n\nLugemissoovitus\n\n\n\nRootalu, K. (2014). T-test. K. Rootalu, V. Kalmus, A. Masso, ja T. Vihalemm (toim), Sotsiaalse analüüsi meetodite ja metodoloogia õpibaas. https://samm.ut.ee/t-test/\n\n\n\nOne-sample T-test\nOletame, et me uurime õnnelikuks olemist ja meil on mingi ettekujutus sellest, kui õnnelikud inimesed olla võiksid. Me teame, et ESS uuringus küsiti inimestelt õnnelikuks olemise kohta skaalal nullist kümneni (10=“väga õnnelik”).\nTunnus “happy” tähistab küsimust “Kui õnnelikuks Te kõike kokku võttes end peate?”\nVaatame tunnuse jaotust.\n\n\nCode\nsummary(andmed$happy)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  0.000   7.000   8.000   7.499   9.000  10.000       1 \n\n\nSaame teada, et keskmine hinnang on ürpris kõrge (7,5).\n\n\nCode\nboxplot(andmed$happy)\n\n\n\n\n\n\n\n\n\nMeie arvame aga, et Eesti inimesed on pigem “keskmiselt õnnelikud” ning ESS vastajate hulka sattusidki kõik need üksikud õnnelikud inimesed. Mingi ajalooline teadmine on, et tegelik õnnelikuse keskmine skoor kogu Eesti peale tuleb kusagil number 6 lähedal.\nTeeme t-testi käsuga t.test(), et teada saada kas meie oletus peab paika. Kui kindlad võime olla, et üldpopulatsiooni tegelik keskmine on võrdne kuuega ja kui me kordame küsitlust uue valimiga saame keskmiseks skooriks 6?\n\nt.test(andmed$happy,\n       mu=6)\n\n\n    One Sample t-test\n\ndata:  andmed$happy\nt = 33.787, df = 1540, p-value &lt; 2.2e-16\nalternative hypothesis: true mean is not equal to 6\n95 percent confidence interval:\n 7.412002 7.586052\nsample estimates:\nmean of x \n 7.499027 \n\n\nSaame teada, et meie oletus ei pea paika: “true mean is not equal to 6” ning saame väita 95% kindlusega, et tegelik keskmine skoor jääb vahemikku 7,4 kuni 7,6. \\(p\\) väärtus väga madal (\\(p\\) &lt; 0,00).\n\n\n\n\n\n\nSoovi korral saab salvestada testi tulemused eraldi objekti ja kasutada salvestatud infot kas edasises analüüsis või tulemuste esitlemisel. Objekti salvestatud infot saab vaadata käsuga attributes().\n\n\n\n\nttest&lt;-t.test(andmed$happy,\n       mu=6)\n\nattributes(ttest)\n\n$names\n [1] \"statistic\"   \"parameter\"   \"p.value\"     \"conf.int\"    \"estimate\"   \n [6] \"null.value\"  \"stderr\"      \"alternative\" \"method\"      \"data.name\"  \n\n$class\n[1] \"htest\"\n\n\nNäiteks soovin saada salvestatud objekti usaldusvahemikud.\n\nttest$conf.int\n\n[1] 7.412002 7.586052\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\nTwo-sided t-test\nNüüd ma soovin vaadata, kas mehed ja naised on sama õnnelikud ehk võrrelda kahe grupi vahel ühe numbrilise tunnuse jaotust.\nMa näen, et mehi ja naisi on enam-vähem sama palju ning mehed on pisut pessimistlikumalt vastanud.\n\n\nCode\nandmed|&gt;\n  drop_na(happy)|&gt;\n  group_by(gndr)|&gt;\n  summarise(vastajaid=n(),\n            kesk=round(mean(happy)),\n            sd=sd(happy))\n\n\n# A tibble: 2 × 4\n  gndr  vastajaid  kesk    sd\n  &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Mees        692     7  1.72\n2 Naine       849     8  1.76\n\n\n\n\n\n\n\n\nT-test eeltöö hulgas on vaja välja selgitada, kas standardhälve väärtused on kahe grupi puhul sarnased või erinevad. Seda saab teha ka käsuga aggregate().\n\n\n\n\naggregate(happy ~ gndr, andmed, sd)\n\n   gndr    happy\n1  Mees 1.718297\n2 Naine 1.756174\n\n\nStandardhälvete vahe on kahe grupi puhul peaaegu olematu ning seepärast kasutan t.test() käsu sees var.equal = TRUE. Pane tähele, et täpsustan käsu sees ka t-testi tüüpi.\n\nt.test(andmed$happy~andmed$gndr,\n1       alternative = \"two.sided\",\n2       var.equal=TRUE)\n\n\n1\n\nTäpsustab, millist t-testi teha\n\n2\n\nKui standardhälvete erinevus oleks suur, saaks panna TRUE asemel FALSE.\n\n\n\n\n\n    Two Sample t-test\n\ndata:  andmed$happy by andmed$gndr\nt = -2.277, df = 1539, p-value = 0.02293\nalternative hypothesis: true difference in means between group Mees and group Naine is not equal to 0\n95 percent confidence interval:\n -0.37754618 -0.02809936\nsample estimates:\n mean in group Mees mean in group Naine \n           7.387283            7.590106 \n\n\nTulemustest saame teada, et mehed ja naised hindavad enda õnnelikuse astet erinevalt ning 95% kindlusega saame öelda, et meeste keskmine hinnang õnnelikusele tuleb 0,38 kuni 0,03 punkti naiste omast madalam ( \\(p\\)&lt;0,05).\nTulemusi saab esitleda pildil, et näidata kui erinevad või sarnased keskmiste väärtused on.\n\n\nCode\npilt1&lt;-andmed|&gt;\n  drop_na(happy, gndr)|&gt;\n  ggplot(aes(happy,\n             fill=gndr))+\n  geom_boxplot(alpha=0.3)+\n  coord_flip()+\n  scale_x_continuous(breaks = c(2, 4, 6, 8))+\n  labs(x=\"\",\n       y=\"\")+\n  guides(fill=\"none\")+\n  theme_light()+\n  theme(axis.ticks = element_blank(),\n        axis.text = element_blank())+\n  scale_fill_viridis_d()\n\npilt2&lt;-andmed|&gt;\n  drop_na(happy, gndr)|&gt;\n  ggplot(aes(happy,\n             fill=gndr))+\n  geom_density(alpha=0.3)+\n  scale_x_continuous(breaks = c(2, 4, 6, 8))+\n  labs(title=\"Meeste ja naiste hinnangud\",\n       x=\"Õnnelikuse hinnang\",\n       y=\"\",\n       fill=\"Sugu\")+\n  theme_light()+\n  theme(axis.ticks = element_blank(),\n        axis.text = element_blank(),\n        legend.position = \"top\")+\n  scale_fill_viridis_d()\n\nlibrary(patchwork)\npilt2 | pilt1\n\n\n\n\n\n\n\n\n\n\n\nPaired T-test ehk paariviisiline t-test\nPaariviisilist t-testi saab kasutada siis, kui on soov võrrelda nt samade inimeste erinevate tunnuste keskmisi. Inimeste käest küsiti (tunnus “pplhlp”) “Mida Te arvate, kas enamuse ajast püüavad inimesed olla teiste suhtes abivalmid või hoolivad nad ennekõike iseendast?”\n0 = “Inimesed hoolivad ennekõike iseendast” ja 10 = “Inimesed püüavad enamasti teiste suhtes abivalmid olla”.\nMõnes-mõttes oleks loogiline arvata, et õnnelikud inimesed usuvad, et inimesed nende ümber on ilusad ja head. Eestis on päris õnnelikud inimesed ja nad võiks ka teisi inimesi usaldusväärseks pidada. Tunnuste omavahelisel võrdlemisel näeme, et vastajaid ei kipu uskuma, et inimesed püüavad enamasti teiste suhtes abivalmid olla.\n\nandmed|&gt;\n  select(happy, pplhlp)|&gt;\n  summary()\n\n     happy            pplhlp      \n Min.   : 0.000   Min.   : 0.000  \n 1st Qu.: 7.000   1st Qu.: 4.000  \n Median : 8.000   Median : 5.000  \n Mean   : 7.499   Mean   : 5.253  \n 3rd Qu.: 9.000   3rd Qu.: 7.000  \n Max.   :10.000   Max.   :10.000  \n NA's   :1        NA's   :2       \n\n\nSeda ei paista välja ka järgmisel pildil. Ka väga õnnelikud inimesed hindavad inimeste abivalmidust päris madalalt.\n\n\nCode\nandmed|&gt;\n  drop_na(happy, pplhlp, gndr)|&gt;\n  ggplot(aes(happy, pplhlp))+\n  geom_jitter(alpha=0.3, \n              aes(color=gndr))+\n  labs(title=\"Inimeste hinnangud õnnelikkusele ja teiste inimeste usaldusväärsusele\",\n       x=\"Õnnelikkuse hinnang\",\n       y=\"Inimesi saab usaldada hinnang\",\n       color=\"Sugu\")+\n  theme_minimal()+\n  scale_color_viridis_d()\n\n\n\n\n\n\n\n\n\nTeeme paariviisilise t-testi, et selgitada välja samade inimeste hinnangute erinevust. Peame käsu sees täpsustama testi tüüpi paired=TRUE.\n\nt.test(andmed$happy, andmed$pplhlp,\n  paired=TRUE)\n\n\n    Paired t-test\n\ndata:  andmed$happy and andmed$pplhlp\nt = 35.616, df = 1538, p-value &lt; 2.2e-16\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 2.125625 2.373401\nsample estimates:\nmean difference \n       2.249513 \n\n\nSaame teada, et võime 95% kindlusega saame väita, et hinnangud õnnelikkusele ja inimeste abivalmidusele ei ole sarnased. Ükskõik kui õnnelikud inimesed ise on, hindav nad enda õnnelikuks olemist 2,1 kuni 2,4 punkti kõrgemalt kui seda, et teised inimesed püüavad abivalmid olla.\n\n\n\n\n\n\nKeskmiste erinevus tunnuste vahel tuli välja juba tunnustega tutvumise etapis, kui kasutasin käsku summary(). paariviisiline t-test vaatab lisaks erinevuse olulisust.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Keskmiste võrdlus</span>"
    ]
  },
  {
    "objectID": "11-keskmiste-vordlus.html#anova",
    "href": "11-keskmiste-vordlus.html#anova",
    "title": "11  Keskmiste võrdlus",
    "section": "11.3 Anova - dispersioonianalüüs",
    "text": "11.3 Anova - dispersioonianalüüs\n\n\n\n\n\n\nLugemissoovitus\n\n\n\nTooding, L.-M. (2014). Dispersioonianalüüs. K. Rootalu, V. Kalmus, A. Masso, ja T. Vihalemm (toim), Sotsiaalse analüüsi meetodite ja metodoloogia õpibaas. https://samm.ut.ee/dispersioonanalyys/\n\n\nMõnikord on võrreldavaid gruppe rohkem kui kaks. Siis on sobilik teha keskmiste võrdluseks dispersioonianalüüs.\nVõib-olla hinnangute erinevus ei sõltugi vastaja soost, vaid sellest, kuidas ta ise oma sissetulekuga toime tuleb (tunnus “hincfel”)? Kas on võimalik, et paremal elujärjel olevad inimesed peavadki end õnnelikumaks kui inimesed, kellel on oma sissetulekute juures väga keeruline toime tulla? Kas saame öelda, et õnn peitub rahas?\nAndmestikus on kategoriaalne tunnus “hincfel”, mis annab aimu nende sissetulekute suuruse kohta. Inimestelt küsiti järgmist:\nMilline järgnevatest kirjeldustest vastab Teie arvates kõige paremini Teie leibkonna praegusele sissetulekute tasemele?\n\nElan /elame mugavalt praeguse sissetuleku juures\nSaame hakkama praeguse sissetuleku juures\nPraeguse sissetuleku juures on raske hakkama saada\nPraeguse sissetuleku juures on väga raske hakkama saada\n\n\n\nCode\nandmed$hincfel&lt;-fct_relevel(andmed$hincfel,\n                            \"Elame mugavalt praeguse sissetuleku juures\",\n                            \"Saame hakkama praeguse sissetuleku juures\",\n                            \"Praeguse sissetuleku juures on raske hakkama saada\",\n                            \"Praeguse sissetuleku juures on väga raske hakkama saada\")\n\n\nTesti eeltöö tähendab alati tunnustega tutvumist.\n\n\nCode\nandmed|&gt;\n  drop_na(happy)|&gt;\n  group_by(hincfel)|&gt;\n  summarise(vastajaid=n(),\n            kesk=round(mean(happy)),\n            sd=sd(happy))\n\n\n# A tibble: 4 × 4\n  hincfel                                                 vastajaid  kesk    sd\n  &lt;fct&gt;                                                       &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Elame mugavalt praeguse sissetuleku juures                    389     8  1.37\n2 Saame hakkama praeguse sissetuleku juures                     917     8  1.64\n3 Praeguse sissetuleku juures on raske hakkama saada            193     6  2.04\n4 Praeguse sissetuleku juures on väga raske hakkama saada        42     6  2.27\n\n\n\n\n\n\n\n\nPane tähele, et gruppide suurused on väga erinevad (42 vs 917).\nIdeaalsel juhul kodeeriks grupid ümber enam-vähem sama suureks, kuid praegu R-is töötamise näitamiseks las jääda nii. Lihtsalt pea meeles, et R ei tee sinu tööle kriitikat ja arvutab ikkagi seda, mida tal arvutada lased.\nTehniliselt oleks õigem teha Kurskal-Wallis test.\n\n\n\noneway.test() käsuga saab teha dispersioonianalüüsi, kus tuleb esmalt öelda sõltuv tunnus (“happy”) ja grupeeriv tunnus (“hincfel”).\n\noneway.test(andmed$happy~andmed$hincfel)\n\n\n    One-way analysis of means (not assuming equal variances)\n\ndata:  andmed$happy and andmed$hincfel\nF = 48.601, num df = 3.00, denom df = 169.57, p-value &lt; 2.2e-16\n\n\nSaame teada, et sissetuleku hinnangu järgi ei ole hinnang õnnelikkusele ühesugune ja seda, et erinevus on statistiliselt oluline. Kahjuks gruppide erinevust selle käsuga ei näe.\nVõimalus oleks teha käsuga aov() ja seejärel teha post-hoc test. Post-hoc testi saab teha siin käsuga TukeyHSD()\nTukeyHSD() esitab analüüsitulemused neljas grupis:\n\n“diff” - gruppide keskmine erinevus\n“lwr” - usalduspiiri alumine väärtus\n“upr” - usalduspiiri ülemine väärtus\n“p adj” - olulisuse tõenäosus Tulemuste lugemist tasub alustada viimasest rühmast, kus on näha, et statitstiline oluline erinevus on peaaegu kõigi gruppide vahel (v.a nee kellel on raske või väga raske toime tulla).\n\n\naov(happy~hincfel, andmed)|&gt;\n  summary()\n\n              Df Sum Sq Mean Sq F value Pr(&gt;F)    \nhincfel        3    474  158.06   57.88 &lt;2e-16 ***\nResiduals   1537   4197    2.73                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n1 observation deleted due to missingness\n\n\n\n\n\n\n\n\nJärgnev väljatükk aitab ilmekalt selgitada, miks ei ole hea tunnuste kategooriatele ülipikki nimesid panna. Väljatrükki oleks lihtsam lugeda, kui kategooriate nimed oleks lühemad.\n\n\n\n\nTukeyHSD(aov(happy~hincfel, andmed))\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = happy ~ hincfel, data = andmed)\n\n$hincfel\n                                                                                                                 diff\nSaame hakkama praeguse sissetuleku juures-Elame mugavalt praeguse sissetuleku juures                       -0.6376499\nPraeguse sissetuleku juures on raske hakkama saada-Elame mugavalt praeguse sissetuleku juures              -1.6672350\nPraeguse sissetuleku juures on väga raske hakkama saada-Elame mugavalt praeguse sissetuleku juures         -2.2681479\nPraeguse sissetuleku juures on raske hakkama saada-Saame hakkama praeguse sissetuleku juures               -1.0295851\nPraeguse sissetuleku juures on väga raske hakkama saada-Saame hakkama praeguse sissetuleku juures          -1.6304980\nPraeguse sissetuleku juures on väga raske hakkama saada-Praeguse sissetuleku juures on raske hakkama saada -0.6009129\n                                                                                                                  lwr\nSaame hakkama praeguse sissetuleku juures-Elame mugavalt praeguse sissetuleku juures                       -0.8948038\nPraeguse sissetuleku juures on raske hakkama saada-Elame mugavalt praeguse sissetuleku juures              -2.0414223\nPraeguse sissetuleku juures on väga raske hakkama saada-Elame mugavalt praeguse sissetuleku juures         -2.9584197\nPraeguse sissetuleku juures on raske hakkama saada-Saame hakkama praeguse sissetuleku juures               -1.3661580\nPraeguse sissetuleku juures on väga raske hakkama saada-Saame hakkama praeguse sissetuleku juures          -2.3011249\nPraeguse sissetuleku juures on väga raske hakkama saada-Praeguse sissetuleku juures on raske hakkama saada -1.3245347\n                                                                                                                  upr\nSaame hakkama praeguse sissetuleku juures-Elame mugavalt praeguse sissetuleku juures                       -0.3804960\nPraeguse sissetuleku juures on raske hakkama saada-Elame mugavalt praeguse sissetuleku juures              -1.2930477\nPraeguse sissetuleku juures on väga raske hakkama saada-Elame mugavalt praeguse sissetuleku juures         -1.5778760\nPraeguse sissetuleku juures on raske hakkama saada-Saame hakkama praeguse sissetuleku juures               -0.6930122\nPraeguse sissetuleku juures on väga raske hakkama saada-Saame hakkama praeguse sissetuleku juures          -0.9598711\nPraeguse sissetuleku juures on väga raske hakkama saada-Praeguse sissetuleku juures on raske hakkama saada  0.1227088\n                                                                                                               p adj\nSaame hakkama praeguse sissetuleku juures-Elame mugavalt praeguse sissetuleku juures                       0.0000000\nPraeguse sissetuleku juures on raske hakkama saada-Elame mugavalt praeguse sissetuleku juures              0.0000000\nPraeguse sissetuleku juures on väga raske hakkama saada-Elame mugavalt praeguse sissetuleku juures         0.0000000\nPraeguse sissetuleku juures on raske hakkama saada-Saame hakkama praeguse sissetuleku juures               0.0000000\nPraeguse sissetuleku juures on väga raske hakkama saada-Saame hakkama praeguse sissetuleku juures          0.0000000\nPraeguse sissetuleku juures on väga raske hakkama saada-Praeguse sissetuleku juures on raske hakkama saada 0.1422913",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Keskmiste võrdlus</span>"
    ]
  },
  {
    "objectID": "11-keskmiste-vordlus.html#kruskal",
    "href": "11-keskmiste-vordlus.html#kruskal",
    "title": "11  Keskmiste võrdlus",
    "section": "11.4 Kruskal-Wallis test",
    "text": "11.4 Kruskal-Wallis test\nKruskal-Wallis test võrdleb keskmiste astak-uid ning sobib kasutada olukordades, kus võrreldavad grupid ei ole ühesuurused. Käsk kruskal.test() toimib põhimõttel, et vajab esmalt sõltuvat ja seejärel grupeerivat tunnust. Andmestiku nimi tuleb öelda koma järel.\n\nkruskal.test(happy~hincfel, andmed)\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  happy by hincfel\nKruskal-Wallis chi-squared = 135.81, df = 3, p-value &lt; 2.2e-16\n\n\nKruskal-Wallise test näitab, et gruppide vahel on statistiliselt olulised erinevused. Hii-ruut statistik on 19.1 ja \\(p\\)&lt;0,01.\n\nKruskal-Wallis test paketiga PMCMRplus\nPaketiga MPCMPRplus (Pohlert 2023) saab teha Kruskal-Wallis testi (käsk kruskalTest().\n\nlibrary(PMCMRplus)\n\n\n\n\n\n\n\nTest ei õnnestu kui grupeeriv tunnus ei ole faktor. Vaata ka, kuidas tunnuseid ringi kodeerida.\n\n\n\n\nandmed$hincfel&lt;-as_factor(andmed$hincfel)\n\n\nkruskalTest(happy~hincfel, andmed)\n\nWarning in kruskalTest.default(c(8, 7, 8, 10, 7, 8, 7, 7, 7, 8, 10, 6, 8, :\nTies are present. Quantiles were corrected for ties.\n\n\n\n    Kruskal-Wallis test\n\ndata:  happy by hincfel\nchi-squared = 135.81, df = 3, p-value &lt; 2.2e-16",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Keskmiste võrdlus</span>"
    ]
  },
  {
    "objectID": "11-keskmiste-vordlus.html#keskmine-pildis",
    "href": "11-keskmiste-vordlus.html#keskmine-pildis",
    "title": "11  Keskmiste võrdlus",
    "section": "11.5 Keskmiste võrdluse esitlemine pildis",
    "text": "11.5 Keskmiste võrdluse esitlemine pildis\nKeskmiste võrdluse esitlemiseks sobib joonisena karp-diagramm, sest tegemist on sisuliselt ju numbrilise tunnuse esitlemisega.\nBaaskäsk boxplot() ajaks justkui asja ära, kuid antud hetkel ei mahuta kõikide gruppide nimesid joonisele.\n\nboxplot(andmed$happy~andmed$hincfel)\n\n\n\n\n\n\n\n\nKarpdiagrammi miinuseks on see, et gruppide suurusest jääb ekslik mulje nagu need oleks võrdsed.\nÜks võimalus oleks esitleda keskmiste erinevust gruppide vahel nii, et lisada sinna ka vastajaid kujutavad täpikesi. Pilt nüüd kauniks kunstiväärtuseks ei läinud, kuid annab vaatluse all oleva situatsiooni kohta veidi paremini infot edasi.\n\n\nCode\nandmed|&gt;\n  ggplot(aes(x=hincfel, y=happy))+\n  geom_jitter(alpha=0.4, aes(color=gndr))+\n  geom_boxplot(alpha=0.4)+\n  ggtitle(\"Hinnang õnnelikkusele sissetuleku hinnangu järgi\")+\n  labs(color=\"Sugu\")+\nscale_x_discrete(labels=c(\"Elame mugavalt\", \"Saame hakkama\", \"Raske on\", \"Väga raske on\"))+\n  ylab(NULL)+\n  xlab(NULL)+\n  theme_minimal()+\n  scale_color_viridis_d()\n\n\n\n\n\n\n\n\n\nTeinekord tasub esitleda tulemusi ka density joonisega.\n\n\nCode\nandmed|&gt;\n  drop_na(happy, hincfel)|&gt;\n  ggplot(aes(x=happy, fill=hincfel))+\n  geom_density(alpha=0.4)+\n  labs(title=\"Hinnang õnnelikkusele sissetuleku hinnangu järgi\",\n       x=\"Õnnelikkuse hinnang\",\n       y=\"\",\n       fill=\"Sissetuleku hinnang\")+\n  theme_minimal()+\n  theme(legend.position = c(.35, .75))+\n  scale_fill_viridis_d()\n\n\nWarning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n3.5.0.\nℹ Please use the `legend.position.inside` argument of `theme()` instead.\n\n\n\n\n\n\n\n\n\n\n\n\n\nPohlert, Thorsten. 2023. PMCMRplus: Calculate Pairwise Multiple Comparisons of Mean Rank Sums Extended. https://CRAN.R-project.org/package=PMCMRplus.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Keskmiste võrdlus</span>"
    ]
  },
  {
    "objectID": "11-keskmiste-vordlus.html#footnotes",
    "href": "11-keskmiste-vordlus.html#footnotes",
    "title": "11  Keskmiste võrdlus",
    "section": "",
    "text": "Kui soovid sama andmestikuga harjutusi järele teha, lae andmestik nimega “ESS_10_valik.csv” alla siit.↩︎",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Keskmiste võrdlus</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html",
    "href": "12-regressioon-lineaarne.html",
    "title": "12  Regressioon - lineaarne",
    "section": "",
    "text": "12.1 Lihtne lineaarne regressioon\nSee peatükk annab ülevaate, kuidas teha lineaarset regressioonimudelit. Esmalt teen näite lihtsa (simple linear regression) ja hiljem mitmese (multiple linear regression) lineaarse regressooni kohta. Regressioonimudelid saab kätte R-i baasversiooniga, tidyverse paketti läheb vaja jooniste tegemisel.\nKasutan Euroopa Sotsiaaluuringu (edaspidi ESS) andmeid, mis on kogutud Eesti inimeste kohta uuringu 10. voorus. Andmed on võimalik alla laadida ESS andmete portaalist. Siin peatükis olen teinud 10. voorust väljavõtte paari tunnuse kohta1.\nLihtne lineaarne regressioon vajab vaid kahte numbrilist tunnust.\nlibrary(tidyverse)\nandmed&lt;-read_csv(\"ESS_10_valik.csv\")\nandmed&lt;-andmed|&gt;\n    mutate(across(where(is.character), as.factor))\nEuroopa sotsiaaluuringu (ESS) andmestikus on meil kasutada mõned numbrilised tunnused.\nCode\nandmed|&gt;\n  ggplot(aes(agea, netustm))+\n  geom_point() + \n1  geom_smooth(method=lm) +\n  theme_bw()+\n  labs(x=\"vanus\",\n       y=\"interneti kasutusaeg minutites\")\n\n\n\n1\n\nKui on soov joonelt saada ära hall taust, tuleb lisada “se =F”\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\nEi ütleks, et siin on just midagi väga selgelt eristuvat lineaarset joont. Vanuse kasvades langeb interneti kasutusaeg.\nSellegi poolest teeme lineaarse regressioonimudeli, mille abil püüame prognoosida interneti kasutuse minuteid inimese vanuse põhjal. Mudeli tegemine käib baasversiooni käsuga lm() ning mudeli ülevaate saamine käsuga summary().\nPane tähele, et tunnuste nimed tuleb öelda eraldi ja alles lõpus täpsustada, millisest andmestikust tunnused võtta tuleb.\nmudel1&lt;-lm(netustm ~ agea, data=andmed)\nsummary(mudel1)\n\n\nCall:\nlm(formula = netustm ~ agea, data = andmed)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-340.9 -141.2  -51.3  105.1 1188.9 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 450.5913    16.3527   27.55   &lt;2e-16 ***\nagea         -3.9898     0.3358  -11.88   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 187.7 on 1185 degrees of freedom\n  (355 observations deleted due to missingness)\nMultiple R-squared:  0.1064,    Adjusted R-squared:  0.1057 \nF-statistic: 141.2 on 1 and 1185 DF,  p-value: &lt; 2.2e-16\noptions(scipen=999)",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#lihtne-lineaarne-regressioon",
    "href": "12-regressioon-lineaarne.html#lihtne-lineaarne-regressioon",
    "title": "12  Regressioon - lineaarne",
    "section": "",
    "text": "agea - vanus (aastates)\nnwspol - inimeste uudiste jälgmise aeg (minuteid päevas). Küsimus: Kui palju aega umbes veedate te tavalisel päeval, vaadates, lugedes või kuulates poliitika- ja päevakajalisi uudiseid?\nnetustm - interneti kasutamise aeg (minuteid päevas). Kui palju aega umbes veedate te tavalisel päeval arvutis, tahvelarvutis, nutitelefonis või muus seadmes internetti kasutades, olgu siis töö jaoks või isiklikuks otstarbeks?\n\n\n\n\n\n\n\n\n\n\n\n\n\nKui ei soovi saada teaduslikku kirjapilti olulisuse tõenäosuse kohta mudeli väljatrükis, siis käivta kood options(scipen=999) ning telli väljatrükk uuesti.\n\n\n\n\n\n\n\n\n\n\nKiirem viis mudelist kohe tulemus saada on “piping” |&gt; kaudu. Sellega ei teki aga võimalust kasutada predict() funktsiooni või luua automaatseid pilte mudelist mudeli headuse hindamiseks.\n\nlm(netustm ~ agea, data=andmed)|&gt;\n  summary()\n\n\nCall:\nlm(formula = netustm ~ agea, data = andmed)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-340.9 -141.2  -51.3  105.1 1188.9 \n\nCoefficients:\n            Estimate Std. Error t value            Pr(&gt;|t|)    \n(Intercept) 450.5913    16.3527   27.55 &lt;0.0000000000000002 ***\nagea         -3.9898     0.3358  -11.88 &lt;0.0000000000000002 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 187.7 on 1185 degrees of freedom\n  (355 observations deleted due to missingness)\nMultiple R-squared:  0.1064,    Adjusted R-squared:  0.1057 \nF-statistic: 141.2 on 1 and 1185 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n\n\n\n\n\n\n\n\nMudelitest parema ülevaate saamiseks soovitan kasutada mõnda muud paketti kui baaskäsku summary(). Vaata näidist alapeatükist Regressioonimudeli tulemuste esitlemine.\n\n\n\n\nMudeli tõlgendamine\n(Intercept) rida on nn teoreetiline ja näitab seda, millal y telg ristub x teljega. Päriselus taolist olukorda ei teki kunagi, sest kui inimese vanus on 0 (ehk pole sündinudki), siis on ka tema interneti kasutusminutite aeg 0.\nagea on -3.9898, standardhälve 0.3358 ning t value (-11.88). Rea lõpus on p väärtus, mis on madal. Mudel oleks justkui hea, sest vanuse tunnus paistab olevat statiliselt olulise väärtusega.\nKuna meil on simple linear regression, siis vaatame Multiple R-Squared: 0,1064 ehk 0,11 ehk 11% inimese interneti kasutamisajast saame seletada tema vanuse kaudu. Mitte just vapustavalt tugev mudel.\nF-statistic: 141.2 ja \\(p&lt;0.05\\). Tegemist on statistiliselt olulise väärtusega.\n\n\nMudeli kasutamine prognoosimiseks\nMudeli kasutamine prognoosiks käib käsu predict() abil. Käsk predict() töötab andmestikuga. Teen esmalt andmestiku “test”, kus on sama moodi tunnus “agea”. Lasen vanuse põhjal prognoosida kui kaua need inimesed keskmiselt kasutaks interneti.\n\n1test&lt;-data.frame(agea=c(13, 18, 32, 28, 66))\n\n2predict(mudel1, test)\n\n\n1\n\nloon andmestiku sama tunnusega\n\n2\n\nkasutan mudelit ja andmestiku, et saada prognoositulemuste vastus\n\n\n\n\n       1        2        3        4        5 \n398.7232 378.7740 322.9161 338.8755 187.2612 \n\n\n13-aastane inimene mudeli prognoosi kohaselt kasutaks internetis päevas 399 minutit ja 66-aastane inimene keskmiselt 187 minutit.\n\n\n\n\n\n\nKui tahad vaadata ainult konkreetset näitaja tulemust, siis kasuta data.frame() käsku predict() sees.\n\npredict(mudel1, data.frame(agea=25))\n\n      1 \n350.845",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#mudeli-elementide-kasutamine",
    "href": "12-regressioon-lineaarne.html#mudeli-elementide-kasutamine",
    "title": "12  Regressioon - lineaarne",
    "section": "12.2 Mudeli elementide kasutamine",
    "text": "12.2 Mudeli elementide kasutamine\nPraegu oleme teinud mitu mudelit ja salvestanud selle enivroment keskkonda. Lihtne mudel sisaldab 13 elementi ja mitmene 14. Nende elementide nägemiseks kasuta käsku names().\n\nnames(mudel1)\n\n [1] \"coefficients\"  \"residuals\"     \"effects\"       \"rank\"         \n [5] \"fitted.values\" \"assign\"        \"qr\"            \"df.residual\"  \n [9] \"na.action\"     \"xlevels\"       \"call\"          \"terms\"        \n[13] \"model\"        \n\n\nOletame, et soovime väljatrükis saada ainult regressioonikordajad. Selleks saame kasutada elemendi nime lisada sulgudesse mudel.\n\ncoefficients(mudel1)\n\n(Intercept)        agea \n  450.59128    -3.98985 \n\n\nRegressioonikordajate 95% usaldusvahemiku saab käsuga confint() ja täpsutus level=. (NB! Ilma täpsustuseta ongi vaikimisi väärtus 0.95 ning seda eraldi kirjutama ei peaks).\n\nconfint(mudel1, level = 0.95)\n\n                 2.5 %     97.5 %\n(Intercept) 418.507804 482.674748\nagea         -4.648724  -3.330976\n\n\nIga inimese prognoositud väärtusi saab tellida käsuga fitted() ja prognoosijäägid käsuga residuals().\n\nfitted(mudel1)|&gt;\n  head()\n\n       1        2        3        4        5        6 \n322.9161 223.1698 374.7841 199.2307 127.4134 235.1394 \n\n\n\nresiduals(mudel1)|&gt;\n  head()\n\n         1          2          3          4          5          6 \n-142.91608 -163.16984  105.21587  -79.23074  -67.41344   64.86061 \n\n\nMudelit ennast saab kasutada dispersioonianalüüsi läbiviimiseks.\n\n#anova(mudel1)\n\nMudeli headuse näitajad saab kätte käsuga AIC() ja BIC() . Lühidalt mida väiksem väärtus, seda parem mudel.\n\nAIC(mudel1)\n\n[1] 15800.5\n\n\n\nBIC(mudel1)\n\n[1] 15815.74",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#plot-lm",
    "href": "12-regressioon-lineaarne.html#plot-lm",
    "title": "12  Regressioon - lineaarne",
    "section": "12.3 Joonised mudeli hindamiseks",
    "text": "12.3 Joonised mudeli hindamiseks\nMudeli tulemuste jooniste tegemiseks vaata alapeatükki Regressioonimudeli tulemuste visualiseerimine.\nMudelist kiirjooniste saamine käib käsuga plot(). Kui on soov ruumi kokku hoida, saab käsuga par() täpsutada, et väljatrükk tuleks 2 reas ja 2 tulbas.\n\npar(mfrow=c(2,2))\nplot(mudel1)\n\n\n\n\n\n\n\n\nLineaarse mudeli eelduseks on tunnuste omavaheline lineaarne seos. Lisaks on eeldus, et prognoosijäägid (residuaalid) on normaaljaotusega, neil puudub kindel muster ning on sõltumatud.\nNende piltide põhjal saab teha suurema osa järeldusi. Jooniselt residual vs fitted kuvatakse prognoosijääke tunnuse prognoositud väärtustega võrreldes. Sel pildil ei tahaks näha mustrit ning sooviks, et punktid mõlemal pool joont nn “suvaliselt laiali”. Sellega veenduks lineaarses seoses.\nResiduaalide normaaljaotuses saaks vaadata joonise q-q residual kaudu, millelt tahaks näha kõiki täpikesi pigem joone peal lineaarselt liikumas.\nResiduaalide normaaljaotuse nägemiseks saaks tellida käskude hist() ning residuals() ühendamisel.\n\nhist(residuals(mudel1))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIgasugune piltide põhjal hinnangu andmine on siiski subjektiivne. Kindluse mõttes tasub mudeli eelduste täituvuse kohta teha eraldi testid.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#testid-mudeli-hindamiseks",
    "href": "12-regressioon-lineaarne.html#testid-mudeli-hindamiseks",
    "title": "12  Regressioon - lineaarne",
    "section": "12.4 Testid mudeli hindamiseks",
    "text": "12.4 Testid mudeli hindamiseks\n\n\n\n\n\n\nNeed testid sobivad lihtsa ja mitmese regresioonimudelite hindamiseks.\n\n\n\nMudeli headuse hindamine käib paketi lmtest (Zeileis and Hothorn 2002) käsu harvtest() abil.\n\nlibrary(lmtest)\n\nKäsuga harvtest() testime null-hüpoteesi, milleks on mudeli tunnuste vahel on lineaarne seos.\n\n\n\n\n\n\nTulemuse tõlgendamine on siin teistsugune kui tavaliselt. Kui p-väärtus on väiksem kui 0,05 peaksime hülgama null-hüpoteesi. See tähendaks, et tunnuste vahel ei ole lineaarset seost ning lineaarset regressioonimudelit teha ei sobiks. See on üks väheseid kordi, kus soovime suurt p-väärtust.\n\n\n\n\nharvtest(mudel1)\n\n\n    Harvey-Collier test\n\ndata:  mudel1\nHC = 0.516, df = 1184, p-value = 0.606\n\n\nKäsuga shapiro.test() saab vaadata, kas residuaalide osas on normaaljaotus. Loodame näha suuremat p-d.\n\nshapiro.test(residuals(mudel1))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(mudel1)\nW = 0.91183, p-value &lt; 0.00000000000000022\n\n\nAntud juhul test kinnitab, et eeltingimus regressioonijääkide normaaljaotuse osas pole täidetud.\nKäsuga pbtest() saab testida homoskedastilisust (null-hüpotees). Taaskord loodame näha, et p-väärtus on suurem kui 0,05.\n\nbptest(mudel1)\n\n\n    studentized Breusch-Pagan test\n\ndata:  mudel1\nBP = 2.8303, df = 1, p-value = 0.0925\n\n\nViimane on residuaalide sõltumatuse testimine. Selleks läheb vaja paketti car (Fox and Weisberg 2019) ja käsku dubrinWatsonTest().\n\nlibrary(car)\n\ndubrinWatsonTest() käsu väljatrükis tuleb vaadata p-väärtuse asemel D-W statistiku väärtust. Regressioonijäägid on sõltumatud kui D-W statistiku väärtus on lähedal numbrile 2. Antud juhul siis sõltumatud2.\n\ndurbinWatsonTest(mudel1)\n\n lag Autocorrelation D-W Statistic p-value\n   1     -0.02771863      2.054784   0.346\n Alternative hypothesis: rho != 0\n\n\nMitme seletava tunnusega lineaarse regressioonimudel tegemisel peab mõtlema ka kolineaarsuse peale. Vaata selle testimist alapeatükist Multikollineaarsuse hindamine.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#mitmene-regressioon",
    "href": "12-regressioon-lineaarne.html#mitmene-regressioon",
    "title": "12  Regressioon - lineaarne",
    "section": "12.5 Mitmene regressioon",
    "text": "12.5 Mitmene regressioon\nMitmene regressioon on sarnane lihtsale, aga sõltumatuid tunnuseid on rohkem kui üks.\n\n\n\n\n\n\nMa ei tee fookuse hoidmiseks mudeli hindamise teste ning liigume siin peatükis edasi nii, nagu oleks kõik tunnuste eelduste kontroll läbitud.\n\n\n\nESS andmestikus on meil teada lisaks vanusele ka vastaja sugu (gndr). Me võime proovida selgitada inimeste internetis kasutamisaega läbi nende soo.\nKas mehed ja naised veedavad internetis aega erinevalt?\n\n\nCode\nandmed|&gt;\n  drop_na(agea, netustm)|&gt;\n  ggplot(aes(agea, netustm, color=gndr))+\n  geom_point()+\n  geom_smooth(method = lm)+\n  theme_bw()+\n  labs(x=\"Vanus\",\n       y=\"Interneti kasutusaeg minutites\",\n       color=\"Sugu\")+\n  scale_color_viridis_d()\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nJooniselt on näha, et ega soo tunnus väga suurt erinevust pilti sisse ei too. Ilmselt ei tasu oodata ka, et meeste ja naiste keskmise internetikasutusaja võrdlus näitaks statistliselt olulist erinevust.\nMitmese regrssiooni tegemine käib sama käsuga lm(), tunnuste lisamine mudelisse käib + märgiga.\n\nmudel2&lt;-lm(netustm~ agea + gndr,  data= andmed)\n\nsummary(mudel2)\n\n\nCall:\nlm(formula = netustm ~ agea + gndr, data = andmed)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-334.37 -140.49  -51.65  106.76 1183.13 \n\nCoefficients:\n            Estimate Std. Error t value            Pr(&gt;|t|)    \n(Intercept) 445.0680    16.9909  26.194 &lt;0.0000000000000002 ***\nagea         -4.0267     0.3372 -11.942 &lt;0.0000000000000002 ***\ngndrNaine    13.1354    10.9954   1.195               0.232    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 187.7 on 1184 degrees of freedom\n  (355 observations deleted due to missingness)\nMultiple R-squared:  0.1075,    Adjusted R-squared:  0.106 \nF-statistic: 71.32 on 2 and 1184 DF,  p-value: &lt; 0.00000000000000022\n\n\n\nMitmese regressioonimudeli tõlgendamine\nMudeli selgitusvõime ootuspäraselt eriti ei paranenud.Väljatrükk kuvab meile interneti kasutusaja puhul vaid ühte tunnuse väärtust (gndrNaine). Taustakategooria see, mida me ei näe ehk kategooria “Mees”. Kuna nüüd on kasutusel mitmene lineaarne regression, siis tuleb vaadata Multiple R-squared asemel Adjusted R-squared väärtust (0,106). See tähendab, et umbes 11% interneti kasutusest saame selgitada inimese vanuse ja soo kaudu.\nSee tähendab seda, et vanuse kasvades langeb iga aastaga interneti kasutusaeg -4,0267 minutit ning naiseks olemine annab kasutusajale juurde 13,1354 minutit. Ehk, kui me enne predict()käsuga ennustasime, et 13-aastane inimene veedab internetis aega 399 minutit. Siis praegu, kui me oletame, et tegemist on naisega, siis veedab ta internetis aega \\(445.0680+(-4.0267*13)+13.1354 = 405.8563\\) minutit.\nLisame testandmestikule vektori soo tunnusega ning kasutame seda prognoosimudelis. Esimene inimene on 13-aastane naine ja saame tema kasutusajaks sama tulemuse.\n\ntest$gndr&lt;-c(\"Naine\", \"Mees\", \"Mees\", \"Naine\", \"Naine\")\n\npredict(mudel2, test)\n\n       1        2        3        4        5 \n405.8563 372.5874 316.2136 345.4558 192.4413 \n\n\n\n\n\n\n\n\nMudelite põhjal igasuguse järelduste tegemisel peab olema ettevaatlik. Vanus ei põhjusta interneti kasutamise vähenemist. Võib-olla tulevikus kui kõik inimesed on üles kasvanud koos internetiga, on selle kasutusaeg igas põlvkonnas täpselt ühesugune.\n\n\n\nSalvestan praegu prognoositulemuse andmestikku, et seda hiljem tulemuste esitlemisel kasutada. Vaata alapeatükki Regressioonimudeli tulemuste visualiseerimine.\n\n\n\n\n\n\nPane tähele, et nüüd kasutame predict() käsu sees täpsustust newdata= mitte data=.\n\n\n\n\nandmed$prognoos_net&lt;-predict(mudel2, newdata = andmed)\n\n\n\nMitu seletavat tunnust mudelis\nMuudame kurssi ja vaatame taaskord inimese õnnelikuks olemist. Keskmiste võrdluse tegemisel oli näha, et need kes sissetulekute poolest hindasid end “elame mugavalt praeguse sissetuleku juures” hindasid end ka keskmiselt õnnelikumaks kui need, kelle hinnang oma sissetuleku kohta oli “Praeguse sissetuleku juures on väga raske hakkama saada”. Tavaliselt noortel raha eriti pole, eakamad inimesed on jõudnud elu jooksul omale soetada vara (elupaik, autod jms).\nUurime, kas eakamad inimesed on õnnelikumad, sest neil on rohkem raha? Lisaks vaatame, kas õnn peitub ainult rahas või sotsiaalsetes suhtes. Sõprade olemasolu mõõdeti küsimusega: Kui palju on inimesi, kui üldse on, kellega saate arutada oma isiklikke ja intiimseid asju?\nTunnus inprdsc ja kategooriad: “Mitte ühtegi”, “1”, “2”, “3”, “4-6”, “7-9” ja “10 või enam”. Teeme tunnuse ringi väiksemateks katoogriateks (vajadusel loe juurde töö faktoritega peatükki.\n\n\nCode\nandmed$sobrad&lt;-fct_collapse(andmed$inprdsc,\n                            \"Vähe\" = c(\"Mitte ühtegi\",\"1\"),\n                            \"Mõned\"= c(\"2\", \"3\"),\n                            \"Palju\"=c(\"4-6\" ,\"7-9\", \"10 või enam\"))\nandmed$sobrad&lt;-fct_relevel(andmed$sobrad, c(\"Vähe\", \"Mõned\", \"Palju\"))\n\n\n\n\nCode\nandmed$hincfel&lt;-fct_relevel(andmed$hincfel,\n                            \"Elame mugavalt praeguse sissetuleku juures\",\n                            \"Saame hakkama praeguse sissetuleku juures\",\n                            \"Praeguse sissetuleku juures on raske hakkama saada\",\n                            \"Praeguse sissetuleku juures on väga raske hakkama saada\")\n\n\nNüüd näeme jooniselt, et inimesed on igas vanuses õnnelikumad, kui neil on palju sõpru. Noorematel inimestel tundub kollaseid täpikesi (st=palju sõpru) olema rohkem kui eakamatel.\n\n\nCode\nandmed|&gt;\n  drop_na(agea, happy, sobrad)|&gt;\n  ggplot( aes(agea, happy))+\n  geom_jitter(aes(color=sobrad),\n              alpha=0.4)+\n  geom_smooth(method=\"lm\",\n              aes(color=sobrad))+\n  labs(title=\"Inimesed on igas vanuses õnnelikumad kui neil on palju sõpru\",\n       x=\"Vanus\",\n       y=\"Hinnang õnnelikusele\",\n       color=\"Sõbrad\",\n       shape=\"Sugu\")+\n  theme_bw()+\n  scale_color_viridis_d()\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nKasutame nüüd samu andmeid prognoosimudelites ning lisame seletavaid tunnuseid juurde + märgiga juurde. Pane tähele, et kirjutan varemloodud mudelid 1 ja 2 praegu üle.\n\nmudel1 &lt;- lm(happy ~ agea, data=andmed)\nsummary(mudel1)\n\n\nCall:\nlm(formula = happy ~ agea, data = andmed)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.5936 -0.9066  0.2784  1.1930  3.0468 \n\nCoefficients:\n             Estimate Std. Error t value             Pr(&gt;|t|)    \n(Intercept)  8.233957   0.129667  63.501 &lt; 0.0000000000000002 ***\nagea        -0.014231   0.002363  -6.023        0.00000000214 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.722 on 1539 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.02303,   Adjusted R-squared:  0.02239 \nF-statistic: 36.28 on 1 and 1539 DF,  p-value: 0.000000002138\n\n\n2% inimese õnnelikkuse hinnangust saame seletada tema vanuse järgi.\n\nmudel2 &lt;- lm(happy ~ agea + hincfel, data=andmed)\nmudel3 &lt;- lm(happy ~ agea + hincfel + gndr, data=andmed)\nmudel4 &lt;- lm(happy ~ agea + hincfel + gndr + sobrad, data=andmed)\n\nJätan praegu väljatrükid summary() käsuga tellimata, sest mitme mudeli väljatrükk on kohmakas, eriti kui tunnuste kategooriate nimed on väga pikad. Selle ja järgmiste mudeli tulemuste esitlemine jätkub allpool alapool alapeatükis Regressioonimudeli tulemuste esitlemine. Mudeli elemente on võimalik välja küsida ka ükshaaval ning sellest räägib alapeatükk Mudeli elementide kasutamine.\n\n\nMultikollineaarsuse hindamine\nMul ei ole praegu tehtud mudelit, kus seletavad tunnused saaksid ka olla omavahel lineaarses seoses. Ühe näitaja suurenedes peaks tõusma ka teine. Näiteks rannas müüdavate jäätise arv tõuseb kui välitemperatuur tõuseb. Rannas juhtuvate õnnetuste arv võib olla lineaarses seoses välitemperatuuriga. Õnnetuste arvu prognoomisisel oleksid seletavad tunnustena rannas müüdavate jäätiste arv ning välitemperatuuri arv ka kollineaarses seoses.\nMultikollineaarsuse hindamist saab teha paketiga car ning käsuga vif().\n\nvif(mudel4)\n\n            GVIF Df GVIF^(1/(2*Df))\nagea    1.167129  1        1.080337\nhincfel 1.107629  3        1.017183\ngndr    1.042810  1        1.021181\nsobrad  1.110698  2        1.026595\n\n\nVIF miinimuväärtus on 1 ja meie mudeli väärtused on selle lähedal. Multikollineaarsusega häda ei ole.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#regressioonimudeli-tulemuste-esitlemine",
    "href": "12-regressioon-lineaarne.html#regressioonimudeli-tulemuste-esitlemine",
    "title": "12  Regressioon - lineaarne",
    "section": "12.6 Regressioonimudeli tulemuste esitlemine",
    "text": "12.6 Regressioonimudeli tulemuste esitlemine\nOleme teinud nüüd õnnelikuse prognoosimise kohta neli mudelit (mudelid nr 1-4). Soovime neid omavahel võrrelda, et teada saada, milline loodud mudel on neist parim. Kuna summary() käsuga ei ole neli mudelit korraga hästi hoomatavad, soovitan selleks kasutada paketist huxtable(Hugh-Jones 2024) käsku huxreg().\n\nlibrary(huxtable)\n\n\nhuxreg(mudel1, mudel2, mudel3, mudel4)\n\n\n\n(1)(2)(3)(4)\n\n(Intercept)8.234 ***8.452 ***8.339 ***8.072 ***\n\n(0.130)   (0.131)   (0.136)   (0.169)   \n\nagea-0.014 ***-0.007 ** -0.008 ** -0.006 *  \n\n(0.002)   (0.002)   (0.002)   (0.002)   \n\nhincfelSaame hakkama praeguse sissetuleku juures        -0.563 ***-0.561 ***-0.548 ***\n\n        (0.103)   (0.103)   (0.103)   \n\nhincfelPraeguse sissetuleku juures on raske hakkama saada        -1.554 ***-1.562 ***-1.525 ***\n\n        (0.150)   (0.150)   (0.150)   \n\nhincfelPraeguse sissetuleku juures on väga raske hakkama saada        -2.154 ***-2.148 ***-2.108 ***\n\n        (0.270)   (0.270)   (0.269)   \n\ngndrNaine                0.268 ** 0.225 ** \n\n                (0.085)   (0.086)   \n\nsobradMõned                        0.217 *  \n\n                        (0.106)   \n\nsobradPalju                        0.376 ** \n\n                        (0.130)   \n\nN1541        1541        1541        1539        \n\nR20.023    0.107    0.112    0.117    \n\nlogLik-3023.114    -2954.147    -2949.135    -2941.498    \n\nAIC6052.228    5920.294    5912.270    5900.996    \n\n *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.\n\n\n\n\nMudelite omavahelises võrdluses paistab mudel4 olevat kõige parema seletusvõimega (AIC kõige väiksem, R2 seletusvõime kõige kõrgem). Salvestan andmestikku uue tunnuse mudel4 põhjal. Kasutan seda tulemuste visualiseerimisel.\n\nandmed$prognoos_onn&lt;-predict(mudel4, newdata = andmed)\n\n\n\n\n\n\n\nIdeaalselt tahame saada mudelit, mis võimalikult väheste seletavate tunnustega suudaks kirjeldada ära võimalikult suure mahu olemasolevast. Iga uue tunnuse lisamisel mudelisse võib paratamatult tõsta R2 väärtust, kuid pigem sooviks näha hüppelisi muutusi nagu mudel nr 1 ja nr 2 puhul, mitte nagu mudelite nr 3 ja nr 4. Tulemuste esitlemisel ole kriitiline ja aus. Kui mudeli seletusvõime on ikkagi kohe eos vaid 2%, siis võib-olla ei tasuks mudelit muude tunnustega edasi arendama hakatagi. Võib-olla on kasu mõnest muust analüüsimeetodist kui lineaarsest regressioonist?",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#regressioonimudeli-tulemuste-visualiseerimine",
    "href": "12-regressioon-lineaarne.html#regressioonimudeli-tulemuste-visualiseerimine",
    "title": "12  Regressioon - lineaarne",
    "section": "12.7 Regressioonimudeli tulemuste visualiseerimine",
    "text": "12.7 Regressioonimudeli tulemuste visualiseerimine\nKasuta joonisel tunnust, mille lõid käsuga predict(). Vajadusel loe ggplot() käsu töötamise kohta juurde siit.\n\n\nCode\nandmed|&gt;\n  drop_na(agea, prognoos_net)|&gt;\n  ggplot( aes(agea, prognoos_net))+\n  geom_smooth(method = \"lm\",\n              aes(color=gndr))+\n    theme_bw()+\n  labs(x=\"Vanus\",\n       y=\"Prognoositud interneti kasutusaeg minutites\",\n       color=\"Sugu\")+\n  scale_color_viridis_d()\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nJooniselt selgub, et mudeli kohaselt kasutavad naised meestest internetti rohkem (igas vanuses) ning meeste ja naiste prognoositav internetikasutusaeg langeb aastatega sarnaselt.\nKuidas on aga inimeste õnnelikuks olemisega? Mida saame oma prognoosimudeli kohta öelda pilti vaadates?\nMeie mudeli4 järgi paistab, et kõige õnnelikumad on need, kellel on palju sõpru ja mugav elada. Vanuse kasvades (prognoosimudeli järgi) hinnang õnnelikusele igal juhul langeb. Need, kellel on vähe sõpru, need on igal juhul õnnetumad kui sama sissetulekuga aga rohkemate sõpradega inimesed. Need inimesed, kes hindavad oma sissetuleku põhjal toimetulekuvõime väga raskeks, nende puhul usaldusvahemikud kõiguvad väga palju.\n\n\nCode\nandmed|&gt;\n  drop_na(agea, happy, sobrad)|&gt;\n  ggplot( aes(agea, prognoos_onn))+\n  geom_smooth(method=\"lm\",\n              aes(color=hincfel))+\n  labs(x=\"Vanus\",\n       y=\"Prognoositav hinnang õnnelikusele\",\n       color=\"Sissetulek\")+\n  facet_wrap(~sobrad)+\n  theme_bw()+\n  scale_color_viridis_d(labels=c(\"Elame mugavalt\", \"Saame hakkama\", \"Raske on\", \"Väga raske\"))\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\nTulemuste visualiseerimine paketiga interactions\nRegressioonimudeli jooniseid saab kiiresit kätte paketiga interactions(Long 2019) käsuga interact_plot().\n\nlibrary(interactions)\n\n\ninteract_plot(mudel4, pred=agea, modx=sobrad)\n\n\n\n\n\n\n\n\n\n\n\n\nFox, John, and Sanford Weisberg. 2019. An R Companion to Applied Regression. Third. Thousand Oaks CA: Sage. https://socialsciences.mcmaster.ca/jfox/Books/Companion/.\n\n\nHugh-Jones, David. 2024. Huxtable: Easily Create and Style Tables for LaTeX, HTML and Other Formats. https://CRAN.R-project.org/package=huxtable.\n\n\nLong, Jacob A. 2019. Interactions: Comprehensive, User-Friendly Toolkit for Probing Interactions. https://cran.r-project.org/package=interactions.\n\n\nZeileis, Achim, and Torsten Hothorn. 2002. “Diagnostic Checking in Regression Relationships.” R News 2 (3): 7–10. https://CRAN.R-project.org/doc/Rnews/.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "12-regressioon-lineaarne.html#footnotes",
    "href": "12-regressioon-lineaarne.html#footnotes",
    "title": "12  Regressioon - lineaarne",
    "section": "",
    "text": "Kui soovid sama andmestikuga harjutusi järele teha, lae andmestik nimega “ESS_10_valik.csv” alla siit.↩︎\nSõltumatuse probleem tekib näiteks nende tunnustega, kus on tehtud korduvmõõtmised ajas (nt puu ümbermõõdu kasvamine).↩︎",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Regressioon - lineaarne</span>"
    ]
  },
  {
    "objectID": "13-regressioon-logistiline.html",
    "href": "13-regressioon-logistiline.html",
    "title": "13  Regressioon - logistiline",
    "section": "",
    "text": "13.1 Binaarne logistiline regressioon\nKasutan Euroopa Sotsiaaluuringu (edaspidi ESS) andmeid, mis on kogutud Eesti inimeste kohta uuringu 10. voorus. Andmed on võimalik alla laadida ESS andmete portaalist. Siin peatükis olen teinud 10. voorust väljavõtte paari tunnuse kohta.\nPrognoositav tunnus peab olema binaarne ehk kahe kategooriaga.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Regressioon - logistiline</span>"
    ]
  },
  {
    "objectID": "13-regressioon-logistiline.html#binaarne-logistiline-regressioon",
    "href": "13-regressioon-logistiline.html#binaarne-logistiline-regressioon",
    "title": "13  Regressioon - logistiline",
    "section": "",
    "text": "Tunnuste ettevalmistus mudeli jaoks\nKui vaatame histogrammi, siis meil on Eestis inimesed pigem ikka õnnelikud.\n\nhist(andmed$happy)\n\n\n\n\n\n\n\n\nVõtame arvesse, et õnnelike inimesi on rohkem ja teeme vastajatest kaks gruppi nii, et need kes hindasid oma õnne väärtuseks 0 kuni 6 on edaspidi “õnnetu” ja ülejäänud “õnnelik” grupis. Vaata vajadusel peatükki tunnuste muutmisest. Tunnus peab olema oma tüübilt factor. Ühtlasi kodeerime ka mõned teised tunnused ringi, et oleks väiksem kategoooriate arv mudelis.\n\n\nCode\nandmed&lt;-andmed%&gt;%\n  mutate(onn=if_else(happy&lt;7, \"Õnnetu\", \"Õnnelik\"))%&gt;%\n  mutate(onn=as_factor(onn))\n\n\n\n\nCode\nandmed$sobrad&lt;-fct_collapse(andmed$inprdsc,\n                            \"Vähe\" = c(\"Mitte ühtegi\",\"1\"),\n                            \"Mõned\"= c(\"2\", \"3\"),\n                            \"Palju\"= c(\"4-6\" ,\"7-9\", \"10 või enam\"))\nandmed$sobrad&lt;-fct_relevel(andmed$sobrad, c(\"Vähe\", \"Mõned\", \"Palju\"))\n\nandmed$sissetulek&lt;-fct_collapse(andmed$hincfel,\n                                \"Raske on\" = c(\"Praeguse sissetuleku juures on väga raske hakkama saada\", \"Praeguse sissetuleku juures on raske hakkama saada\"),\n                                \"Elame hästi\" =c(\"Elame mugavalt praeguse sissetuleku juures\", \n                                \"Saame hakkama praeguse sissetuleku juures\"))\n\n\n\nplot(andmed$onn)\n\n\n\n\n\n\n\n\n\nsummary(andmed$onn)\n\nÕnnelik  Õnnetu    NA's \n   1183     358       1 \n\n\n\n\nMudeli koostamine\nKäsuga contrasts() näeb ära, milline tunnuse on taustakategooria. Taustakategooria on märgitud nulliga (0) ning prognoosima hakatakse gruppi 1. Kui tahad järjestust vahetada, siis kasuta käsku relevel().\n\ncontrasts(andmed$onn)\n\n        Õnnetu\nÕnnelik      0\nÕnnetu       1\n\n\nPrognoosime, kas inimese vanus, sissetulek ja sõprade olemasolu võiks mõjutada “õnnetu” grupis olemist.\nLogistiline regressioon käib käsuga glm(). Salvestame mudel eraldi objekti.\n\nmudel1&lt;-glm(onn ~ agea + sissetulek + sobrad,\n            family = binomial(link=\"logit\"),\n            andmed)\n\nKui ei ole soov mõnda muud paketti alla laadida, näeb mudeli väljatrükki käsuga summary().\n\nsummary(mudel1)\n\n\nCall:\nglm(formula = onn ~ agea + sissetulek + sobrad, family = binomial(link = \"logit\"), \n    data = andmed)\n\nCoefficients:\n                    Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)        -2.427512   0.254024  -9.556  &lt; 2e-16 ***\nagea                0.024874   0.003689   6.743 1.55e-11 ***\nsissetulekRaske on  1.162738   0.153790   7.561 4.01e-14 ***\nsobradMõned        -0.448037   0.146431  -3.060  0.00222 ** \nsobradPalju        -0.598732   0.195036  -3.070  0.00214 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1667.2  on 1538  degrees of freedom\nResidual deviance: 1512.0  on 1534  degrees of freedom\n  (3 observations deleted due to missingness)\nAIC: 1522\n\nNumber of Fisher Scoring iterations: 4\n\n\nRiskisuhteid näeb käsuga exp() ja coef() ühendamisel. Tulemuste tõlgendamise meeldib mulle riskisuhteid rohkem vaadata. Lisan neile kohe ka käsu round() otsa, et oleks silmale parem vaadata.\n\nround(exp(coef(mudel1)),2)\n\n       (Intercept)               agea sissetulekRaske on        sobradMõned \n              0.09               1.03               3.20               0.64 \n       sobradPalju \n              0.55 \n\n\n\\(Exp\\) puhul on kordajate võrldusastmeks 1 ehk 100%.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Regressioon - logistiline</span>"
    ]
  },
  {
    "objectID": "13-regressioon-logistiline.html#tulemuste-tõlgendamine",
    "href": "13-regressioon-logistiline.html#tulemuste-tõlgendamine",
    "title": "13  Regressioon - logistiline",
    "section": "13.2 Tulemuste tõlgendamine",
    "text": "13.2 Tulemuste tõlgendamine\nEsmalt peab vaatama, kas kordaja on negatiivne või positiivne. Vanuse ja sisstuleku kordaja on positiivne. See tähendab, et vanuse kasvades suureneb risk olla õnnetu. Riski õnnetu olla suurendab ka see, kui sul on oma sisstulekute juures raske toime tulla. Negatiivne kordaja aga vähendab riski.\nKui suur see riski on? Selleks on hea vaadata riskisuhteid \\(exp\\) tasemel. Inimestel, kellel on oma sissetulekute juures raske toime tulla, on 3,2 korda suurem risk sattuda gruppi “õnnetu”.\nTeeme veel ühe mudeli ja võrdleme neid pärast koos\n\nmudel2&lt;-glm(onn ~ agea + sobrad,\n            family = binomial(link=\"logit\"),\n            andmed)",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Regressioon - logistiline</span>"
    ]
  },
  {
    "objectID": "13-regressioon-logistiline.html#väljatrükk-paketiga-huxtable",
    "href": "13-regressioon-logistiline.html#väljatrükk-paketiga-huxtable",
    "title": "13  Regressioon - logistiline",
    "section": "13.3 Väljatrükk paketiga huxtable",
    "text": "13.3 Väljatrükk paketiga huxtable\nPaketi huxtable abil on kerge korraga mitme mudeli väljatrükke teha. Regressioonimudeli puhul on sobilik käsk huxreg(). Ignoreeri hoiatust, et r.squared ei leitud kuna see väärtus tuleb lineaarse mudeli puhul.\n\nlibrary(huxtable)\n\n\nhuxreg(mudel1, mudel2)\n\nWarning in huxreg(mudel1, mudel2): Unrecognized statistics: r.squared\nTry setting `statistics` explicitly in the call to `huxreg()`\n\n\n\n\n(1)(2)\n\n(Intercept)-2.428 ***-2.302 ***\n\n(0.254)   (0.248)   \n\nagea0.025 ***0.028 ***\n\n(0.004)   (0.004)   \n\nsissetulekRaske on1.163 ***        \n\n(0.154)           \n\nsobradMõned-0.448 ** -0.527 ***\n\n(0.146)   (0.143)   \n\nsobradPalju-0.599 ** -0.664 ***\n\n(0.195)   (0.191)   \n\nN1539        1539        \n\nlogLik-755.991    -783.719    \n\nAIC1521.982    1575.438    \n\n *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.\n\n\n\n\n\nTulemuste esitlemine paketiga broom\nPakett broom (Robinson, Hayes, and Couch 2024) annab käsu tidy(). Kasutame seda, et saada mudelist kätte nn “põhiosa”.\n\nlibrary(broom)\n\n\npuhas_mudel&lt;-tidy(mudel1)\npuhas_mudel$exp_coef&lt;-exp(puhas_mudel$estimate)\n\n\npuhas_mudel\n\n\n\ntermestimatestd.errorstatisticp.valueexp_coef\n\n(Intercept)-2.43  0.254  -9.561.22e-210.0883\n\nagea0.02490.003696.741.55e-111.03  \n\nsissetulekRaske on1.16  0.154  7.564.01e-143.2   \n\nsobradMõned-0.448 0.146  -3.060.00222 0.639 \n\nsobradPalju-0.599 0.195  -3.070.00214 0.55",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Regressioon - logistiline</span>"
    ]
  },
  {
    "objectID": "13-regressioon-logistiline.html#mudeli-seletusvõime-hindamine",
    "href": "13-regressioon-logistiline.html#mudeli-seletusvõime-hindamine",
    "title": "13  Regressioon - logistiline",
    "section": "13.4 Mudeli seletusvõime hindamine",
    "text": "13.4 Mudeli seletusvõime hindamine\nMina olen harjunud kasutama paketist rcompanion (Mangiafico 2024) käsku nagelkerke().\n\nlibrary(rcompanion)\n\nLihtsaim viis on kasutada käsku kogu mudelil, millega saab põhjaliku väljarüki.\n\nnagelkerke(mudel1)\n\n$Models\n                                                                                  \nModel: \"glm, onn ~ agea + sissetulek + sobrad, binomial(link = \\\"logit\\\"), andmed\"\nNull:  \"glm, onn ~ 1, binomial(link = \\\"logit\\\"), andmed\"                         \n\n$Pseudo.R.squared.for.model.vs.null\n                             Pseudo.R.squared\nMcFadden                            0.0949634\nCox and Snell (ML)                  0.0979503\nNagelkerke (Cragg and Uhler)        0.1478990\n\n$Likelihood.ratio.test\n Df.diff LogLik.diff  Chisq    p.value\n      -4     -79.324 158.65 2.8491e-33\n\n$Number.of.observations\n           \nModel: 1539\nNull:  1541\n\n$Messages\n[1] \"Note: For models fit with REML, these statistics are based on refitting with ML\"\n\n$Warnings\n[1] \"WARNING: Fitted and null models have different numbers of observations\"\n\n\nRuumi kokkuhoidvam viis on salvestada see eraldi väärtusena (kolmas kordaja ehk Nagelkerke Cragg and Uhler väärtus). Ümardan ka selle kohe kaks kohta pärast koma käsuga round().\n\nnagelkerke_kordaja &lt;- round(nagelkerke(mudel1)$Pseudo.R.squared.for.model[3],2)\n\nKorrutan kordaja läbi 100-ga, et saada kätte protsendid.\n\nnagelkerke_kordaja*100\n\n[1] 15\n\n\nMudeli selgitusvõime on 15 %.\n\n\n\n\nMangiafico, Salvatore S. 2024. rcompanion: Functions to Support Extension Education Program Evaluation. New Brunswick, New Jersey: Rutgers Cooperative Extension. https://CRAN.R-project.org/package=rcompanion/.\n\n\nRobinson, David, Alex Hayes, and Simon Couch. 2024. Broom: Convert Statistical Objects into Tidy Tibbles. https://CRAN.R-project.org/package=broom.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Regressioon - logistiline</span>"
    ]
  },
  {
    "objectID": "14-klaster.html",
    "href": "14-klaster.html",
    "title": "14  Klasteranalüüs",
    "section": "",
    "text": "14.1 Eeltööd\nSee peatükk annab ülevaate, kuidas kasutada R-i klasteranalüüsi läbiviimiseks. Klasteranalüüsi abil grupeeritakse sarnaseb objektid klastritesse. Seda meetodit kasutatakse enamasti mustrituvastuse jaoks. Siin peatükis on näide ühe levinuma (k-keskmiste) meetodi kasutamisest. Püüan tulevikus kirjeldada ka hierahilist klasterdusmeetodi kasutamist R-is.\nKlasteranalüüsi jooniste tegemisel on vajalik alla laadida pakett factoextra(Kassambara and Mundt 2020).\nKasutame R-iga kaasatulevat andmestikku iris, milles on kirja pandud lillede (iiriste) kroonlehtede mõõtmed.\ndata(iris)\niris|&gt;\n  head()\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\nStandardiseerin esmalt andmestiku käsu scale() abil, kuna tunnuste skaalad on erinevad. scale() käsk annab veateate, kui tunnused ei ole numeric tüüpi.\niris_standard&lt;-iris|&gt;\n1  select(-Species) |&gt;\n  scale()|&gt;\n  as_tibble()\n\n\n1\n\nEemaldan andmestikus tunnuse Species, kuna see sisaldab faktorit.\nVaatan andmestikku pärast standardiseerimist.\niris_standard|&gt;\n  head()\n\n# A tibble: 6 × 4\n  Sepal.Length Sepal.Width Petal.Length Petal.Width\n         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;\n1       -0.898      1.02          -1.34       -1.31\n2       -1.14      -0.132         -1.34       -1.31\n3       -1.38       0.327         -1.39       -1.31\n4       -1.50       0.0979        -1.28       -1.31\n5       -1.02       1.25          -1.34       -1.31\n6       -0.535      1.93          -1.17       -1.05\nViin läbi klasteranalüüsi K-keskmiste abil. Seejärel kasutan käsku set.seed(), et anda ette suvalised numbrid. See käsk on R-is vajalik ning selgitus on päris tehniline. Programm vajab etteantud numbreid set.seed(), et analüüsi programmikood oleks korratav.\nset.seed(123)",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Klasteranalüüs</span>"
    ]
  },
  {
    "objectID": "14-klaster.html#k-keskmiste-meetodil-klasterdus",
    "href": "14-klaster.html#k-keskmiste-meetodil-klasterdus",
    "title": "14  Klasteranalüüs",
    "section": "14.2 K-keskmiste meetodil klasterdus",
    "text": "14.2 K-keskmiste meetodil klasterdus\nK-keskmiste klasterdus toimub käsuga kmeans(). Ma praeguses näites ei anna ette iteratsioonide arvu, vaikimisi on see 10. Kui on soov seda muuta (näiteks 15), tuleb lisada käsu sisse täpsustus iter.max=15.\n\n#?kmeans\n\nSalvestan tulemuse eraldi objekti. Käsu sees täpsustan soovitavate klastrite arvu (centers=) ning ütlen ette, mitu juhusliku hulka (nstart=) tuleks valida. Vaata ka, kuidas valida klastrite arvu nn küünarnuki meetodil.\n\nkkeskmine_tulemus&lt;-kmeans(iris_standard, centers=3, nstart=25)\n\nKasutan salvestatud analüüsi, et lisada algandmetesse juurde analüüsi tulemus (klasterdus) faktorina.\n\niris_klaster&lt;-iris|&gt;\n  mutate(klaster=as.factor(kkeskmine_tulemus$cluster))\n\nVaatan, millised iirise liigid jagunevad millistesse klastritesse. Klastrid on numbrites üks kuni kolm. Setosa liik on ainsana klastris üks, Suurem osa versicolor liigist on klastris 2, kuid seal on ka esindatud virginica liiki.\n\ntable(iris_klaster$Species, iris_klaster$klaster)\n\n            \n              1  2  3\n  setosa     50  0  0\n  versicolor  0 39 11\n  virginica   0 14 36\n\n\n\nKuidas valida sobiv klastrite arv?\nTeeme seda paketi factoextra(Kassambara and Mundt 2020)abil ning kasutame käsku fviz_nbclust(). Meetodiks on nn küünarnuki kõvera meetod, kus jooniselt püüame tuvastada millises punktis klastrisisene variatsioon (sum of squared errors, SSE) aeglustub.\n\nlibrary(factoextra)\n\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n\n\n\n?fviz_nbclust\n\n\nfviz_nbclust(iris_standard, kmeans, method = \"wss\")\n\n\n\n\n\n\n\n\nTundub, et number kolme juurest edasi on langus väiksem. Kui soovime seda punkti joonisel edasi anda, saame kasutada käsku geom_vline()\n\nfviz_nbclust(iris_standard, kmeans, method = \"wss\")+\n  geom_vline(xintercept = 3, linetype=3)",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Klasteranalüüs</span>"
    ]
  },
  {
    "objectID": "14-klaster.html#klastrite-visualiseerimine-ja-pakett-factoextra",
    "href": "14-klaster.html#klastrite-visualiseerimine-ja-pakett-factoextra",
    "title": "14  Klasteranalüüs",
    "section": "14.3 Klastrite visualiseerimine ja pakett factoextra",
    "text": "14.3 Klastrite visualiseerimine ja pakett factoextra\nÜks võimalus on teha niisama numbriliste tunnustega scatterplot ja näidata ära, millised liigid millistesse klastrisse kukkusid.\n\n\nCode\niris_klaster|&gt;\n  ggplot(aes(Sepal.Length, Sepal.Width, \n             shape = klaster,\n             color = Species))+\n  geom_point(size=3, alpha=0.5)+\n  labs(title=\"Iiriste jagunemine klastritesse\")+\n  scale_color_viridis_d()+\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nPalju võimekamaid joonised on võimalik teha paketiga factoextra(Kassambara and Mundt 2020) käsu fviz_cluster() abil. Kasutada tuleb analüüsi tulemuse objekti (kkeskmine_tulemus) ja andmestikku, mis oli kasutusel analüüsis (st standardiseeritud andmed iris_standard).\n\nlibrary(factoextra)\n\nKäsu fviz_cluster() abil saab päris kiiresti teha joonise.\n\nfviz_cluster(kkeskmine_tulemus, data=iris_standard,\n            ggtheme= theme_minimal())\n\n\n\n\n\n\n\n\nÕnneks on võimalik seda joonist ka muuta. Kasutame mõnda käsku, et samade andmetega teha uus joonis.\n\nfviz_cluster(kkeskmine_tulemus, data=iris_standard,\n1             palette = c(\"orange\",\"#6BAED6\", \"#08519C\"),\n2             ellipse.type = \"euclid\",\n            star.plot=TRUE,\n3            repel = TRUE,\n4            main=\"Klasteranalüüs k-keskmiste abil\",\n            ggtheme= theme_minimal())\n\n\n1\n\nMuudan joonisel kujutatud värvid\n\n2\n\nMuudab ära klastri kuju, võimalik kasutada “t”, “norm” ja “euclid”.\n\n3\n\nToob punktide väärtused üksteisest eemale, et need ei kattuks ja oleks paremini loetavad\n\n4\n\nMuudan ära joonise pealkirja, mis vaikimisi on “Cluster plot”\n\n\n\n\n\n\n\n\n\n\n\nVaata käsu kasutusvõimaluse kohta.\n\n#?fviz_cluster\n\n\n\n\n\nKassambara, Alboukadel, and Fabian Mundt. 2020. Factoextra: Extract and Visualize the Results of Multivariate Data Analyses. https://CRAN.R-project.org/package=factoextra.",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Klasteranalüüs</span>"
    ]
  },
  {
    "objectID": "15-tabelid.html",
    "href": "15-tabelid.html",
    "title": "15  Tabelite kujundamine",
    "section": "",
    "text": "15.1 Tabelid paketiga gtExtras\nSee peatükk annab ülevaate, kuidas kujundada R-is tabeleid. Sarnaselt joonistega jagunevad ka tabelid kaheks. Ühed on need, mida ise vaatad ja teised on need, mille abil jutustad teistele lugu. Sarnaselt joonistega, ei tasu aja mõttes endale tehtud tabeleid väga “ilusaks” disainida.\nHakkame näidetes kasutama starwars andmestikku ja teeme soojenduseks ühe tabeli käsuga table()\nSaame teada küll kui palju on ühte või teist species-is esindajat, aga tõttöelda ei ole kogu pilt kompaktselt silmaga hoomatav. Lisaks on oht, et käsuga table() ei näe kui palju on puuduvaid väärtusi. Seepärast võiks tabelite koostamisel veidike rohkem vaeva näha.\nPaketti gtExtras (Mock 2023) sisaldab paketti gt (Iannone et al. 2024), mistõttu eraldi neid pakette paigaldama ei pea.\nlibrary(gtExtras)\n\nLoading required package: gt\nTeeme käskudega group_by() ja summarise() tabeli ja lisame käsu gt(), et loodud tabel väljatrükis vähe ilusam paistaks.\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(arv=n())|&gt;\n  arrange(-arv)|&gt;\n  head(3)|&gt;\n  gt()\n\n\n\n\n\n\n\nspecies\narv\n\n\n\n\nHuman\n35\n\n\nDroid\n6\n\n\nNA\n4",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Tabelite kujundamine</span>"
    ]
  },
  {
    "objectID": "15-tabelid.html#tabelid-paketiga-gtextras",
    "href": "15-tabelid.html#tabelid-paketiga-gtextras",
    "title": "15  Tabelite kujundamine",
    "section": "",
    "text": "Pealkirjade lisamine\nPealkirjade lisamine käib käsuga tab_header() ning vaja on lisada täpsustused title= ja vajadusel ka subtitle=.\n\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(arv=n())|&gt;\n  arrange(-arv)|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n  tab_header(title=\"See on tabeli pealikiri\",\n             subtitle=\"See on tabeli alapealkiri\")\n\n\n\n\n\n\n\nSee on tabeli pealikiri\n\n\nSee on tabeli alapealkiri\n\n\nspecies\narv\n\n\n\n\nHuman\n35\n\n\nDroid\n6\n\n\nNA\n4\n\n\n\n\n\n\n\nKui on soov rõhutada mõnda sõna pealkirjas kas kald- või paksus kirjas, tuleb lisada markdowni funktsiooni käsk md() .\n\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(arv=n())|&gt;\n  arrange(-arv)|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n1  tab_header(title=md(\"See on **tabeli** pealikiri\"),\n2             subtitle=md(\"See on *tabeli* alapealkiri\"))\n\n\n1\n\nSõna “tabel” paksu kirja panemine\n\n2\n\nSõna “tabel” kaldkirja panemine\n\n\n\n\n\n\n\n\n\n\nSee on tabeli pealikiri\n\n\nSee on tabeli alapealkiri\n\n\nspecies\narv\n\n\n\n\nHuman\n35\n\n\nDroid\n6\n\n\nNA\n4\n\n\n\n\n\n\n\n\n\nAlateksti lisamine\nOma loodud tabeli alla teksti lisamine käib käsuga tab_source_note(). Ka siin võib soovi korral lisada käsu md(), et teksti välimust vormindada.\n\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(arv=n())|&gt;\n  arrange(-arv)|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n  tab_source_note(source_note = \"Nii saab lisada allikaid\")|&gt;\n  tab_source_note(source_note = md(\"See tekst on **rõhutatult**, *lk 1*\")) \n\n\n\n\n\n\n\nspecies\narv\n\n\n\n\nHuman\n35\n\n\nDroid\n6\n\n\nNA\n4\n\n\n\nNii saab lisada allikaid\n\n\nSee tekst on rõhutatult, lk 1\n\n\n\n\n\n\n\n\n\n\nMärkuste lisamine\nTabelile märkuste lisamine käib käsuga tab_footnote(), mis vajab täpsustust mis on allmärkuse sisu footnote= ja mille kohta ta käib locations=.\n\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(arv=n())|&gt;\n  arrange(-arv)|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n  tab_footnote(footnote = \"Ei ole inimesed.\",\n               locations = cells_body(columns=species, rows=2))\n\n\n\n\n\n\n\nspecies\narv\n\n\n\n\nHuman\n35\n\n\nDroid1\n6\n\n\nNA\n4\n\n\n\n1 Ei ole inimesed.\n\n\n\n\n\n\n\n\nOletame, et soovime lisada mitut märkust ja nii, et see lisatakse vastavalt kas suurimale või väiksemale tabelis esinevale väärtusele. Selleks on võimalik kasutada baaskäske min() ja max().\nÜhtlasi on võimalik lisada sama märkust korraga mitmele reale.\nPane tähele, et märkused lisatakse tabelisse nende esinemise järjekorras mitte nende koodi kirjutamise järjekorras.\n\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(arv=n())|&gt;\n  arrange(-arv)|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n  tab_footnote(footnote = \"Ei ole inimesed.\",\n               locations = cells_body(columns=species, rows=2))|&gt;\n  tab_footnote(footnote = \"panen **suurimale** väärtusele\",\n               locations = cells_body(\n                 columns=arv,\n1                 rows=arv==max(arv, na.rm=T)\n               ))\n\n\n1\n\nMärkuse lisamine käsu max() abil suurimale väärtusele\n\n\n\n\n\n\n\n\n\n\nspecies\narv\n\n\n\n\nHuman\n1 35\n\n\nDroid2\n6\n\n\nNA\n4\n\n\n\n1 panen **suurimale** väärtusele\n\n\n2 Ei ole inimesed.\n\n\n\n\n\n\n\n\n\n\nTabelis tunnuste grupeerimine ja vahepealkirjade lisamine\nOletame, et soovime teha kaks gruppi, et näidata ära väikesed ja suured liigid. Pane tähele, et nüüd esitatakse andmed tabelis selles järjekorras, et viimane seadistus (väikesed liigid) tuleb esimeseks sõltumata sellest, et eespool on kasutatud on käsku arrange().\n\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(arv=n())|&gt;\n  arrange(-arv)|&gt;\n  head(5)|&gt;\n  gt()|&gt;\n  tab_row_group(label=md(\"**Suured liigid**\"),\n                rows=1:2)|&gt;\n  tab_row_group(label=md(\"**Väikesed liigid**\"),\n                rows=3:5)\n\n\n\n\n\n\n\nspecies\narv\n\n\n\n\nVäikesed liigid\n\n\nNA\n4\n\n\nGungan\n3\n\n\nKaminoan\n2\n\n\nSuured liigid\n\n\nHuman\n35\n\n\nDroid\n6\n\n\n\n\n\n\n\n\n\nTulpade grupeerimine\n\nstarwars|&gt;\n  group_by(species)|&gt;\n  summarise(mass=mean(mass, na.rm=T),\n            height=mean(height, na.rm=T))|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n  tab_header(title=\"Starwarsi tegelased\")|&gt;\n  tab_spanner(label=\"Päritolu\",\n              columns = c(species))|&gt;\n  tab_spanner(label=\"Mõõdud\",\n              columns = c(mass, height))\n\n\n\n\n\n\n\n\n\n\n\n\nStarwarsi tegelased\n\n\n\nPäritolu\n\n\nMõõdud\n\n\n\nspecies\nmass\nheight\n\n\n\n\nAleena\n15\n79\n\n\nBesalisk\n102\n198\n\n\nCerean\n82\n198\n\n\n\n\n\n\n\n\n\nRidade liitmine tabelis\n\nstarwars&lt;-starwars|&gt;\n  select(-films:-starships)\n\nAndmestikus on tulbad “name” ja “species”. Kasutan neid, et liigendada tabel ringi nii, et tulp “name” hakkab esindama ridada nime ning visuaalselt jaotuvad grupid tabelis eraldi tulba “species” järgi.\n\nstarwars|&gt;\n  head(15)|&gt;\n  gt(rowname_col = \"name\", groupname_col = \"species\")\n\n\n\n\n\n\n\n\nheight\nmass\nhair_color\nskin_color\neye_color\nbirth_year\nsex\ngender\nhomeworld\n\n\n\n\nHuman\n\n\nLuke Skywalker\n172\n77\nblond\nfair\nblue\n19.0\nmale\nmasculine\nTatooine\n\n\nDarth Vader\n202\n136\nnone\nwhite\nyellow\n41.9\nmale\nmasculine\nTatooine\n\n\nLeia Organa\n150\n49\nbrown\nlight\nbrown\n19.0\nfemale\nfeminine\nAlderaan\n\n\nOwen Lars\n178\n120\nbrown, grey\nlight\nblue\n52.0\nmale\nmasculine\nTatooine\n\n\nBeru Whitesun Lars\n165\n75\nbrown\nlight\nblue\n47.0\nfemale\nfeminine\nTatooine\n\n\nBiggs Darklighter\n183\n84\nblack\nlight\nbrown\n24.0\nmale\nmasculine\nTatooine\n\n\nObi-Wan Kenobi\n182\n77\nauburn, white\nfair\nblue-gray\n57.0\nmale\nmasculine\nStewjon\n\n\nAnakin Skywalker\n188\n84\nblond\nfair\nblue\n41.9\nmale\nmasculine\nTatooine\n\n\nWilhuff Tarkin\n180\nNA\nauburn, grey\nfair\nblue\n64.0\nmale\nmasculine\nEriadu\n\n\nHan Solo\n180\n80\nbrown\nfair\nbrown\n29.0\nmale\nmasculine\nCorellia\n\n\nDroid\n\n\nC-3PO\n167\n75\nNA\ngold\nyellow\n112.0\nnone\nmasculine\nTatooine\n\n\nR2-D2\n96\n32\nNA\nwhite, blue\nred\n33.0\nnone\nmasculine\nNaboo\n\n\nR5-D4\n97\n32\nNA\nwhite, red\nred\nNA\nnone\nmasculine\nTatooine\n\n\nWookiee\n\n\nChewbacca\n228\n112\nbrown\nunknown\nblue\n200.0\nmale\nmasculine\nKashyyyk\n\n\nRodian\n\n\nGreedo\n173\n74\nNA\ngreen\nblack\n44.0\nmale\nmasculine\nRodia\n\n\n\n\n\n\n\nLisame nüüd käsu summary_rows(), mille sees täpsutame millistele gruppidele arvutada (groups=) milliseid tulpasid (columns=) ning seejärel mida arvutada. Pane tähele, kuidas kasutame käsku everything(), et valida kõik grupid ning kuidas vektorit, et valida tulpasid.\n\nstarwars|&gt;\n  slice(1:15)|&gt;\n  gt(rowname_col = \"name\", groupname_col = \"species\")|&gt;\n1  summary_rows(groups = everything(),\n2               columns = c(mass, height),\n3               fns=list(keskmine= ~mean(., na.rm = T),\n                        summa=~sum(., na.rm=T),\n                        sd=~sd(.,na.rm=T)))\n\n\n1\n\nKõigi gruppide valimine käsuga everything()\n\n2\n\nTulpade täpsustamine, mille teha arvutused\n\n3\n\nArvutuskäsu andmine keskmise, summa ja standardhälve arvutamiseks\n\n\n\n\n\n\n\n\n\n\n\nheight\nmass\nhair_color\nskin_color\neye_color\nbirth_year\nsex\ngender\nhomeworld\n\n\n\n\nHuman\n\n\nLuke Skywalker\n172\n77\nblond\nfair\nblue\n19.0\nmale\nmasculine\nTatooine\n\n\nDarth Vader\n202\n136\nnone\nwhite\nyellow\n41.9\nmale\nmasculine\nTatooine\n\n\nLeia Organa\n150\n49\nbrown\nlight\nbrown\n19.0\nfemale\nfeminine\nAlderaan\n\n\nOwen Lars\n178\n120\nbrown, grey\nlight\nblue\n52.0\nmale\nmasculine\nTatooine\n\n\nBeru Whitesun Lars\n165\n75\nbrown\nlight\nblue\n47.0\nfemale\nfeminine\nTatooine\n\n\nBiggs Darklighter\n183\n84\nblack\nlight\nbrown\n24.0\nmale\nmasculine\nTatooine\n\n\nObi-Wan Kenobi\n182\n77\nauburn, white\nfair\nblue-gray\n57.0\nmale\nmasculine\nStewjon\n\n\nAnakin Skywalker\n188\n84\nblond\nfair\nblue\n41.9\nmale\nmasculine\nTatooine\n\n\nWilhuff Tarkin\n180\nNA\nauburn, grey\nfair\nblue\n64.0\nmale\nmasculine\nEriadu\n\n\nHan Solo\n180\n80\nbrown\nfair\nbrown\n29.0\nmale\nmasculine\nCorellia\n\n\nkeskmine\n178.00000\n86.88889\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n1780.00000\n782.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nsd\n13.80016\n25.84785\n—\n—\n—\n—\n—\n—\n—\n\n\nDroid\n\n\nC-3PO\n167\n75\nNA\ngold\nyellow\n112.0\nnone\nmasculine\nTatooine\n\n\nR2-D2\n96\n32\nNA\nwhite, blue\nred\n33.0\nnone\nmasculine\nNaboo\n\n\nR5-D4\n97\n32\nNA\nwhite, red\nred\nNA\nnone\nmasculine\nTatooine\n\n\nkeskmine\n120.00000\n46.33333\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n360.00000\n139.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nsd\n40.70626\n24.82606\n—\n—\n—\n—\n—\n—\n—\n\n\nWookiee\n\n\nChewbacca\n228\n112\nbrown\nunknown\nblue\n200.0\nmale\nmasculine\nKashyyyk\n\n\nkeskmine\n228.00000\n112.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n228.00000\n112.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nsd\n—\n—\n—\n—\n—\n—\n—\n—\n—\n\n\nRodian\n\n\nGreedo\n173\n74\nNA\ngreen\nblack\n44.0\nmale\nmasculine\nRodia\n\n\nkeskmine\n173.00000\n74.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n173.00000\n74.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nsd\n—\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\n\n\n\n\nTabelist näeme, et Wookie ja Rodian liigi grupis on vaid üks esindaja, et arvutuste tegemine neil on üleliigne.\nMõlema grupi ridade liitmine käbi käsuga grand_summary_rows(). Kuigi täpsustus on tehtud, et ta arvutaks keskmised vaid kahele grupile, siis grand_summary_rows teeb arvutused kõigile gruppidele nagu vaja.\n\nstarwars|&gt;\n  slice(1:15)|&gt;\n  gt(rowname_col = \"name\", groupname_col = \"species\")|&gt;\n  summary_rows(groups = c(\"Human\", \"Droid\"),\n               columns = c(mass, height),\n               fns=list(keskmine= ~mean(., na.rm=T),\n                        summa= ~sum(., na.rm=T)))|&gt;\n  grand_summary_rows(columns = c(mass, height),\n                     fns=list(\"kõik kokku\"=~sum(., na.rm=T),\n                              \"kogu keskmine\"=~mean(., na.rm=T)))\n\n\n\n\n\n\n\n\nheight\nmass\nhair_color\nskin_color\neye_color\nbirth_year\nsex\ngender\nhomeworld\n\n\n\n\nHuman\n\n\nLuke Skywalker\n172\n77\nblond\nfair\nblue\n19.0\nmale\nmasculine\nTatooine\n\n\nDarth Vader\n202\n136\nnone\nwhite\nyellow\n41.9\nmale\nmasculine\nTatooine\n\n\nLeia Organa\n150\n49\nbrown\nlight\nbrown\n19.0\nfemale\nfeminine\nAlderaan\n\n\nOwen Lars\n178\n120\nbrown, grey\nlight\nblue\n52.0\nmale\nmasculine\nTatooine\n\n\nBeru Whitesun Lars\n165\n75\nbrown\nlight\nblue\n47.0\nfemale\nfeminine\nTatooine\n\n\nBiggs Darklighter\n183\n84\nblack\nlight\nbrown\n24.0\nmale\nmasculine\nTatooine\n\n\nObi-Wan Kenobi\n182\n77\nauburn, white\nfair\nblue-gray\n57.0\nmale\nmasculine\nStewjon\n\n\nAnakin Skywalker\n188\n84\nblond\nfair\nblue\n41.9\nmale\nmasculine\nTatooine\n\n\nWilhuff Tarkin\n180\nNA\nauburn, grey\nfair\nblue\n64.0\nmale\nmasculine\nEriadu\n\n\nHan Solo\n180\n80\nbrown\nfair\nbrown\n29.0\nmale\nmasculine\nCorellia\n\n\nkeskmine\n178\n86.88889\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n1780\n782.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nDroid\n\n\nC-3PO\n167\n75\nNA\ngold\nyellow\n112.0\nnone\nmasculine\nTatooine\n\n\nR2-D2\n96\n32\nNA\nwhite, blue\nred\n33.0\nnone\nmasculine\nNaboo\n\n\nR5-D4\n97\n32\nNA\nwhite, red\nred\nNA\nnone\nmasculine\nTatooine\n\n\nkeskmine\n120\n46.33333\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n360\n139.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nWookiee\n\n\nChewbacca\n228\n112\nbrown\nunknown\nblue\n200.0\nmale\nmasculine\nKashyyyk\n\n\nRodian\n\n\nGreedo\n173\n74\nNA\ngreen\nblack\n44.0\nmale\nmasculine\nRodia\n\n\nkõik kokku\n2541.0\n1107.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nkogu keskmine\n169.4\n79.07143\n—\n—\n—\n—\n—\n—\n—\n\n\n\n\n\n\n\n\n\nRidade rõhutamine tabelis\nMõnikord on soov juhtida tähelepanu konkreetesele reale tabelis ning siin on sobilik kasutada käsku gt_highlight_rows().\n\nstarwars|&gt;\n  head(5)|&gt;\n  gt()|&gt;\n  gt_highlight_rows(row=height==202,\n                    fill=\"lightblue\")\n\n\n\n\n\n\n\nname\nheight\nmass\nhair_color\nskin_color\neye_color\nbirth_year\nsex\ngender\nhomeworld\nspecies\n\n\n\n\nLuke Skywalker\n172\n77\nblond\nfair\nblue\n19.0\nmale\nmasculine\nTatooine\nHuman\n\n\nC-3PO\n167\n75\nNA\ngold\nyellow\n112.0\nnone\nmasculine\nTatooine\nDroid\n\n\nR2-D2\n96\n32\nNA\nwhite, blue\nred\n33.0\nnone\nmasculine\nNaboo\nDroid\n\n\nDarth Vader\n202\n136\nnone\nwhite\nyellow\n41.9\nmale\nmasculine\nTatooine\nHuman\n\n\nLeia Organa\n150\n49\nbrown\nlight\nbrown\n19.0\nfemale\nfeminine\nAlderaan\nHuman\n\n\n\n\n\n\n\n\n\nTabeli kujunduse muutmine\nVäärtuslik käsk on tab_options(), sest selle sees on võimalik muuta nii tausta värve, tabeli sisu joondust, fontide stiili ja värvi, ääriseid jms.\nKasutan siin eelmises näites tehtud tabelit ja salvestan ta esmalt koodi lihtsama jälgimise huvides eraldi objektiks “tabel”.\n\n\nCode\ntabel&lt;-starwars|&gt;\n  slice(1:15)|&gt;\n  gt(rowname_col = \"name\", groupname_col = \"species\")|&gt;\n  summary_rows(groups = c(\"Human\", \"Droid\"),\n               columns = c(mass, height),\n               fns=list(keskmine= ~mean(., na.rm=T),\n                        summa= ~sum(., na.rm=T)))|&gt;\n  grand_summary_rows(columns = c(mass, height),\n                     fns=list(\"kõik kokku\"=~sum(., na.rm=T),\n                              \"kogu keskmine\"=~mean(., na.rm=T)))\n\n\nKasutame neist mõnda, et teha eriti kirju kujunduse tabel lihtsalt selleks, et näha mis võimalused olemas on. Päriselus võiks tabelid ikka veidi rahulikumaks disainida ning kui oma ilumeelt väga ei usalda, siis on kiireim ja lihtsaim viis kasutada juba mõnda valmis stiili.\n\ntabel|&gt;\n  tab_header(title=\"Starwarsi tegelased\")|&gt;\n  tab_options(heading.align = \"left\",\n              heading.title.font.size=13,\n              column_labels.background.color = \"lightblue\",\n    table.font.color = \"blue\",\n              table.font.size = 10,\n              table.border.right.color = \"green\",\n    grand_summary_row.background.color = \"yellow\",\n              summary_row.background.color = \"lightyellow\",\n              table.background.color = \"lightgrey\")\n\n\n\n\n\n\n\nStarwarsi tegelased\n\n\n\nheight\nmass\nhair_color\nskin_color\neye_color\nbirth_year\nsex\ngender\nhomeworld\n\n\n\n\nHuman\n\n\nLuke Skywalker\n172\n77\nblond\nfair\nblue\n19.0\nmale\nmasculine\nTatooine\n\n\nDarth Vader\n202\n136\nnone\nwhite\nyellow\n41.9\nmale\nmasculine\nTatooine\n\n\nLeia Organa\n150\n49\nbrown\nlight\nbrown\n19.0\nfemale\nfeminine\nAlderaan\n\n\nOwen Lars\n178\n120\nbrown, grey\nlight\nblue\n52.0\nmale\nmasculine\nTatooine\n\n\nBeru Whitesun Lars\n165\n75\nbrown\nlight\nblue\n47.0\nfemale\nfeminine\nTatooine\n\n\nBiggs Darklighter\n183\n84\nblack\nlight\nbrown\n24.0\nmale\nmasculine\nTatooine\n\n\nObi-Wan Kenobi\n182\n77\nauburn, white\nfair\nblue-gray\n57.0\nmale\nmasculine\nStewjon\n\n\nAnakin Skywalker\n188\n84\nblond\nfair\nblue\n41.9\nmale\nmasculine\nTatooine\n\n\nWilhuff Tarkin\n180\nNA\nauburn, grey\nfair\nblue\n64.0\nmale\nmasculine\nEriadu\n\n\nHan Solo\n180\n80\nbrown\nfair\nbrown\n29.0\nmale\nmasculine\nCorellia\n\n\nkeskmine\n178\n86.88889\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n1780\n782.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nDroid\n\n\nC-3PO\n167\n75\nNA\ngold\nyellow\n112.0\nnone\nmasculine\nTatooine\n\n\nR2-D2\n96\n32\nNA\nwhite, blue\nred\n33.0\nnone\nmasculine\nNaboo\n\n\nR5-D4\n97\n32\nNA\nwhite, red\nred\nNA\nnone\nmasculine\nTatooine\n\n\nkeskmine\n120\n46.33333\n—\n—\n—\n—\n—\n—\n—\n\n\nsumma\n360\n139.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nWookiee\n\n\nChewbacca\n228\n112\nbrown\nunknown\nblue\n200.0\nmale\nmasculine\nKashyyyk\n\n\nRodian\n\n\nGreedo\n173\n74\nNA\ngreen\nblack\n44.0\nmale\nmasculine\nRodia\n\n\nkõik kokku\n2541.0\n1107.00000\n—\n—\n—\n—\n—\n—\n—\n\n\nkogu keskmine\n169.4\n79.07143\n—\n—\n—\n—\n—\n—\n—\n\n\n\n\n\n\n\n\n\nValmis stiilide kasutamine\nValmis stiilide kasutamine käib käsuga, mis algab gt_theme_* ja seejärel stiili nimi. Näiteks nytimes.\n\nstarwars|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n  gt_theme_nytimes()\n\n\n\n\n\n\n\nname\nheight\nmass\nhair_color\nskin_color\neye_color\nbirth_year\nsex\ngender\nhomeworld\nspecies\n\n\n\n\nLuke Skywalker\n172\n77\nblond\nfair\nblue\n19\nmale\nmasculine\nTatooine\nHuman\n\n\nC-3PO\n167\n75\nNA\ngold\nyellow\n112\nnone\nmasculine\nTatooine\nDroid\n\n\nR2-D2\n96\n32\nNA\nwhite, blue\nred\n33\nnone\nmasculine\nNaboo\nDroid\n\n\n\n\n\n\n\nValmis stiilide kasutamine võimaldab ikkagi rõhutada ridu.\n\nstarwars|&gt;\n  head(3)|&gt;\n  gt()|&gt;\n  gt_theme_espn()|&gt;\n  gt_highlight_rows(rows=name==\"C-3PO\",\n                    fill=\"yellow\"\n                    )\n\n\n\n\n\n\n\nname\nheight\nmass\nhair_color\nskin_color\neye_color\nbirth_year\nsex\ngender\nhomeworld\nspecies\n\n\n\n\nLuke Skywalker\n172\n77\nblond\nfair\nblue\n19\nmale\nmasculine\nTatooine\nHuman\n\n\nC-3PO\n167\n75\nNA\ngold\nyellow\n112\nnone\nmasculine\nTatooine\nDroid\n\n\nR2-D2\n96\n32\nNA\nwhite, blue\nred\n33\nnone\nmasculine\nNaboo\nDroid\n\n\n\n\n\n\n\n\n\nKiire ülevaate saamine andmestikust\nVäiksemate tabelite või andmekogude puhul toimib hästi käsk gt_plt_summary(), mis teeb kogu andmekogust joonise ning arvutab numbrilistele tunnustele keskmise, mediaani ja standardhälbe väärtuse. Kõige kasulikum on joonisel kolmas tulp, mis näitab ära kui suure osakaalu moodustavad selle tunnuse puuduvad väärtused. Näiteks “mass” tunnusel on puuduvad väärtusi kolmandik ning sünniaasta (birth year) on teada vaid pooltel.\n\nstarwars|&gt;\n  gt_plt_summary()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nstarwars\n\n\n87 rows x 11 cols\n\n\n\nColumn\nPlot Overview\nMissing\nMean\nMedian\nSD\n\n\n\n\n\n\n\n\n\n\nname\n\nAckbar, Adi Gallia, Anakin Skywalker, Arvel Crynyd, Ayla Secura, Bail Prestor Organa, Barriss Offee, BB8, Ben Quadinaros, Beru Whitesun Lars, Bib Fortuna, Biggs Darklighter, Boba Fett, Bossk, C-3PO, Captain Phasma, Chewbacca, Cliegg Lars, Cordé, Darth Maul, Darth Vader, Dexter Jettster, Dooku, Dormé, Dud Bolt, Eeth Koth, Finis Valorum, Finn, Gasgano, Greedo, Gregar Typho, Grievous, Han Solo, IG-88, Jabba Desilijic Tiure, Jango Fett, Jar Jar Binks, Jek Tono Porkins, Jocasta Nu, Ki-Adi-Mundi, Kit Fisto, Lama Su, Lando Calrissian, Leia Organa, Lobot, Luke Skywalker, Luminara Unduli, Mace Windu, Mas Amedda, Mon Mothma, Nien Nunb, Nute Gunray, Obi-Wan Kenobi, Owen Lars, Padmé Amidala, Palpatine, Plo Koon, Poe Dameron, Poggle the Lesser, Quarsh Panaka, Qui-Gon Jinn, R2-D2, R4-P17, R5-D4, Ratts Tyerel, Raymus Antilles, Rey, Ric Olié, Roos Tarpals, Rugor Nass, Saesee Tiin, San Hill, Sebulba, Shaak Ti, Shmi Skywalker, Sly Moore, Tarfful, Taun We, Tion Medon, Wat Tambor, Watto, Wedge Antilles, Wicket Systri Warrick, Wilhuff Tarkin, Yarael Poof, Yoda and Zam Wesell\n\n\n\n\n\n      87 categories\n\n0.0%\n—\n—\n—\n\n\n\n\n\nheight\n\n\n\n      66 auto264 auto\n\n6.9%\n174.6\n180.0\n34.8\n\n\n\n\n\nmass\n\n\n\n      15 auto1 kauto\n\n32.2%\n97.3\n79.0\n169.5\n\n\n\n\n\n\n\n\nhair_color\n\nnone, brown, black, white, blond, auburn, auburn, grey, auburn, white, blonde, brown, grey and grey\n\n\n\n\n\n      11 categories\n\n5.7%\n—\n—\n—\n\n\n\n\n\n\n\n\nskin_color\n\nfair, light, dark, green, grey, pale, brown, blue, blue, grey, none, orange, tan, white, white, blue, yellow, brown mottle, brown, white, fair, green, yellow, gold, green-tan, brown, green, grey, grey, blue, grey, green, yellow, grey, red, metal, mottled green, red, red, blue, white, silver, red, unknown and white, red\n\n\n\n\n\n      31 categories\n\n0.0%\n—\n—\n—\n\n\n\n\n\n\n\n\neye_color\n\nbrown, blue, yellow, black, orange, red, hazel, unknown, blue-gray, dark, gold, green, yellow, pink, red, blue and white\n\n\n\n\n\n      15 categories\n\n0.0%\n—\n—\n—\n\n\n\n\n\nbirth_year\n\n\n\n      8 auto896 auto\n\n50.6%\n87.6\n52.0\n154.7\n\n\n\n\n\n\n\n\nsex\n\nmale, female, none and hermaphroditic\n\n\n\n\n\n      4 categories\n\n4.6%\n—\n—\n—\n\n\n\n\n\n\n\n\ngender\n\nmasculine and feminine\n\n\n\n\n\n      2 categories\n\n4.6%\n—\n—\n—\n\n\n\n\n\n\n\n\nhomeworld\n\nNaboo, Tatooine, Alderaan, Coruscant, Kamino, Corellia, Kashyyyk, Mirial, Ryloth, Aleen Minor, Bespin, Bestine IV, Cato Neimoidia, Cerea, Champala, Chandrila, Concord Dawn, Dathomir, Dorin, Endor, Eriadu, Geonosis, Glee Anselm, Haruun Kal, Iktotch, Iridonia, Kalee, Malastare, Mon Cala, Muunilinst, Nal Hutta, Ojom, Quermia, Rodia, Serenno, Shili, Skako, Socorro, Stewjon, Sullust, Toydaria, Trandosha, Troiken, Tund, Umbara, Utapau, Vulpter and Zolan\n\n\n\n\n\n      48 categories\n\n11.5%\n—\n—\n—\n\n\n\n\n\n\n\n\nspecies\n\nHuman, Droid, Gungan, Kaminoan, Mirialan, Twi'lek, Wookiee, Zabrak, Aleena, Besalisk, Cerean, Chagrian, Clawdite, Dug, Ewok, Geonosian, Hutt, Iktotchi, Kaleesh, Kel Dor, Mon Calamari, Muun, Nautolan, Neimodian, Pau'an, Quermian, Rodian, Skakoan, Sullustan, Tholothian, Togruta, Toong, Toydarian, Trandoshan, Vulptereen, Xexto and Yoda's species\n\n\n\n\n\n      37 categories\n\n4.6%\n—\n—\n—\n\n\n\n\n\n\n\n\n\nMini-graafiku lisamine tabelisse\nMinigraafiku tegemiseks on vaja loendit ehk list-i. Teeme ühe loendi pikkusest.\n\n\n\n\n\n\nLoe loendite kohta rohkem peatükist töö loenditega.\n\n\n\n\nstarwars|&gt;\n  group_by(gender)|&gt;\n  summarise(\"Keskmine pikkus\"=round(mean(height, na.rm=T), 1),\n            Jaotus=list(height))|&gt;\n  gt()|&gt;\n  gt_plt_dist(Jaotus)\n\n\n\n\n\n\n\n\n\n\n\n\ngender\nKeskmine pikkus\nJaotus\n\n\n\n\nfeminine\n166.5\n\n\n\n   \n\n\n\nmasculine\n176.5\n\n\n\n   \n\n\n\nNA\n175.0\n\n\n\n   \n\n\n\n\n\n\n\n\n\n\n\n\nIannone, Richard, Joe Cheng, Barret Schloerke, Ellis Hughes, Alexandra Lauer, and JooYoung Seo. 2024. Gt: Easily Create Presentation-Ready Display Tables. https://CRAN.R-project.org/package=gt.\n\n\nMock, Thomas. 2023. gtExtras: Extending ’Gt’ for Beautiful HTML Tables. https://CRAN.R-project.org/package=gtExtras.",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Tabelite kujundamine</span>"
    ]
  },
  {
    "objectID": "16-list-loops.html",
    "href": "16-list-loops.html",
    "title": "16  Loendid ja tsüklid",
    "section": "",
    "text": "16.1 Töö loendi ehk list-iga\nSee peatükk annab ülevaate, kuidas kasutada R-is loendit (list) ja tsükleid (loops). Kasutame R-i olemasolevat andmestiku starwars, mis tuleb tidyverse paketiga kaasa.\nTavaliselt on andmed andmestikus nii, et üks andmeväli sisaldab ühte väärtust. Näiteks andmestiku tunnus name on character tüüpi ning esimeses reas on selles tulbas üks väärtus.\nclass(starwars$name)\n\n[1] \"character\"\nstarwars$name[1]\n\n[1] \"Luke Skywalker\"\nMõnikord sisaldab andmeväli aga hoopis mõnda loendit (list) ning siis on väärtusi ühes andmeväljas rohkem. Näiteks tunnus films sisaldab loendi (list) tüüpi andmeid ning andmeväli sisaldab viite erinevat väärtust.\nclass(starwars$films)\n\n[1] \"list\"\nstarwars$films[1]\n\n[[1]]\n[1] \"A New Hope\"              \"The Empire Strikes Back\"\n[3] \"Return of the Jedi\"      \"Revenge of the Sith\"    \n[5] \"The Force Awakens\"\nfilms loend näitab ära, millistes filmides antud tegelane esindatud on. Loendi kasutamine hoiab andmestiku mõnes-mõttes kompaktsena, näiteks teeme tabeli.\nstarwars|&gt;\n  select(name, films)|&gt;\n  head(3)|&gt;\n  gt()\n\n\n\n\n\n\n\nname\nfilms\n\n\n\n\nLuke Skywalker\nA New Hope, The Empire Strikes Back, Return of the Jedi, Revenge of the Sith, The Force Awakens\n\n\nC-3PO\nA New Hope, The Empire Strikes Back, Return of the Jedi, The Phantom Menace, Attack of the Clones, Revenge of the Sith\n\n\nR2-D2\nA New Hope, The Empire Strikes Back, Return of the Jedi, The Phantom Menace, Attack of the Clones, Revenge of the Sith, The Force Awakens",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Loendid ja tsüklid</span>"
    ]
  },
  {
    "objectID": "16-list-loops.html#list",
    "href": "16-list-loops.html#list",
    "title": "16  Loendid ja tsüklid",
    "section": "",
    "text": "Loendi lahti ühendamine\nSamas teeb loendi kasutamine andmestikus aga igasuguse tehnilise töö keerulisemaks. Näiteks ei saa kasutada käsku unique(), et teada saada, mis on unikaalsed filmid andmestikus. Selle käsu kasutamine loendi puhul näitab, mis on unikaalsed kombinatsioonid neist filmidest andmestikus. Seepärast on vaja esmalt eraldada loendi väärtused üksteise küljest lahti käsuga unnest(). Nii tekib andmestikku küll rohkem ridu, kuid saame kasutada samu andmeid rohkemates olukorras. Käsu unnest() kasutamisel tuleb öelda, milliseid tulpasid lahti harutama peab (cols=).\nVaatame esmalt, kuidas andmestik välja näeb pärast unnest() käsu kasutamist.\n\nstarwars|&gt;\n  select(name, mass, films)|&gt; \n  unnest(cols = c(films))|&gt; \n  head(8)\n\n# A tibble: 8 × 3\n  name            mass films                  \n  &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;                  \n1 Luke Skywalker    77 A New Hope             \n2 Luke Skywalker    77 The Empire Strikes Back\n3 Luke Skywalker    77 Return of the Jedi     \n4 Luke Skywalker    77 Revenge of the Sith    \n5 Luke Skywalker    77 The Force Awakens      \n6 C-3PO             75 A New Hope             \n7 C-3PO             75 The Empire Strikes Back\n8 C-3PO             75 Return of the Jedi     \n\n\n\nstarwars|&gt;\n  unnest(cols = c(films))|&gt;\n  nrow()\n\n[1] 173\n\n\nNüüd on lihtne jätkata “tavalise” grupeerimise ja arvutamsiega ja jooniste tegemisega.\n\nstarwars|&gt;\n  unnest(cols = c(films))|&gt;\n  group_by(films)|&gt;\n  summarise(tegelaste_arv=n())\n\n# A tibble: 7 × 2\n  films                   tegelaste_arv\n  &lt;chr&gt;                           &lt;int&gt;\n1 A New Hope                         18\n2 Attack of the Clones               40\n3 Return of the Jedi                 20\n4 Revenge of the Sith                34\n5 The Empire Strikes Back            16\n6 The Force Awakens                  11\n7 The Phantom Menace                 34\n\n\nTeeme joonise filmide kaupa soolise jaotuvuse kohta filmis. Kui siinkohal saab veel facet_wrap() käsu abil ühe koodijupiga loetava ja arusaadava pildi, siis järgmises näites see ei toimi ja vaja on kasutada tsüklit (loops).\n\nstarwars|&gt;\n  unnest(cols=c(films))|&gt;\n  filter(!is.na(gender))|&gt;\n  ggplot(aes(gender))+\n  geom_bar()+\n  facet_wrap(~films)+\n  labs(y=NULL,\n       x=NULL)+\n  theme_minimal()\n\n\n\n\n\n\n\n\nOletame, et soovime vaadata filmide kaupa tegelasi nende pikkuse järjekorras ja nii, et tegelased on soo (gender) järgi värvidega eristatud.\n\n\n\n\n\n\nTeeme esmalt selliselt pildi ja siis vaatame allpool sama asja uuesti tsükliga. Praegu tuleb pilt väga suur ning võib-olla me ei taha, et joonisel on kuvatud ka nende tegelaste nimed, kes antud filmiga seotud pole.\n\n\n\n\nstarwars|&gt;\n  unnest(cols = c(films))|&gt;\n  filter(!is.na(height))|&gt;\n  ggplot(aes(reorder(name, height), height, fill=gender))+\n  geom_col()+\n  labs(x = NULL,\n       y = \"Pikkus (cm)\")+\n  theme(legend.position = \"bottom\")+\n  coord_flip()+\n  facet_wrap(~films)\n\n\n\n\n\n\n\n\nMe saaksime teha pildi nii, et esmalt filtreerime välja filmi nime järgi need tegelased, kuid seda tuleks teha iga filmi puhul eraldi. Seitse korda sama asja kirjutada ei ole mõistlik.\n\n\nLoendi loomine\nLoendi loomiseks toimib käsk list(). Põgusalt vaatasime loendis eelmises peatükis tabelitesse mini-graafiku lisamisel. Järgmise käsu käivitamine koostaks meile loendi starwars tegelaste nimedest.\n\n#list(starwars$name)\n\nTeeme parem loendi tegelastest nende gender kaupa. Meenutuseks vaatame, kuidas on andmestikus väljad praegu.\n\nstarwars|&gt;\n  select(name, gender)|&gt;\n  head()\n\n# A tibble: 6 × 2\n  name           gender   \n  &lt;chr&gt;          &lt;chr&gt;    \n1 Luke Skywalker masculine\n2 C-3PO          masculine\n3 R2-D2          masculine\n4 Darth Vader    masculine\n5 Leia Organa    feminine \n6 Owen Lars      masculine\n\n\nLoome tunnuse käsu list() abil uue tunnused tegelased.\n\nstarwars|&gt;\n  select(name, gender)|&gt;\n  group_by(gender)|&gt;\n1  summarise(tegelased=list(name))\n\n\n1\n\nTeeme loendi. Pane tähele, et väljatrükk näitab ära kui pikk on see loend.\n\n\n\n\n# A tibble: 3 × 2\n  gender    tegelased \n  &lt;chr&gt;     &lt;list&gt;    \n1 feminine  &lt;chr [17]&gt;\n2 masculine &lt;chr [66]&gt;\n3 &lt;NA&gt;      &lt;chr [4]&gt; \n\n\nKui kasutame käsku gt(), vormindatakse väljatrükk nii, et kuvatakse kõik loendi elemendid.\n\nstarwars|&gt;\n  select(name, gender)|&gt;\n  group_by(gender)|&gt;\n  summarise(tegelased=list(name))|&gt;\n  gt()\n\n\n\n\n\n\n\ngender\ntegelased\n\n\n\n\nfeminine\nLeia Organa, Beru Whitesun Lars, Mon Mothma, Padmé Amidala, Shmi Skywalker, Ayla Secura, Adi Gallia, Luminara Unduli, Barriss Offee, Dormé, Zam Wesell, Taun We, Jocasta Nu, R4-P17, Shaak Ti, Rey, Captain Phasma\n\n\nmasculine\nLuke Skywalker, C-3PO, R2-D2, Darth Vader, Owen Lars, R5-D4, Biggs Darklighter, Obi-Wan Kenobi, Anakin Skywalker, Wilhuff Tarkin, Chewbacca, Han Solo, Greedo, Jabba Desilijic Tiure, Wedge Antilles, Yoda, Palpatine, Boba Fett, IG-88, Bossk, Lando Calrissian, Lobot, Ackbar, Arvel Crynyd, Wicket Systri Warrick, Nien Nunb, Qui-Gon Jinn, Nute Gunray, Finis Valorum, Jar Jar Binks, Roos Tarpals, Rugor Nass, Ric Olié, Watto, Sebulba, Quarsh Panaka, Darth Maul, Bib Fortuna, Ratts Tyerel, Dud Bolt, Gasgano, Ben Quadinaros, Mace Windu, Ki-Adi-Mundi, Kit Fisto, Eeth Koth, Saesee Tiin, Yarael Poof, Plo Koon, Mas Amedda, Cliegg Lars, Poggle the Lesser, Dooku, Bail Prestor Organa, Jango Fett, Dexter Jettster, Lama Su, Wat Tambor, San Hill, Grievous, Tarfful, Raymus Antilles, Tion Medon, Finn, Poe Dameron, BB8\n\n\nNA\nJek Tono Porkins, Gregar Typho, Cordé, Sly Moore",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Loendid ja tsüklid</span>"
    ]
  },
  {
    "objectID": "16-list-loops.html#töö-tsüklitega-ehk-loops-kasutamine",
    "href": "16-list-loops.html#töö-tsüklitega-ehk-loops-kasutamine",
    "title": "16  Loendid ja tsüklid",
    "section": "16.2 Töö tsüklitega ehk loops kasutamine",
    "text": "16.2 Töö tsüklitega ehk loops kasutamine\nOletame, et meil on vaja korrata ühte ja sama tegevust vähemalt kolm või neli korda. Hea tava oleks mitte kopeerida sama koodi rohkem kui kaks korda ja seepärast on hea abimees tsükkel ehk loops.\nIga tsükli puhul tuleb esmalt öelda, kui mitu korda seda tsükilt läbi teha tuleb. Me võime panna koodi jooksma küll, et tee x-tegevust viis või kümme korda, kuid päriselus sõltub alati kordade arv mingist väärtusest mõne teise tunnuse sees. Näiteks tee x tegevust iga maakonnaga eraldi läbi. Me ei pea tegema tegevust 15 korda, vaid saame R-ile ette öelda, et tee nii mitu korda kui palju on andmestikus erinevaid maakondi.\nTsüklis i - tähistab muutujat, mis määrab ära korduste arvu. (Hea kui on olemas vektor sellest, mis näitab ära tsüklite arvu.) See, mida tsükkel tegema peab käib loogeliste sulgude {} vahele. Sinna vahele kirjutame oma tavapärased käsud.\nNäiteks meil on starwars andmestikus tunnus films, mis näitab ära, millistes filmides konkreetne tegelane olnud on. Teen esmalt sellest loendist käskude unnest(), unique() ja pull() abil vektori.\n\nfilmid&lt;-starwars|&gt;\n  select(films)|&gt;\n  unnest(cols = c(films))|&gt;\n  unique()|&gt;\n  pull()\n\nVektor filmid sisaldab filmi nimesid.\n\nfilmid\n\n[1] \"A New Hope\"              \"The Empire Strikes Back\"\n[3] \"Return of the Jedi\"      \"Revenge of the Sith\"    \n[5] \"The Force Awakens\"       \"The Phantom Menace\"     \n[7] \"Attack of the Clones\"   \n\n\n\n\n\n\n\n\nTsükkel algab alati sõnaga for, sellele järgnevad sulud (), mille sees määratakse ära tsüklite kordus ning loogeliste sulgude {} sees need funktsioonid, mida üks tsükkel sisaldama peab.\n\n\n\nTeen tsükli ja ütleme talle, et korda tsüklit seni kuni oled saanud selle läbi tehtud iga filmid vektori väärtusega.\n\n\n\n\n\n\nTsüklis väljatrükk ei tule automaatselt, seepärast peame talle ütlema ka ette, et prindi tulemus.\n\n\n\nJärgmises näites on tsüklis ehk loogeliste sulgude {} sees kolm tegevust.\n\nTsükkel algab andmetsiku ettevalmistamisega, kus eraldatakse loend ja filtreeritakse välja vektor filmid esimese filmi nime järgi tegelased jms.\nTsükli teine tegevus salvestab objekti pilt filtreeritud andmetest joonise.\nKolmas ja viimane tegevus kuvab eelsalvestatud objekti pilt.\n\n\n1for (i in filmid){\n\n#tsükli algus\n#valmistan ette andmestiku pildi jaoks  \ntulem &lt;- starwars |&gt;\n    unnest(cols = c(films)) |&gt;\n2    filter(films %in% i) |&gt;\n    filter(!is.na(height)) |&gt;\n    select(name, height, gender)\n\n# teen pildi filtreeritud andmetest\npilt &lt;- ggplot(tulem, aes(x = reorder(name, height), y = height, fill = gender)) +\n    geom_col()+\n  coord_flip()+\n3  labs(title = paste(\"Pikkuse järjekorras tegelased\", i ,\"filmis\"),\n         x = NULL,\n         y = \"Pikkus (cm)\") \n\n#prindin väljatrüki ehk pildi  \nprint(pilt)\n\n#tsükli lõpp ja liigub algusesse tagasi \n}\n\n\n1\n\nMäärab ära kui mitu tsüklit on vaja. Tsükleid korratakse seni kuni vektori filmid iga väärtusega (i) on tegevused läbi tehtud.\n\n2\n\nVäärtust i kasutatakse selleks, et filtreerida andmestik väiksemaks.\n\n3\n\nVäärtust i kuvatakse pildi pealkirjas.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTeen veel ühe näite, aga kasutan nüüd tabeleid.\n\n\n\n\n\n\nQuarto põhjal dokumenti tehes ei taha tsükkel välja kuvada paketiga gtExtras (Mock 2023)tehtud tabeleid nii, et need inimsilmale loetavad oleks. Seepärast kasutan siin pakettist kableExtra(Zhu 2024) käsku kable().\n\n\n\n\nfor (i in filmid){\n  tulem&lt;-starwars|&gt;\n    unnest(cols=c(films))|&gt;\n    filter(films %in% i) |&gt;\n    filter(!is.na(height))|&gt;\n    select(name, height, gender)|&gt;\n    arrange(-height)|&gt;\n    head(3)|&gt;\n    kable(caption = paste(\"Pikkuse top 3 filmis\", i))\n  \n  print(tulem)\n}\n\n\n\nTable: Pikkuse top 3 filmis A New Hope\n\n|name            | height|gender    |\n|:---------------|------:|:---------|\n|Chewbacca       |    228|masculine |\n|Darth Vader     |    202|masculine |\n|Raymus Antilles |    188|masculine |\n\n\nTable: Pikkuse top 3 filmis The Empire Strikes Back\n\n|name        | height|gender    |\n|:-----------|------:|:---------|\n|Chewbacca   |    228|masculine |\n|Darth Vader |    202|masculine |\n|IG-88       |    200|masculine |\n\n\nTable: Pikkuse top 3 filmis Return of the Jedi\n\n|name        | height|gender    |\n|:-----------|------:|:---------|\n|Chewbacca   |    228|masculine |\n|Darth Vader |    202|masculine |\n|Boba Fett   |    183|masculine |\n\n\nTable: Pikkuse top 3 filmis Revenge of the Sith\n\n|name      | height|gender    |\n|:---------|------:|:---------|\n|Tarfful   |    234|masculine |\n|Chewbacca |    228|masculine |\n|Grievous  |    216|masculine |\n\n\nTable: Pikkuse top 3 filmis The Force Awakens\n\n|name      | height|gender    |\n|:---------|------:|:---------|\n|Chewbacca |    228|masculine |\n|Han Solo  |    180|masculine |\n|Ackbar    |    180|masculine |\n\n\nTable: Pikkuse top 3 filmis The Phantom Menace\n\n|name         | height|gender    |\n|:------------|------:|:---------|\n|Yarael Poof  |    264|masculine |\n|Roos Tarpals |    224|masculine |\n|Rugor Nass   |    206|masculine |\n\n\nTable: Pikkuse top 3 filmis Attack of the Clones\n\n|name         | height|gender    |\n|:------------|------:|:---------|\n|Lama Su      |    229|masculine |\n|Taun We      |    213|feminine  |\n|Ki-Adi-Mundi |    198|masculine |\n\n\n\n\n\n\nMock, Thomas. 2023. gtExtras: Extending ’Gt’ for Beautiful HTML Tables. https://CRAN.R-project.org/package=gtExtras.\n\n\nZhu, Hao. 2024. kableExtra: Construct Complex Table with ’Kable’ and Pipe Syntax. https://CRAN.R-project.org/package=kableExtra.",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Loendid ja tsüklid</span>"
    ]
  },
  {
    "objectID": "17-kaardid.html",
    "href": "17-kaardid.html",
    "title": "17  Ruumiandmed",
    "section": "",
    "text": "17.1 Kaardi loomine paketi sf ja geoportaali avaandmete abil\nSee peatükk annab ülevaate, kuidas teha R-is Eesti kaarti. Andmetöötluseks kasutan pakketi tidyverse(Wickham et al. 2019).\nKaardi loomiseks kasutanenamasti simple features formaati ja paketti sf(Pebesma 2018). Mitmeid kasulikke ruumiandmeid saab avaandmetena kätte Maa- ja ruumiameti geoportaalist. Toon siin näite maakondade ja omavalitsuste tasandil, aga portaalist on võimalik alla laadida ka külad, linnaosad jne.\nlibrary(\"sf\")\nLae alla maakondade ja omavalitsuste andmed SHP formaadis Maa- ja ruumiameti geoportaalist. Tõsta lahtipakitud kataloogid oma projektikausta ja ära kustuta sellest kaustast ühtegi faili.\nAndmestike kirjeldus asub samal lehel.\nAndmete (see tähendab .shp faili) sisselugemine käib käsuga st_read(). Loen sisse andmed kaustast “maakond_shp” ja “omavalitsus_shp” ning salvestan need vastavalt “maakond” ja “vald” nimelisse objekti.\nmaakond&lt;-st_read(\"maakond_shp/maakond.shp\")\n\nReading layer `maakond' from data source \n  `/Users/kristiloide/R-asjad/andmetuba_quatro/maakond_shp/maakond.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 369033.8 ymin: 6377141 xmax: 739152.8 ymax: 6634019\nProjected CRS: Estonian Coordinate System of 1997\nvald&lt;-st_read(\"omavalitsus_shp/omavalitsus.shp\")\n\nReading layer `omavalitsus' from data source \n  `/Users/kristiloide/R-asjad/andmetuba_quatro/omavalitsus_shp/omavalitsus.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 79 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 369033.8 ymin: 6377141 xmax: 739152.8 ymax: 6634019\nProjected CRS: Estonian Coordinate System of 1997\nVaatan objekti “maakond”. Vaikimisi kuvab esimesed 10 rida.\nmaakond\n\nSimple feature collection with 15 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 369033.8 ymin: 6377141 xmax: 739152.8 ymax: 6634019\nProjected CRS: Estonian Coordinate System of 1997\nFirst 10 features:\n              MNIMI MKOOD    EKSPORT                       geometry\n1     Saare maakond  0074 2025-03-01 MULTIPOLYGON (((456704.6 64...\n2  Viljandi maakond  0084 2025-03-01 MULTIPOLYGON (((620926.9 64...\n3      Hiiu maakond  0039 2025-03-01 MULTIPOLYGON (((418048.7 65...\n4     Harju maakond  0037 2025-03-01 MULTIPOLYGON (((504776 6570...\n5     Rapla maakond  0071 2025-03-01 MULTIPOLYGON (((504136.5 65...\n6  Ida-Viru maakond  0045 2025-03-01 MULTIPOLYGON (((714923.3 65...\n7     Valga maakond  0081 2025-03-01 MULTIPOLYGON (((622138.8 64...\n8     Tartu maakond  0079 2025-03-01 MULTIPOLYGON (((702396 6476...\n9      Võru maakond  0087 2025-03-01 MULTIPOLYGON (((714351.2 64...\n10    Pärnu maakond  0068 2025-03-01 MULTIPOLYGON (((521030.7 64...\nSisuliselt saab sellele andmetabelil teha kõiki operatsioone, mida saab teha “tavalise” andmetabeliga. Näiteks filtreerin välja need vallad, mis asuvad Saare maakonnas.\nvald|&gt;\n  filter(MNIMI== \"Saare maakond\")\n\nSimple feature collection with 3 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 369033.8 ymin: 6404447 xmax: 467746.5 ymax: 6505349\nProjected CRS: Estonian Coordinate System of 1997\n          ONIMI OKOOD         MNIMI MKOOD TYYP    EKSPORT\n1 Saaremaa vald  0714 Saare maakond  0074    1 2025-03-01\n2    Ruhnu vald  0689 Saare maakond  0074    1 2025-03-01\n3     Muhu vald  0478 Saare maakond  0074    1 2025-03-01\n                        geometry\n1 MULTIPOLYGON (((383803.2 64...\n2 MULTIPOLYGON (((456704.6 64...\n3 MULTIPOLYGON (((463402.3 64...\nNäha on, et Saare maakonnas asub kolm valda: Saaremaa, Ruhnu ja Muhu.",
    "crumbs": [
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Ruumiandmed</span>"
    ]
  },
  {
    "objectID": "17-kaardid.html#sf",
    "href": "17-kaardid.html#sf",
    "title": "17  Ruumiandmed",
    "section": "",
    "text": "sf andmed on esitatud tabeli kujul, kus üks tunnus on geometry. Tunnus geometry võib olla kujul POINT, LINE, POLYGON, MULTIPOINT, MULTILINE ja MULTIPOLYGON. Iga sf objekt sisaldab vaid ühte tüüpi geometry elemente.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nKaardi loomine\nKaardi loomisel on vaja kasutada erinevaid kihte. Kui sa pole varem R-is jooniseid teinud, vaata peatükki Joonised ning tutvu ggplot loogikaga.\nsf formaadis andmeid saab visualiseerida käsuga ggplot(), geomeetriana peab kasutama käsku geom_sf().\n\nmaakond|&gt;\n  ggplot()+\n  geom_sf()\n\n\n\n\n\n\n\n\n\n\nJoonisele siltide lisamine ja ggrepel pakett\nKäskude geom_sf_label() ja geom_sf_text() abil saab lisada kaardile teksti. Oletame, et soovin kuvada kaartidel maakonna nime.\n\nmaakond|&gt;\n  ggplot()+\n  geom_sf()+\n1  geom_sf_label(aes(label=MNIMI))\n\n\n1\n\nLisab kaardile maakonna nime, tekst jääb musta raami valge taustaga\n\n\n\n\n\n\n\n\n\n\n\n\nmaakond|&gt;\n  ggplot()+\n  geom_sf()+\n1  geom_sf_text(aes(label=MNIMI))\n\n\n1\n\nLisab kaardile maakonna nime ilma raami ja taustata.\n\n\n\n\n\n\n\n\n\n\n\nMõnikord on tekst siltide jaoks liiga pikk. Paketi ggrepel(Slowikowski 2024) abil on võimalik üpris mugavalt teksti asetada joonisele silte nii, et nad ei tule üksteise peale.\n\nlibrary(ggrepel)\n\nEsmalt loon käskude st_coordinates() ja st_centroid() abil maakonna koordinaatidest maakonna keskpunkti.\n\n\n\n\n\n\nVaata ka käsu st_centroid() kasutamist allpool toodud näites.\n\n\n\n\nmaakond_keskpunkt &lt;- cbind(maakond, st_coordinates(st_centroid(maakond)))\n\nWarning: st_centroid assumes attributes are constant over geometries\n\n\nSeejärel asetan käsu geom_label_repel abil joonise sildid maakonna keskpunktidele.\n\n ggplot(maakond) +\n  geom_sf() +\n  geom_label_repel(data = maakond_keskpunkt,\n                   aes(X, Y, label = MNIMI),\n                   size = 3)\n\n\n\n\n\n\n\n\nOletame, et soovin sildid lisada vaid Hiiu ja Põlva maakonnale. Esmalt on vaja valmis joonistada kaart, seejärel lisada sildid ja siltide lisamisel kasutada filter() käsku, et piirata joonisele kuvatavaid andmeid.\n\nmaakond|&gt;\n  ggplot()+\n  geom_sf()+\n1  geom_sf_label(aes(label=MNIMI),\n2                data = ~.x |&gt;\n                  filter(MNIMI %in% c(\"Hiiu maakond\", \"Põlva maakond\")))\n\n\n1\n\nLisan valmis kaardile sildid (label)\n\n2\n\nKuid filtreerin välja, et soovin sildid lisada vaid neile andmetele\n\n\n\n\n\n\n\n\n\n\n\n\n\nTeemade kasutamine kaartidel\nKaardi lõppu tuleb lisada +theme_*. Teemad on:\n\ntheme_gray()\ntheme_bw()\ntheme_linedraw()\ntheme_light()\ntheme_dark()\ntheme_minimal()\ntheme_classic()\ntheme_void() - sobib kasutada, kui ei ole soov kasutada kooridnaate taustal\ntheme_test()\n\n\nmaakond|&gt;\n  ggplot()+\n  geom_sf()+\n  theme_void()\n\n\n\n\n\n\n\n\n\nvald|&gt;\n  filter(MNIMI==\"Tartu maakond\")|&gt;\n  ggplot()+\n  geom_sf()+\n  theme_void()\n\n\n\n\n\n\n\n\n\n\nOma andmete lisamine kaardile\nKasutan näites loomuliku iive näitajat maakonna kohta. Andmed on võetud statistikaameti tabelist RV030. Mul on andmestikus kaks tunnust, maakonnad ja iive.\n\niive&lt;-read_csv2(\"loomulik_iive.csv\")\n\n\niive|&gt;\n  head(3)\n\n# A tibble: 3 × 2\n  maakond          loomulik_iive\n  &lt;chr&gt;                    &lt;dbl&gt;\n1 Harju maakond             -653\n2 Hiiu maakond               -68\n3 Ida-Viru maakond         -1448\n\n\n\n\n\n\n\n\nOma andmestik tuleb liita alati sf objekti külge ja mitte vastupidi. Kasuta liitmisel veergude nimesid, mis on sf objekti küljes.\n\n\n\n\n1andmed&lt;-iive |&gt;\n2  rename(MNIMI = maakond)|&gt;\n3    left_join(maakond)\n\n\n1\n\nTeen andmestikust “iive” uue objekti “andmed”\n\n2\n\nSeejärel muudan veeru nime “maakond” ja uus nimi on “MNIMI”, sest nii on see “maakond” objektis\n\n3\n\nSeejärel liidan sf objekti maakond andmetele juurde\n\n\n\n\nJoining with `by = join_by(MNIMI)`\n\n\nLiidetud andmestik näeb välja nüüd nii. Lisandunud on nüüd MKOOD, EKSPORT ja geometry tunnused.\n\nandmed|&gt;\n  head(3)\n\n# A tibble: 3 × 5\n  MNIMI            loomulik_iive MKOOD EKSPORT                          geometry\n  &lt;chr&gt;                    &lt;dbl&gt; &lt;chr&gt; &lt;date&gt;                 &lt;MULTIPOLYGON [m]&gt;\n1 Harju maakond             -653 0037  2025-03-01 (((504776 6570563, 504787.5 6…\n2 Hiiu maakond               -68 0039  2025-03-01 (((418048.7 6506295, 418045.4…\n3 Ida-Viru maakond         -1448 0045  2025-03-01 (((714923.3 6544236, 714913.9…\n\n\nKuvan kaardile loomuliku iive näitajad maakonnas.\n\nandmed|&gt;\n  ggplot()+\n  geom_sf(aes(geometry=geometry, fill=loomulik_iive))+\n  geom_sf_text(aes(geometry=geometry, label=loomulik_iive))+\n  theme_void()\n\n\n\n\n\n\n\n\n\n\nVärvide kujundamine kaardil\nKäsuga scale_fill_fermenter() saan muuta maakondade värve vastavalt loomulik_iive väärtusele. typ=\"seq\" saab panna ka “qual” (qualitative) või “div” (diverging).\nTeen sama kaardi, aga kasutan kahel erienval moel teksti maakonna keskpunktile panemist. Siin kaardil kasutan st_centroid() käsku geom_sf_text() käsu sees.\n\nandmed |&gt;\n  ggplot() +\n  geom_sf(aes(geometry = geometry, fill = loomulik_iive)) +\n  geom_sf_text(\n    data = andmed |&gt; mutate(geometry = st_centroid(geometry)),  #&lt;1&gt; keskpunktid tekstile\n    aes(geometry = geometry, label = loomulik_iive),\n    size = 3\n  ) +\n  scale_fill_fermenter(type = \"seq\") +\n  theme_void()\n\n\n\n\n\n\n\n\nSiin aga teen esmalt eraldi andmestiku tekstikohad ning joonist tehes kasutan korraga nii andmestikku “andmed” kui “tekstikohad”.\n\ntekstikohad &lt;- andmed |&gt; \n  mutate(geometry = st_centroid(geometry))\n\n\nggplot() +\n  geom_sf(data = andmed, aes(geometry = geometry, fill = loomulik_iive)) +\n  geom_sf_text(data = tekstikohad, aes(geometry = geometry, label = loomulik_iive), size = 3) +\n  scale_fill_fermenter(type = \"qual\") +\n  theme_void()\n\nWarning: Using a discrete colour palette in a binned scale\nℹ Consider using `type = \"seq\"` or `type = \"div\"` instead\n\n\n\n\n\n\n\n\n\n\n\n\n\nPebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” The R Journal 10 (1): 439–46. https://doi.org/10.32614/RJ-2018-009.\n\n\nSlowikowski, Kamil. 2024. Ggrepel: Automatically Position Non-Overlapping Text Labels with ’Ggplot2’. https://doi.org/10.32614/CRAN.package.ggrepel.\n\n\nWickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the tidyverse.” Journal of Open Source Software 4 (43): 1686. https://doi.org/10.21105/joss.01686.",
    "crumbs": [
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Ruumiandmed</span>"
    ]
  },
  {
    "objectID": "18-masinope.html",
    "href": "18-masinope.html",
    "title": "18  Masinõpe - otsustuspuud ning metsad",
    "section": "",
    "text": "18.1 Kasutatavad andmed\nSee peatükk annab ülevaate, kuidas masinõppe abil R-is klassifitseerida erinevaid andmeid ja luua otsustuspuid ja -metsa.\nOtsustuspuu (decision tree) on masinõppe meetod, mida kasutatakse klassifitseerimiseks või regressiooniks. Klassifitseerimisülesandes püütakse ennustada kategoorilist tulemit (nt kas inimene kuulub ühte või teise gruppi). Regressiooni puhul ennustatakse arvulist väärtust (mitte kategooriat).\nKasutan Euroopa Sotsiaaluuringu andmeid ning andmete töötlemiseks paketti tidyverse (Wickham et al. 2019). Mudeli loomiseks kasutan järgmisi tunnuseid:\nPrognoositav tunnuseks on toimetulek. Kui soovid vaadata andmetöötluse töökäiku, vajuta “code” hallil kolmnurgal.\nlibrary(tidyverse)\nCode\nandmed&lt;-read_csv(\"ESS9e03_2-ESS10-subset.csv\")\n\n\n# sissetuleku liik\nandmed&lt;-andmed|&gt;\n  mutate(hincsrca=case_when(\n    hincsrca==1 ~ \"Wages or salaries\",\n    hincsrca==2 ~ \"Income from self-employment (excluding farming)\",\n    hincsrca==3 ~ \"Income from farming\",\n    hincsrca== 4 ~ \"Pensions\", \n    hincsrca== 5 ~ \"Unemployment/redundancy benefit\",\n    hincsrca == 6 ~ \"Any other social benefits or grants\",\n    hincsrca == 7 ~ \"Income from investments, savings etc.\",\n    hincsrca == 8 ~ \"Income from other sources\",\n    TRUE ~ NA\n  ))\n\n# laste arv leibkonnas\nandmed&lt;-andmed|&gt;\n  mutate(chldhhe=case_when(\n    chldhhe==1 ~ \"Jah\",\n    chldhhe==2 ~ \"Ei\",\n    TRUE ~ NA\n  ))\n\n# elukohatüüp\nandmed&lt;-andmed|&gt;\n  mutate(domicil=case_when(\n    domicil==1  ~ \"A big city\",\ndomicil==2 ~    \"Suburbs or outskirts of big city\",\ndomicil==3 ~    \"Town or small city\",\ndomicil==4 ~    \"Country village\",\ndomicil==5 ~    \"Farm or home in countryside\",\nTRUE ~ NA\n  ))\n\n# leibkonna liikmete arv\nandmed$hhmmb[andmed$hhmmb &gt; 11] &lt;- NA\n\n# sugu\nandmed&lt;-andmed%&gt;%\n  mutate(gndr=ifelse(gndr==1, \"Mees\", \"Naine\"))\n\n# toimetulek\nandmed&lt;-andmed%&gt;%\n  mutate(hincfel=case_when(\n    hincfel==1 ~ \"Elame mugavalt praeguse sissetuleku juures\",\n    hincfel==2 ~ \"Saame hakkama praeguse sissetuleku juures\",\n    hincfel==3 ~ \"Praeguse sissetuleku juures on raske hakkama saada\",\n    hincfel==4 ~ \"Praeguse sissetuleku juures on väga raske hakkama saada\",\n    TRUE ~ NA\n  ))\n\n#Lihtsuse huvides kodeerin veel tunnuse kaheks. Inimesed jaotuvad nüüd toimetulevatekss ja nendeks, kel on oma praeguse sissetuleku juures raske toime tulla.\n\nandmed&lt;-andmed|&gt;\n  mutate(toimetulek=case_when(\n    hincfel == \"Elame mugavalt praeguse sissetuleku juures\" |\n      hincfel == \"Saame hakkama praeguse sissetuleku juures\" ~ \"toimetulev\",\n    hincfel == \"Praeguse sissetuleku juures on raske hakkama saada\" | hincfel == \"Praeguse sissetuleku juures on väga raske hakkama saada\" ~ \"toimetulematu\"\n  ))\nCode\nlevels(andmed$toimetulek)\n\n\nNULL\nCode\nandmed&lt;-andmed%&gt;%\n    mutate(across(where(is.character), as.factor))",
    "crumbs": [
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Masinõpe - otsustuspuud ning metsad</span>"
    ]
  },
  {
    "objectID": "18-masinope.html#kasutatavad-andmed",
    "href": "18-masinope.html#kasutatavad-andmed",
    "title": "18  Masinõpe - otsustuspuud ning metsad",
    "section": "",
    "text": "vanus (agea) - numbriline väärtus\nsugu (gndr) - Mees/Naine\nelukoht (domicil) - 5 erinevat kategooriat\nlaste olemasolu leibkonnas (chldhhe) - Jah/Ei\npeamine sissetulekuallikas (hincsrca) - 8 erinevat kategooriat\n\n\n\n\n\n\n\nTreening- ja testandmestiku loomine\nMasinõppes on vaja treeningandmestikku, mille peal mudelit treenida ning seejärel testandmestikku, et mudeli paikapidavust testida. Teen esmalt treeningandmestiku, kus võtan põhiandmestikust 75% andmeid. Kasutan selleks käsku sample_frac(). Korduvate tulemuste saamiseks sean nn pidepunkti käsu set.seed() abil.\n\nset.seed(1234)\n\n\ntreening &lt;- andmed|&gt;\n  sample_frac(0.75) \n\nSeejärel loon testandmestikku, võttes käsuga anti_join() andmestikust ülejäänud 25% andmetest, mis pole treeningandmestikus.\n\ntest&lt;-andmed|&gt;\n  anti_join(treening, by=\"idno\")\n\nNüüd on otsustuspuu mudeli jaoks olemas sobiv treening- ja testandmestik.",
    "crumbs": [
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Masinõpe - otsustuspuud ning metsad</span>"
    ]
  },
  {
    "objectID": "18-masinope.html#otsutuspuu-töö-põhimõte",
    "href": "18-masinope.html#otsutuspuu-töö-põhimõte",
    "title": "18  Masinõpe - otsustuspuud ning metsad",
    "section": "18.2 Otsutuspuu töö põhimõte",
    "text": "18.2 Otsutuspuu töö põhimõte\nOtustuspuu mudel treenitakse valmis treeningandmestiku peal. Otsustuspuu jagab andmestiku järjestikuste valikute abil harudeks, mis põhinevad seletavatel tunnustel. Need hargnemiskohad on nn “sõlmed” (nodes). Igas “sõlmes” otsustab mudel, milline tunnus ja milline väärtus võimaldab kõige paremini eristada klasse.\nPuu algab kõigi andmetega. Mudel otsib sellelt tasemelt parima tunnuse, mis jagab andmed kõige puhtamalt kaheks (ehk mille alusel inimesed jaotuvad toimetulevateks ja mitte-toimetulevateks kõige selgemini eristuvamalt). Tekib esimene “sõlmpunkt”, kus tehakse esimene hargnemine. Seejärel kordub igas harus sama kuni kõik andmed on jaotunud või kui hargnemistele seatud piirangud on saavutatud.\nMudeli tugevused:\n\nLihtne tõlgendada (inimloetav struktuur)\nMudel saab hakkama nii numbriliste kui ka kategooriliste andmetega\nMudel ei vaja andmete standardiseerimist\nMudeliga saab avastada mittelineaarseid seoseid\n\nOtsustuspuu mudeli headust hinnatakse testandmestiku abil.\nMudeli puudused:\n\nÜleõppimise (overfitting) oht – puu võib õppida pähe müra või ebaolulisi mustreid\nVäikeste muutuste korral andmestikus võib puu struktuur drastiliselt muutuda\n\nOtsustuspuu kvaliteedi (usaldusväärsuse) määramisel tuleb vaadata mudeli ennustustäpsust, üldistamisvõimet ja lihtsust. Kui treeningandmetel on mudeli täpsus väga kõrge (nt 95%) ja testandmetel madal (nt 70%), on tegemist üleõppimisega (overfitting).\nÜldistusvõimet saab hinnata (area under the curve) ehk AUC näita abil.\n\nAUC &gt; 0.5 = nõrk, pigem juhuslik jaotus\nAUC &gt; 0.7 = aksepteeritav\nAUC &gt; 0.8 = hea\nAUC &gt; 0.9 = väga hea\n\nMudeli headuse hindamiseks tasub vaada kui täpselt (accuracy) mudel suudab ennustada. See tähendab, et kui palju on õigeid ja valesid ennustusi. Vaatama peaks ka kui tundlik (sensitivity) mudel on ehk kui hästi mudel tuvastab neid, kes ei tule toime ning kui kui hästi mudel tunneb ära need, kes tulevad toime. Esmalt teeme aga mudeli ja siis testime mudelite headust.",
    "crumbs": [
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Masinõpe - otsustuspuud ning metsad</span>"
    ]
  },
  {
    "objectID": "18-masinope.html#rpart",
    "href": "18-masinope.html#rpart",
    "title": "18  Masinõpe - otsustuspuud ning metsad",
    "section": "18.3 Otsustuspuu paketiga rpart",
    "text": "18.3 Otsustuspuu paketiga rpart\n\nlibrary(rpart)\n\nOtsustuspuu mudelit on võimalik luua paketi rpart (Therneau and Atkinson 2025) käsu rpart() abil. Esmalt on vaja öelda prognoositav tunnus ning seejärel pärast tildet (~) lisada seletavad tunnused, mida mudelis kasutada.\nSalvestan mudeli eraldi objekti nimega “puu”.\n\npuu&lt;-rpart(toimetulek ~ agea + gndr + domicil + chldhhe + hincsrca,\n1           data = treening,\n2           method = \"class\")\n\n\n1\n\nOtsuspuu mudeli jaoks kasutame treeningandmestikku.\n\n2\n\nMääran ära mudeli tüübi ehk klassifitseerimise\n\n\n\n\n\nMudeli tulemuste tõlgendamine\n\npuu\n\nn= 2584 \n\nnode), split, n, loss, yval, (yprob)\n      * denotes terminal node\n\n1) root 2584 520 toimetulev (0.2012384 0.7987616)  \n  2) hincsrca=Any other social benefits or grants,Pensions,Unemployment/redundancy benefit 786 286 toimetulev (0.3638677 0.6361323)  \n    4) agea&lt; 63.5 156  70 toimetulematu (0.5512821 0.4487179)  \n      8) agea&gt;=48.5 96  34 toimetulematu (0.6458333 0.3541667) *\n      9) agea&lt; 48.5 60  24 toimetulev (0.4000000 0.6000000) *\n    5) agea&gt;=63.5 630 200 toimetulev (0.3174603 0.6825397) *\n  3) hincsrca=Income from farming,Income from investments, savings etc.,Income from other sources,Income from self-employment (excluding farming),Wages or salaries 1798 234 toimetulev (0.1301446 0.8698554) *\n\n\nSaame objekti, mis kirjeldab meile kogu puu ära. Vaatama peab mida parasjagu mudel ennustab, kas toimetulekut või toimetulematust. Puu lõpp-sõlm on tähistatud tärniga (*).\nTulemuste tõlgendamine:\n\nPuu juur (root ehk väljatrükis rida, mis algab 1)) ehk esimene hargnemine prognoosib toimetulekut. Treeningandmestik jaotab 20,1% toimetulematuteks ning 79,8% toimetulevateks. Esimene hargnemine tehakse sissetulekuliigi (tunnus hincsrca) järgi.\n\n\n\nOtsustuspuu mudeli testimine\nMudelit headust testin testandmestiku peal. Esmalt kasutan käsku predict(), et ennustada mudeli abil.\n\npredict() on funktsioon, mis võimaldab olemasoleva mudeli (siin näites puu) abil teha ennustusi uute andmete kohta.\nnewdata = test ütleb, et ennustused tehakse andmestiku test ridade kohta, kasutades samu tunnuseid (vanus, sissetulek, varasemad_probleemid), mis mudeli loomiselgi.\ntype = \"prob\" määrab, et tagastatakse iga klassi tõenäosused, mitte lihtsalt klass ennustus. Kui type = \"prob\", siis väljundiks on maatriks, kus iga rida vastab ühele vaatlusele test andmestikus ning iga veerg ühele klassile. [ ,2 ] võtab sellest maatriksist teise veeru, st iga vaatluse puhul tõenäosuse, et ta kuulub teise klassi. Näiteks sihtmuutuja (toimetulek) on kahendmuutuja (0 ja 1), annab type=\"prob\" tulemuseks maatriks kahe veeruga. Esimene veerg: tõenäosus, et vaatlus kuulub esimesse klassi (0). Teine veerg: tõenäosus, et vaatlus kuulub teise klassi (1).\n\n\ntest2&lt;-test|&gt;\n  mutate(ennustatud=predict(puu, newdata = test, type=\"prob\")[,2],\n         klass=if_else(ennustatud&gt;0.5, \"toimetulev\", \"toimetulematu\"),\n         kontroll=if_else(toimetulek==klass, 1, 0))\n\nNüüd vaatan testi tulemusi.\n\ntest2|&gt;\n  summarise(kokku_ennustatud=n(),\n            oiged_ennustused=sum(kontroll, na.rm=T),\n            tapsus_protsent=round(mean(kontroll, na.rm=T)*100))\n\n# A tibble: 1 × 3\n  kokku_ennustatud oiged_ennustused tapsus_protsent\n             &lt;int&gt;            &lt;dbl&gt;           &lt;dbl&gt;\n1              848              681              80\n\n\nSaan teada, et 848-st ennustusest on õigesti ennustatud 80% ehk 681 inimese tulemused.\n\n\nMudeli headuse testimine paketi pROC abil\n\nlibrary(pROC)\n\n\nprob &lt;- predict(puu, newdata = test)[,2] \n\n\nroc_kover &lt;- roc(test$toimetulek, prob)\n\nSetting levels: control = toimetulematu, case = toimetulev\n\n\nSetting direction: controls &lt; cases\n\n\n\nplot(roc_kover)\n\n\n\n\n\n\n\n\n\nauc(roc_kover) \n\nArea under the curve: 0.6598\n\n\n\n\nMudeli visualiseerimine paketiga rattle\nOtsustuspuu tulemust võib olla parem tõlgendada graafiku abil. Kasutan paketti rattle(Williams 2011) ning käsku fancyRpartPlot().\n\nlibrary(rattle)\n\n\nfancyRpartPlot(puu)\n\n\n\n\n\n\n\n\n\n\n18.3.1 Mudeli visualiseerimine paketiga rpart.plot\nLihtsama joonise otsustuspuust saab paketiga rpart.plot (Milborrow 2024) ning käsk on rpart.plot().\n\nlibrary(rpart.plot)\n\n\nrpart.plot(puu)\n\n\n\n\n\n\n\n\nSoovi korral võib\n\nrpart.plot(puu, type = 4, extra = 104)",
    "crumbs": [
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Masinõpe - otsustuspuud ning metsad</span>"
    ]
  },
  {
    "objectID": "18-masinope.html#randomForest",
    "href": "18-masinope.html#randomForest",
    "title": "18  Masinõpe - otsustuspuud ning metsad",
    "section": "18.4 Otsustusmets paketiga randomForest",
    "text": "18.4 Otsustusmets paketiga randomForest\nRandomForest on masinõppe meetod, mis kasutab mitut otsustuspuud, et teha täpsemaid klassifitseerimis- või regressiooniprognoose.\nJätkan klassifitseerimisülesandega, kus prognoosin, kas inimene tuleb oma sissetulekuga toime või mitte. Otsustusmetsa loomiseks kasutan paketi randomForest (Liaw and Wiener 2002) ning käsku randomForest().\n\nlibrary(randomForest)\n\nOtsustmest ei soovi puuduvaid väärtusi. Eemaldan treeningandmestikust need vaatlused, kus esineb puuduvaid väärtusi. Loe puuduvate väärtuste kohta peatükist Puuduvad väärtused\n\ntreening&lt;-treening|&gt;\n  select(toimetulek, gndr, agea, domicil, chldhhe, hincsrca)|&gt;\n  na.omit()\n\nTeen otsustusmetsa ülesehituselt on sama, mis otsuspuu puhul.\n\nSõltuv tunnus: toimetulek\nSeletavad tunnused: agea (vanus), gndr (sugu), domicil (elukoha tüüp), chldhhe (laste olemasolu leibkonnas), hincsrca (sissetulekuallikad).\n\nKuid nüüd määran ära, et soovin, et metsas oleks 500 puud ning ta salvestaks ka loodud puud.\n\nmets &lt;- randomForest(toimetulek ~ agea + gndr + domicil + chldhhe + hincsrca, \n  data = treening,\n  ntree = 500, \n  keep.forest = TRUE\n)\n\n\nmets\n\n\nCall:\n randomForest(formula = toimetulek ~ agea + gndr + domicil + chldhhe +      hincsrca, data = treening, ntree = 500, keep.forest = TRUE) \n               Type of random forest: classification\n                     Number of trees: 500\nNo. of variables tried at each split: 2\n\n        OOB estimate of  error rate: 21.38%\nConfusion matrix:\n              toimetulematu toimetulev class.error\ntoimetulematu            55        322  0.85411141\ntoimetulev               38       1269  0.02907422\n\n\nMudeli väljatrükk annab järgmise info:\n\nNo. of variables tried at each split: 2: igas puu harunemiskohas arvestati juhuslikult valitud 2 muutujaga.\nOOB estimate of error rate: 21.5% See on mudeli üldine veamäär, mis arvutati nn “out-of-bag” (OOB) meetodil. See tähendab, et 21,5% juhtudel ennustas mudel toimetulekut valesti treeningandmetel, mida iga puu ei näinud.\nConfusion matrix. Rida näitab, et ennustas toimetulematu ning ennustus õigesti 53 inimest. Ennustas toimetulematu, aga oli toimetulev 324 inimest. Class.error näitab veamäära. Toimetulematu veamäär on 86% ehk väga halb täpsus. Toimetulemise ennustamisel on veamäär 2% ehk väga hea täpsus.\n\nEhk siis loodud mudel suudab väga hästi ära tunda neid, kes saavad oma sissetulekuga hakkama (klass “toimetulev”). Mudelil on raskusi nende tuvastamisega, kes ei saa hakkama (“toimetulematu”): enamik neist klassifitseeritakse valesti kui “toimetulev”. Selline tulemus võib viidata sellele, et andmestikus on klasside jaotus tasakaalust väljas (ehk enamik inimesi on toimetulevad) või valitud tunnused ei erista piisavalt hästi neid, kes ei saa hakkama.\nVaatame üle oma algandmestiku.\n\nandmed|&gt;\n  group_by(toimetulek)|&gt;\n  summarise(n=n())\n\n# A tibble: 3 × 2\n  toimetulek        n\n  &lt;fct&gt;         &lt;int&gt;\n1 toimetulematu   688\n2 toimetulev     2757\n3 &lt;NA&gt;              1\n\n\nSelgub, et meil on andmestik kaldu ehk enamik inimesi on “toimetulev” grupis.\n\nTunnuste tähtsuse tõlgendus\nKäsuga improtance() saab vaadata kui suurt rolli mõni tunnus toimetuleku ennustamisel mudelis mängib.\n\nimportance(mets)\n\n         MeanDecreaseGini\nagea            104.19618\ngndr             12.01528\ndomicil          29.23290\nchldhhe          10.79367\nhincsrca         55.19701\n\n\nSelgub, et kõige tähtsam tunnus on vanus (agea), mis mõjutab tugevalt toimetuleku ennustamist. Kõige vähem tähtsam on laste olemasolu leibkonnas (chdhhe) ning sugu (gndr). Mõõdukalt oluline on elukoha tüüp (domicil) ning oluline tunnus on sissetuleku liik (hincsrca), aitab ennustada toimetuleku.\nTasuks teha uusi mudeleid ja eemaldada mudelist neid tunnuseid, mida mudel tähtsaks ei pea (nt laste olemasolu leibkonnas ning sugu).\n\n\nOtsutusmetsa tulemuste visualiseerimine\nOtsustusmetsa on visualiseerimiseks on käsk varImpPlot().\n\nvarImpPlot(mets) \n\n\n\n\n\n\n\n\n\ntest3 &lt;- test2 |&gt;\n1  mutate(ennustatud= predict(mets, newdata = test2, type = \"prob\")[,2],\n2    ennustatud_klass = ifelse(ennustatud &gt; 0.5, \"toimetulev\", \"toimetulematu\"),\n3    ennustatud_oige = ifelse(toimetulek == ennustatud_klass, 1, 0))\n\n\n1\n\nTõenäosus klassile “toimetulev”\n\n2\n\nLihtne lävend 0.5\n\n3\n\nKas klassifitseeriti õigesti\n\n\n\n\n\ntest3|&gt; \n  summarise(keskmine_toenaosus = mean(ennustatud_oige, na.rm=T), \n    oiged_ennustused = sum(ennustatud_oige, na.rm=T),\n    kokku_ennustusi=n(),\n    oigete_osakaal=oiged_ennustused/kokku_ennustusi\n  )\n\n# A tibble: 1 × 4\n  keskmine_toenaosus oiged_ennustused kokku_ennustusi oigete_osakaal\n               &lt;dbl&gt;            &lt;dbl&gt;           &lt;int&gt;          &lt;dbl&gt;\n1              0.790              441             848          0.520\n\n\nÕigeid ennustusi on 52%. Ei ole oluliselt parem kui huupi pakkumine.\n\n\n\n\nLiaw, Andy, and Matthew Wiener. 2002. “Classification and Regression by randomForest.” R News 2 (3): 18–22. https://CRAN.R-project.org/doc/Rnews/.\n\n\nMilborrow, Stephen. 2024. Rpart.plot: Plot ’Rpart’ Models: An Enhanced Version of ’Plot.rpart’. https://doi.org/10.32614/CRAN.package.rpart.plot.\n\n\nTherneau, Terry, and Beth Atkinson. 2025. “Rpart: Recursive Partitioning and Regression Trees.” https://doi.org/10.32614/CRAN.package.rpart.\n\n\nWickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the tidyverse.” Journal of Open Source Software 4 (43): 1686. https://doi.org/10.21105/joss.01686.\n\n\nWilliams, Graham J. 2011. Data Mining with Rattle and R: The Art of Excavating Data for Knowledge Discovery. Use r! Springer. https://rd.springer.com/book/10.1007/978-1-4419-9890-3.",
    "crumbs": [
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Masinõpe - otsustuspuud ning metsad</span>"
    ]
  },
  {
    "objectID": "19-faktor.html",
    "href": "19-faktor.html",
    "title": "19  Faktoranalüüs",
    "section": "",
    "text": "19.1 Faktoranalüüs paketiga psych\nSee peatükk annab ülevaate, kuidas teha faktoranalüüsi R-is.\nAndmetöötluseks kasutan paketti tidyverse (Wickham et al. 2019).\nlibrary(psych)\nAnalüüsi läbiviimiseks kasutan paketiga psych (William Revelle 2024) kaasatulevat andmestikku bfi ehk Big Five Inventory.\ndata(\"bfi\")\nAndmestik sisaldab 2800 inimese vastuseid isiksusetestile (25 tunnust) ning lisaks on kolm tunnust, mis näitavad vastaja sugu, vanust ja haridustaset. Isiksuse testiga mõõdetakse viite üksusele isiksuseomadust (ekstravertsus/extraversion, vastutulelikkus/agreeableness, kohusetundlikkus/conscientiousness, neurootilisus/neuroticism ja avatus/openness). Iga isiksuse omaduse kohta on viis küsimust ja tunnuse nimed algavad vastava tähega E, A, C, N ning O. Iga number andmeväljas näitab, millise hinnangu vastaja andis kuuepallisel Likerti skaalal.\nVajadusel vaata küsimusi lähemalt.\n#?bfi\nFaktoranalüüs on tundlik puuduvate väärtuste osas, seepärast vaatan esmalt kui palju neid on.\nsum(is.na(bfi))\n\n[1] 731\nLoe lähemalt, kuidas tulle toime puuduvate väärtustega siit. Praegu on eesmärk teha faktoranalüüsi ja viskan need ilma põhjaliku süvenemiseta lihtsalt välja.\nbfi&lt;-bfi|&gt;\n  drop_na()",
    "crumbs": [
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Faktoranalüüs</span>"
    ]
  },
  {
    "objectID": "19-faktor.html#faktoranalüüs-paketiga-psych",
    "href": "19-faktor.html#faktoranalüüs-paketiga-psych",
    "title": "19  Faktoranalüüs",
    "section": "",
    "text": "Pööramismeetodi valik\nPööramismeetodi valik mõjutab faktorite tulemust. Varimax pööramine eeldab, et faktorid on omavahel sõltumatud. Selline mudel on lihtsamini tõlgendatav, sest laadimised on kas kõrged või madalad. Nii eristub faktorid teineteisest paremini.\n\n\nFaktorite arvu leidmine\nValitud faktorite arv (ja rotatsiooni meetod) mõjutavad analüüsi tulemusi. Kui on liiga vähe faktoreid, siis mudel ei suuda piisavalt hästi andmete mittekülgsust tabada. Kannatab mudeli selgitusvõime, sest tegelikke faktoreid ei suudeta eristada. Kui faktoreid on liiga palju, muutub mudel keeruliseks ja raskesti tõlgendatavaks. Tekib liigne müra, mida võib hakata tõlgendama teguriteks. Seepärast on oluline leida õige faktorite arv.\nKäsuga fa.parallel() on võimalik luua nn “küünarnuki kõver”. See kõver näitab, mis hetkest uue faktori lisamine ei suurenda oluliselt mudeli seletusvõimet.\n\nfa.parallel(bfi[,1:25],\n            fa = \"fa\")\n\n\n\n\n\n\n\n\nParallel analysis suggests that the number of factors =  6  and the number of components =  NA \n\n\nValin andmestikust esimesed 25 tunnust. Pildil tundub kõver kuskile viie ja kuue vahele jäävat. Pane tähele, et joonise all on väljatrükk, mis soovitab kuuest jaotust. Kuna isiksuse omadusi on viis, kasutan edasises analüüsis ka viiest jaotust.\n\n\nMudeli loomine\nTeen faktoranalüüsi käsuga fa() ja salvestan tulemuse eraldi objekti.\n\n1fa_tulemus&lt;-fa(bfi[,1:25],\n2               nfactors = 5,\n3               rotate = \"varimax\",\n               fm=\"pa\")\n\n\n1\n\nValin veerud 1 kuni 25\n\n2\n\nMääran ära faktorite arvu\n\n3\n\nKasutan varimax pööramist\n\n\n\n\nTulemuse väljatrükk sisaldab kahte tabelit. Esimene neist on faktormaatriks, mille kaks esimest tulpa näitavad faktorlaadungeid (korrelatsioonseoseid) tekkinud uute faktorite ja vanade olemasolevate tunnustel vahel.\n\nfa_tulemus\n\nFactor Analysis using method =  pa\nCall: fa(r = bfi[, 1:25], nfactors = 5, rotate = \"varimax\", fm = \"pa\")\nStandardized loadings (pattern matrix) based upon correlation matrix\n     PA2   PA1   PA3   PA5   PA4   h2   u2 com\nA1  0.11  0.04  0.03 -0.42 -0.09 0.20 0.80 1.3\nA2  0.04  0.22  0.14  0.61  0.04 0.44 0.56 1.4\nA3  0.01  0.32  0.11  0.64  0.05 0.53 0.47 1.6\nA4 -0.06  0.20  0.22  0.43 -0.13 0.30 0.70 2.2\nA5 -0.12  0.38  0.09  0.53  0.05 0.46 0.54 2.0\nC1  0.02  0.06  0.54  0.03  0.21 0.34 0.66 1.3\nC2  0.09  0.02  0.64  0.11  0.10 0.44 0.56 1.2\nC3 -0.03  0.03  0.56  0.11 -0.01 0.33 0.67 1.1\nC4  0.24 -0.07 -0.63 -0.03 -0.10 0.47 0.53 1.4\nC5  0.28 -0.18 -0.56 -0.04  0.04 0.43 0.57 1.7\nE1  0.03 -0.57  0.03 -0.12 -0.06 0.34 0.66 1.1\nE2  0.24 -0.68 -0.10 -0.11 -0.05 0.55 0.45 1.4\nE3  0.02  0.55  0.09  0.26  0.28 0.46 0.54 2.0\nE4 -0.12  0.64  0.10  0.32 -0.08 0.54 0.46 1.7\nE5  0.04  0.51  0.32  0.09  0.20 0.42 0.58 2.1\nN1  0.79  0.08 -0.04 -0.21 -0.08 0.68 0.32 1.2\nN2  0.75  0.04 -0.02 -0.19 -0.01 0.61 0.39 1.1\nN3  0.73 -0.06 -0.06 -0.02  0.00 0.55 0.45 1.0\nN4  0.59 -0.35 -0.18  0.01  0.08 0.51 0.49 1.9\nN5  0.54 -0.16 -0.05  0.11 -0.16 0.35 0.65 1.5\nO1 -0.01  0.21  0.12  0.05  0.50 0.32 0.68 1.5\nO2  0.18  0.00 -0.10  0.10 -0.48 0.28 0.72 1.5\nO3  0.03  0.31  0.07  0.12  0.60 0.48 0.52 1.6\nO4  0.22 -0.19 -0.04  0.14  0.37 0.24 0.76 2.7\nO5  0.08 -0.01 -0.06 -0.02 -0.54 0.31 0.69 1.1\n\n                       PA2  PA1  PA3  PA5  PA4\nSS loadings           2.70 2.49 2.02 1.79 1.54\nProportion Var        0.11 0.10 0.08 0.07 0.06\nCumulative Var        0.11 0.21 0.29 0.36 0.42\nProportion Explained  0.26 0.24 0.19 0.17 0.15\nCumulative Proportion 0.26 0.49 0.68 0.85 1.00\n\nMean item complexity =  1.5\nTest of the hypothesis that 5 factors are sufficient.\n\ndf null model =  300  with the objective function =  7.41 with Chi Square =  16484.78\ndf of  the model are 185  and the objective function was  0.63 \n\nThe root mean square of the residuals (RMSR) is  0.03 \nThe df corrected root mean square of the residuals is  0.04 \n\nThe harmonic n.obs is  2236 with the empirical chi square  1046.45  with prob &lt;  3.1e-120 \nThe total n.obs was  2236  with Likelihood Chi Square =  1400.57  with prob &lt;  1.5e-185 \n\nTucker Lewis Index of factoring reliability =  0.878\nRMSEA index =  0.054  and the 90 % confidence intervals are  0.052 0.057\nBIC =  -26.23\nFit based upon off diagonal values = 0.98\nMeasures of factor score adequacy             \n                                                   PA2  PA1  PA3  PA5  PA4\nCorrelation of (regression) scores with factors   0.92 0.88 0.86 0.84 0.83\nMultiple R square of scores with factors          0.85 0.77 0.74 0.70 0.69\nMinimum correlation of possible factor scores     0.71 0.54 0.48 0.41 0.38\n\n\n\nfa_tulemus$loadings\n\n\nLoadings:\n   PA2    PA1    PA3    PA5    PA4   \nA1  0.106               -0.419       \nA2         0.222  0.137  0.608       \nA3         0.323  0.112  0.638       \nA4         0.199  0.223  0.434 -0.134\nA5 -0.118  0.385         0.532       \nC1                0.541         0.205\nC2                0.639  0.111  0.102\nC3                0.559  0.108       \nC4  0.244        -0.627              \nC5  0.284 -0.180 -0.561              \nE1        -0.566        -0.122       \nE2  0.238 -0.683        -0.110       \nE3         0.552         0.256  0.276\nE4 -0.119  0.640  0.102  0.323       \nE5         0.513  0.318         0.204\nN1  0.787               -0.209       \nN2  0.753               -0.192       \nN3  0.734                            \nN4  0.589 -0.350 -0.178              \nN5  0.538 -0.157         0.106 -0.160\nO1         0.209  0.123         0.504\nO2  0.183        -0.102        -0.479\nO3         0.311         0.115  0.600\nO4  0.222 -0.192         0.144  0.366\nO5                             -0.545\n\n                 PA2   PA1   PA3   PA5   PA4\nSS loadings    2.705 2.487 2.017 1.794 1.539\nProportion Var 0.108 0.099 0.081 0.072 0.062\nCumulative Var 0.108 0.208 0.288 0.360 0.422\n\n\n\nplot(fa_tulemus)\n\n\n\n\n\n\n\n\n\n\nMudeli tulemuste visualiseerimine\nAnalüüsi tulemuste visualiseerimiseks tuleb kasutada käsku fa.diagram().\n\nfa.diagram(fa_tulemus)\n\n\n\n\n\n\n\n\n\nfa_laadung&lt;-fa_tulemus$scores\n\n\nbfi&lt;-bind_cols(bfi, as_tibble(fa_laadung))\n\n\nKMO(bfi[,1:25])\n\nKaiser-Meyer-Olkin factor adequacy\nCall: KMO(r = bfi[, 1:25])\nOverall MSA =  0.85\nMSA for each item = \n  A1   A2   A3   A4   A5   C1   C2   C3   C4   C5   E1   E2   E3   E4   E5   N1 \n0.74 0.83 0.87 0.87 0.90 0.84 0.79 0.85 0.82 0.86 0.84 0.88 0.89 0.88 0.89 0.78 \n  N2   N3   N4   N5   O1   O2   O3   O4   O5 \n0.78 0.86 0.89 0.86 0.86 0.78 0.83 0.78 0.76 \n\n\n\n\n\n\nWickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the tidyverse.” Journal of Open Source Software 4 (43): 1686. https://doi.org/10.21105/joss.01686.\n\n\nWilliam Revelle. 2024. Psych: Procedures for Psychological, Psychometric, and Personality Research. Evanston, Illinois: Northwestern University. https://CRAN.R-project.org/package=psych.",
    "crumbs": [
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Faktoranalüüs</span>"
    ]
  },
  {
    "objectID": "20-aegread.html",
    "href": "20-aegread.html",
    "title": "20  Aegridade analüüs",
    "section": "",
    "text": "20.1 Aegrea analüüsimine paketiga Kendall\nSee peatükk annab ülevaate, kuidas kasutada `R`-i aegridade analüüsiks.\nSiin näites kasutan Statistikaameti kogutud andmeid hoolekandeteenuste kasutamise kohta Tabel:SK06\nAegridade analüüs võimaldab:\nNäiteks sotsiaaltöö valdkonnas saab aegridade analüüsi abil planeerida teenuste vajadust või hinnata sekkumise tõhusust.\nAegridade komponentideks on trend, hooajalisus ja juhuslik sündmus.\nAnalüüsimeetodivalik sõltub andmete hulgast.\nlibrary(Kendall)\nPaketti Kendall(McLeod 2022) on hea kasutada siis kui:\ntau on korrelatsioonikordaja, mis mõõdab seose tugevust kahe muutuja vahel. Tau väärtus jääb vahemikku -1 kuni +1.\nTulemuste tõlgendamine:\nPaketi põhikäsud:\nEsmalt visualiseerin andmed.\nCode\nandmed|&gt;\n  filter(!is.na(`Erihoolekandeteenuste kohad`))|&gt;\n  ggplot(aes(x=Aasta, y=`Erihoolekandeteenuste kohad`))+\n  geom_line()+\n  geom_point()+ \n  theme_minimal()+\n  ggtitle(\"Erihoolekandeteenuste kohad\")\nSeejärel teen MannKendall testi.\nMannKendall(andmed$`Erihoolekandeteenuste kohad`)\n\ntau = -0.538, 2-sided pvalue =0.008595\nTulemuste tõlgendamine: selgub, et erihoolekandeteenuste kohtade arv perioodil 1989 - 2002 oli kahanevas trendis ning see kahanev trend on statistilisest oluline (tau = -0,538, p &lt; 0.05).\nKui oleks teada ka iga kuu kohta andmed, saaks kasutada käsku SeasonalMannKendall(). Siis võrreldakse igat kuud eraldi eelmiste aastate sama kuudega.",
    "crumbs": [
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Aegridade analüüs</span>"
    ]
  },
  {
    "objectID": "20-aegread.html#aegrea-analüüsimine-paketiga-kendall",
    "href": "20-aegread.html#aegrea-analüüsimine-paketiga-kendall",
    "title": "20  Aegridade analüüs",
    "section": "",
    "text": "andmeid on vähe (12-30 vaatlust),\ntahad testida, kas trend on olemas,\nandmed ei ole normaalselt jaotunud.\n\n\n\n\ntau &gt; 0: kasvav trend\ntau &lt; 0: kahanev trend\ntau ≈ 0: trend puudub\n\n\n\nMannKendall() - Mann-Kendall trendi test\nSeasonalMannKendall() - hooajaline Mann-Kendall test",
    "crumbs": [
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Aegridade analüüs</span>"
    ]
  },
  {
    "objectID": "20-aegread.html#aegrea-analüüsimine-paketiga-prophet",
    "href": "20-aegread.html#aegrea-analüüsimine-paketiga-prophet",
    "title": "20  Aegridade analüüs",
    "section": "20.2 Aegrea analüüsimine paketiga prophet",
    "text": "20.2 Aegrea analüüsimine paketiga prophet\nprophet(Taylor and Letham 2021) paketti sobib kasutada siis kui on vähematl 24 vaatlust. Näiteks kahe aasta iga kuu vaatlused.\nPaketi põhikäsud:\n\nprophet() - mudeli loomine\nfit.prophet() - mudeli treenimine. Kasutatakse harvem ja ainult siis, kui mudeli objekt on loodud ilma andmeteta ning soovitakse mudel hiljem andmetega sobitada.\nmake_future_dataframe() - tuleviku andmete raami loomine\npredict() - prognoosimine\nplot() - tulemuste visualiseerimine\nprophet_plot_components() - komponentide analüüs\n\nVaatan esmalt kui palju on mul ajaloolisi andmeid.\n\nandmed|&gt;\n  filter(!is.na(`Üldhooldusteenus saajad`))|&gt;\n  nrow()\n\n[1] 35\n\n\n\nandmed|&gt;\n    filter(!is.na(`Üldhooldusteenus saajad`))|&gt;\n  ggplot(aes(x=Aasta, y=`Üldhooldusteenus saajad`))+\n  geom_point()+ \n  theme_minimal()+\n  scale_x_discrete(breaks = as.character(seq(1989, 2024, by = 3))) # kuvan aastaarve üle kolme, et x teljele ära mahuks\n\n\n\n\n\n\n\n\nprophet() käsk soovib ainult kahte tunnust, aega ja analüüsitavat väärtust. Samas andmestikule on kindlad nõuded ning seal peab olema:\n\nds veerg, mis sisaldab kuupäevi (Date või POSIXct formaadis) ehk %Y-%m-%d.\ny veerg, mis sisaldab mõõdetavat väärtust (nt teenuskohtade_arv)\n\nKui on ainult aastad (näiteks 2015, 2016, jne), siis prophet ei saa neid andmeid kasutada, kuna need ei ole kuupäevad. Veateade ütleb: “Unable to parse date format in column ds”\nLahenduseks on lisada igale aastale juurde kuupäev. Näiteks esimene jaanuar. Teen alamandmestiku jättes alles vaid kaks tunnust.\n\nprophet_andmed&lt;-andmed|&gt;\n  mutate(\n    ds = as.Date(paste0(Aasta, \"-01-01\")),\n    y = `Üldhooldusteenus saajad`) |&gt;\n  select(ds, y)\n\n\nTreening ja testandmestiku loomine\n\n\nLineaarse mudeli loomine\nMudeli tegemisel saab täpsustada, et soovid analüüsida hooajalisust nädala või päevade lõikes. Vastavalt sellele tuleb kasutada käsu sees täpsustada:\n\nweekly.seasonality=TRUE\ndaily.seasonality=TRUE\n\nEsmalt loon mudeli käsuga prophet(), mis sobitab mudeli kohe andmetega. Saan mudeli objekti, millega saab edasi töötada (ennustada, visualiseerida).\n\n\nOluliste sündmustega arvesatmine\nprophet(Taylor and Letham 2021) pakett lubab analüüsimisel võtta arvesse kahte tüüpi sündmusi changepoints ja holidays\n\nchangepoints - kui eeldad, et sündmused põhjustavad trendi püsiva muutuse. Sobib näiteks seaduse jõustumise või kriisi alguse tähistamiseks, kui eeldad, et trend muutub püsivalt.\nholidays - kui eeldad, et sündmused põhjustavad ajutise hüppe või languse.\n\nLoon esmalt oluliste sündmuste andmeraami, et oleks endal lihtsam jälgida millal mingi sündmus aset leidis. Sündmuste andmestik peab sisaldama järgmisi veerge:\n\nds - aeg,\nholiday - sündmus,\nlower_window - päevade arv enne sündmust (tavaliselt 0),\nupper_window - päevade arv pärast sündmust (tavaliselt 0).\n\n\n#\n\nSeejärel teen uue mudeli (mudel2) käsuga prophet(). Pane tähele, et nüüd ütlen käsu sees ära, et võtaks muutekohad andmestikust syndmused. See sunnib mudelit arvestama trendimuutust just nendel kuupäevadel. Kui muutepunkte pole ette antud, tuvastab käsk need automaatselt ise.\n\nlibrary(prophet)\n\nLoading required package: Rcpp\n\n\nLoading required package: rlang\n\n\n\nAttaching package: 'rlang'\n\n\nThe following objects are masked from 'package:purrr':\n\n    %@%, flatten, flatten_chr, flatten_dbl, flatten_int, flatten_lgl,\n    flatten_raw, invoke, splice\n\n\n\n\nLogistilise mudeli loomine\n\n\nMudeli headuse hindamine",
    "crumbs": [
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Aegridade analüüs</span>"
    ]
  },
  {
    "objectID": "20-aegread.html#aegrea-analüüsimine-paketiga-forecast",
    "href": "20-aegread.html#aegrea-analüüsimine-paketiga-forecast",
    "title": "20  Aegridade analüüs",
    "section": "20.3 Aegrea analüüsimine paketiga forecast",
    "text": "20.3 Aegrea analüüsimine paketiga forecast\n\nlibrary(forecast)\n\n\n\n\n\nMcLeod, A. I. 2022. Kendall: Kendall Rank Correlation and Mann-Kendall Trend Test. https://doi.org/10.32614/CRAN.package.Kendall.\n\n\nTaylor, Sean, and Ben Letham. 2021. Prophet: Automatic Forecasting Procedure. https://doi.org/10.32614/CRAN.package.prophet.",
    "crumbs": [
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Aegridade analüüs</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Allikad",
    "section": "",
    "text": "Chang, Winston. 2024. R Graphics Cookbook. 2nd ed. https://r-graphics.org/.\n\n\nCui, Boxuan. 2024. DataExplorer: Automate Data Exploration and\nTreatment. https://CRAN.R-project.org/package=DataExplorer.\n\n\nFox, John, and Sanford Weisberg. 2019. An R Companion\nto Applied Regression. Third. Thousand Oaks CA: Sage.\nhttps://socialsciences.mcmaster.ca/jfox/Books/Companion/.\n\n\nGarnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2024.\nviridis(Lite) - Colorblind-Friendly\nColor Maps for r. https://doi.org/10.5281/zenodo.4679423.\n\n\nGrolemund, Garrett, and Hadley Wickham. 2011. “Dates and Times\nMade Easy with lubridate.”\nJournal of Statistical Software 40 (3): 1–25. https://www.jstatsoft.org/v40/i03/.\n\n\nGrosjean, Philippe, and Frederic Ibanez. 2024. Pastecs: Package for\nAnalysis of Space-Time Ecological Series. https://CRAN.R-project.org/package=pastecs.\n\n\nHarrell Jr, Frank E. 2024. Hmisc: Harrell Miscellaneous. https://CRAN.R-project.org/package=Hmisc.\n\n\nHugh-Jones, David. 2024. Huxtable: Easily Create and Style Tables\nfor LaTeX, HTML and Other Formats. https://CRAN.R-project.org/package=huxtable.\n\n\nIannone, Richard, Joe Cheng, Barret Schloerke, Ellis Hughes, Alexandra\nLauer, and JooYoung Seo. 2024. Gt: Easily Create Presentation-Ready\nDisplay Tables. https://CRAN.R-project.org/package=gt.\n\n\nKassambara, Alboukadel, and Fabian Mundt. 2020. Factoextra: Extract\nand Visualize the Results of Multivariate Data Analyses. https://CRAN.R-project.org/package=factoextra.\n\n\nLahti, Leo, Janne Huovari, Markus Kainu, Przemyslaw Biecek, Diego\nHernangomez, Daniel Antal, and Pyry Kantanen. 2023. “Eurostat:\nTools for Eurostat Open Data.” Computer software. https://github.com/rOpenGov/eurostat.\n\n\nLiaw, Andy, and Matthew Wiener. 2002. “Classification and\nRegression by randomForest.” R News 2 (3): 18–22. https://CRAN.R-project.org/doc/Rnews/.\n\n\nLong, Jacob A. 2019. Interactions: Comprehensive, User-Friendly\nToolkit for Probing Interactions. https://cran.r-project.org/package=interactions.\n\n\nLüdecke, Daniel. 2018. “Sjmisc: Data and Variable Transformation\nFunctions.” Journal of Open Source Software 3 (26): 754.\nhttps://doi.org/10.21105/joss.00754.\n\n\n———. 2022. Sjlabelled: Labelled Data Utility Functions (Version\n1.2.0). https://doi.org/10.5281/zenodo.1249215.\n\n\nMangiafico, Salvatore S. 2024. rcompanion: Functions to Support Extension\nEducation Program Evaluation. New Brunswick, New Jersey: Rutgers\nCooperative Extension. https://CRAN.R-project.org/package=rcompanion/.\n\n\nMcLeod, A. I. 2022. Kendall: Kendall Rank Correlation and\nMann-Kendall Trend Test. https://doi.org/10.32614/CRAN.package.Kendall.\n\n\nMilborrow, Stephen. 2024. Rpart.plot: Plot ’Rpart’ Models: An\nEnhanced Version of ’Plot.rpart’. https://doi.org/10.32614/CRAN.package.rpart.plot.\n\n\nMock, Thomas. 2023. gtExtras: Extending ’Gt’ for Beautiful HTML\nTables. https://CRAN.R-project.org/package=gtExtras.\n\n\nNeuwirth, Erich. 2022. RColorBrewer: ColorBrewer Palettes. https://CRAN.R-project.org/package=RColorBrewer.\n\n\nPebesma, Edzer. 2018. “Simple Features for R:\nStandardized Support for Spatial Vector Data.”\nThe R Journal 10 (1): 439–46. https://doi.org/10.32614/RJ-2018-009.\n\n\nPohlert, Thorsten. 2023. PMCMRplus: Calculate Pairwise Multiple\nComparisons of Mean Rank Sums Extended. https://CRAN.R-project.org/package=PMCMRplus.\n\n\nR Core Team. 2023. Foreign: Read Data Stored by ’Minitab’, ’s’,\n’SAS’, ’SPSS’, ’Stata’, ’Systat’, ’Weka’, ’dBase’, ... https://CRAN.R-project.org/package=foreign.\n\n\nRobinson, David, Alex Hayes, and Simon Couch. 2024. Broom: Convert\nStatistical Objects into Tidy Tibbles. https://CRAN.R-project.org/package=broom.\n\n\nSchauberger, Philipp, and Alexander Walker. 2023. Openxlsx: Read,\nWrite and Edit Xlsx Files. https://CRAN.R-project.org/package=openxlsx.\n\n\nSignorell, Andri. 2024. DescTools: Tools for Descriptive\nStatistics. https://CRAN.R-project.org/package=DescTools.\n\n\nSlowikowski, Kamil. 2024. Ggrepel: Automatically Position\nNon-Overlapping Text Labels with ’Ggplot2’. https://doi.org/10.32614/CRAN.package.ggrepel.\n\n\nTaylor, Sean, and Ben Letham. 2021. Prophet: Automatic Forecasting\nProcedure. https://doi.org/10.32614/CRAN.package.prophet.\n\n\nTherneau, Terry, and Beth Atkinson. 2025. “Rpart: Recursive\nPartitioning and Regression Trees.” https://doi.org/10.32614/CRAN.package.rpart.\n\n\nUshey, Kevin, and Hadley Wickham. 2024. Renv: Project\nEnvironments. https://CRAN.R-project.org/package=renv.\n\n\nWei, Taiyun, and Viliam Simko. 2021. R Package ’Corrplot’:\nVisualization of a Correlation Matrix. https://github.com/taiyun/corrplot.\n\n\nWickham, Hadley. 2016. Ggplot2: Elegant Graphics for Data\nAnalysis. Springer-Verlag New York. https://ggplot2.tidyverse.org.\n\n\n———. 2022. Stringr: Simple, Consistent Wrappers for Common String\nOperations. https://CRAN.R-project.org/package=stringr.\n\n\n———. 2023a. Forcats: Tools for Working with Categorical Variables\n(Factors). https://CRAN.R-project.org/package=forcats.\n\n\n———. 2023b. Tidyverse: Easily Install and Load the Tidyverse.\nhttps://CRAN.R-project.org/package=tidyverse.\n\n\nWickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy\nD’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019.\n“Welcome to the tidyverse.”\nJournal of Open Source Software 4 (43): 1686. https://doi.org/10.21105/joss.01686.\n\n\nWickham, Hadley, and Jennifer Bryan. 2023. Readxl: Read Excel\nFiles. https://CRAN.R-project.org/package=readxl.\n\n\nWickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen,\nKohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey\nDunnington. 2023. Ggplot2: Create Elegant Data Visualisations Using\nthe Grammar of Graphics. https://CRAN.R-project.org/package=ggplot2.\n\n\nWickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis\nVaughan. 2023. Dplyr: A Grammar of Data Manipulation. https://CRAN.R-project.org/package=dplyr.\n\n\nWickham, Hadley, Jim Hester, and Jennifer Bryan. 2023. Readr: Read\nRectangular Text Data. https://CRAN.R-project.org/package=readr.\n\n\nWickham, Hadley, Evan Miller, and Danny Smith. 2023. Haven: Import\nand Export ’SPSS’, ’Stata’ and ’SAS’ Files. https://CRAN.R-project.org/package=haven.\n\n\nWilke, Claus O. 2019. Fundamentals of Data Visualization.\nO’Reilly Media, Inc. https://clauswilke.com/dataviz.\n\n\nWilliam Revelle. 2024. Psych: Procedures for Psychological,\nPsychometric, and Personality Research. Evanston, Illinois:\nNorthwestern University. https://CRAN.R-project.org/package=psych.\n\n\nWilliams, Graham J. 2011. Data Mining with Rattle and\nR: The Art of Excavating Data for Knowledge Discovery.\nUse r! Springer. https://rd.springer.com/book/10.1007/978-1-4419-9890-3.\n\n\nZeileis, Achim, and Torsten Hothorn. 2002. “Diagnostic Checking in\nRegression Relationships.” R News 2 (3): 7–10. https://CRAN.R-project.org/doc/Rnews/.\n\n\nZhu, Hao. 2024. kableExtra: Construct Complex Table with ’Kable’ and\nPipe Syntax. https://CRAN.R-project.org/package=kableExtra.",
    "crumbs": [
      "Allikad"
    ]
  }
]